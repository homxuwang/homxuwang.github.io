<!DOCTYPE html>
<html lang="zh-Hans">

<head>

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta charset="utf-8">

  
  <title>[æ€»ç»“]What is deadlock?How to troubleshoot deadlocks?</title>
  
  <link rel="canonical" href="http://homxuwang.github.io/2019/06/12/What-is-deadlock-How-to-troubleshoot-deadlocks/">
  
  <meta name="description" content="ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿå½“ä¸¤ä¸ª(æˆ–å¤šä¸ª)ä»»åŠ¡æ­£åœ¨ç­‰å¾…å¿…é¡»ç”±å¦ä¸€çº¿ç¨‹é‡Šæ”¾çš„æŸä¸ªå…±äº«èµ„æºï¼Œè€Œçº¿ç¨‹è¯¥çº¿ç¨‹åˆæ­£åœ¨ç­‰å¾…å¿…é¡»ç”±å‰è¿°ä»»åŠ¡ä¹‹ä¸€é‡Šæ”¾çš„å¦ä¸€å…±äº«èµ„æºæ—¶ï¼Œå¹¶å‘åº”ç”¨ç¨‹åºå°±å‡ºç°äº†æ­»é”ã€‚   å½“ç³»ç»Ÿä¸­åŒæ—¶å‡ºç°å¦‚ä¸‹å››ç§æ¡ä»¶æ—¶ï¼Œå°±ä¼šå¯¼è‡´è¿™ç§æƒ…å½¢ã€‚æˆ‘ä»¬ç§°å…¶ä¸ºCoffmanæ¡ä»¶(äº§ç”Ÿæ­»é”çš„4ä¸ªå¿…è¦æ¡ä»¶) å¦‚æœä¸€ä¸ªç³»ç»Ÿä¸­å¦‚ä¸‹4ç§æƒ…å½¢">
  
  
  <meta name="author" content="homxuwang">
  
  
  
  <meta property="og:site_name" content="Homxu" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="[æ€»ç»“]What is deadlock?How to troubleshoot deadlocks?" />
  
  <meta property="og:description" content="ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿå½“ä¸¤ä¸ª(æˆ–å¤šä¸ª)ä»»åŠ¡æ­£åœ¨ç­‰å¾…å¿…é¡»ç”±å¦ä¸€çº¿ç¨‹é‡Šæ”¾çš„æŸä¸ªå…±äº«èµ„æºï¼Œè€Œçº¿ç¨‹è¯¥çº¿ç¨‹åˆæ­£åœ¨ç­‰å¾…å¿…é¡»ç”±å‰è¿°ä»»åŠ¡ä¹‹ä¸€é‡Šæ”¾çš„å¦ä¸€å…±äº«èµ„æºæ—¶ï¼Œå¹¶å‘åº”ç”¨ç¨‹åºå°±å‡ºç°äº†æ­»é”ã€‚   å½“ç³»ç»Ÿä¸­åŒæ—¶å‡ºç°å¦‚ä¸‹å››ç§æ¡ä»¶æ—¶ï¼Œå°±ä¼šå¯¼è‡´è¿™ç§æƒ…å½¢ã€‚æˆ‘ä»¬ç§°å…¶ä¸ºCoffmanæ¡ä»¶(äº§ç”Ÿæ­»é”çš„4ä¸ªå¿…è¦æ¡ä»¶) å¦‚æœä¸€ä¸ªç³»ç»Ÿä¸­å¦‚ä¸‹4ç§æƒ…å½¢">
  
  <meta property="og:url" content="http://homxuwang.github.io/2019/06/12/What-is-deadlock-How-to-troubleshoot-deadlocks/" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="[æ€»ç»“]What is deadlock?How to troubleshoot deadlocks?">
  
  <meta name="twitter:description" content="ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿå½“ä¸¤ä¸ª(æˆ–å¤šä¸ª)ä»»åŠ¡æ­£åœ¨ç­‰å¾…å¿…é¡»ç”±å¦ä¸€çº¿ç¨‹é‡Šæ”¾çš„æŸä¸ªå…±äº«èµ„æºï¼Œè€Œçº¿ç¨‹è¯¥çº¿ç¨‹åˆæ­£åœ¨ç­‰å¾…å¿…é¡»ç”±å‰è¿°ä»»åŠ¡ä¹‹ä¸€é‡Šæ”¾çš„å¦ä¸€å…±äº«èµ„æºæ—¶ï¼Œå¹¶å‘åº”ç”¨ç¨‹åºå°±å‡ºç°äº†æ­»é”ã€‚   å½“ç³»ç»Ÿä¸­åŒæ—¶å‡ºç°å¦‚ä¸‹å››ç§æ¡ä»¶æ—¶ï¼Œå°±ä¼šå¯¼è‡´è¿™ç§æƒ…å½¢ã€‚æˆ‘ä»¬ç§°å…¶ä¸ºCoffmanæ¡ä»¶(äº§ç”Ÿæ­»é”çš„4ä¸ªå¿…è¦æ¡ä»¶) å¦‚æœä¸€ä¸ªç³»ç»Ÿä¸­å¦‚ä¸‹4ç§æƒ…å½¢">
  
  
  
  
  <meta name="twitter:url" content="http://homxuwang.github.io/2019/06/12/What-is-deadlock-How-to-troubleshoot-deadlocks/" />

  <!-- Mobile Specific Metas
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="preload" href="/fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  
<link rel="stylesheet" href="/css/normalize.css">

  
<link rel="stylesheet" href="/css/skeleton.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
<link rel="stylesheet" href="/css/prism-dark.css">

  
<link rel="stylesheet" href="/css/prism-line-numbers.css">

  <!-- User css -->
  
  
<link rel="stylesheet" href="/css/user.css">

  

  <!-- Favicon
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

  <!-- Custom Theme Color Style
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <style>
  a:not(.icon) {
    text-decoration-color: #0FA0CE;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #0FA0CE 50%
    );
  }
  blockquote {
    border-left: 8px solid #0FA0CE;
  }
  .nanobar .bar {
    background: #0FA0CE;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #0FA0CE;
    border-color: #0FA0CE;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #0FA0CE;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  

  
  <script src="/js/pic.min.js" defer></script>
  

  
  <script src="/js/search.min.js" defer></script>
  

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="two columns" style="max-width: 50px">
    <h1 class="mt-2 mode">
      <div onclick=setDarkMode(true) id="darkBtn">ğŸŒ‘</div>
      <div onclick=setDarkMode(false) id="lightBtn" class=hidden>â˜€ï¸</div>
      <script >
        if (localStorage.getItem('preferredTheme') == 'dark') {
          setDarkMode(true)
        }
        function setDarkMode(isDark) {
          var darkBtn = document.getElementById('darkBtn')
          var lightBtn = document.getElementById('lightBtn')
          if (isDark) {
            lightBtn.style.display = "block"
            darkBtn.style.display = "none"
            localStorage.setItem('preferredTheme', 'dark');
          } else {
            lightBtn.style.display = "none"
            darkBtn.style.display = "block"
            localStorage.removeItem('preferredTheme');
          }
          document.body.classList.toggle("darkmode");
        }
      </script>
    </h1>
  </div>

  <div class="six columns ml-1">
    <h1 class="mt-2">
      Hi July.HX
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/">Home</a>
        
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>

        <div class="trans">
            <h2>[æ€»ç»“]What is deadlock?How to troubleshoot deadlocks?</h2>

  <h1 id="ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ­»é”ï¼Ÿ</h1><p>å½“ä¸¤ä¸ª(æˆ–å¤šä¸ª)ä»»åŠ¡æ­£åœ¨ç­‰å¾…å¿…é¡»ç”±å¦ä¸€çº¿ç¨‹é‡Šæ”¾çš„æŸä¸ªå…±äº«èµ„æºï¼Œè€Œçº¿ç¨‹è¯¥çº¿ç¨‹åˆæ­£åœ¨ç­‰å¾…å¿…é¡»ç”±å‰è¿°ä»»åŠ¡ä¹‹ä¸€é‡Šæ”¾çš„å¦ä¸€å…±äº«èµ„æºæ—¶ï¼Œå¹¶å‘åº”ç”¨ç¨‹åºå°±å‡ºç°äº†<strong>æ­»é”</strong>ã€‚</p>
<div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom layers lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;&lt;mxfile modified=\&quot;2019-06-13T07:32:26.952Z\&quot; host=\&quot;www.draw.io\&quot; agent=\&quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36\&quot; etag=\&quot;N6TJ4Wx920oDQg6_8sun\&quot; version=\&quot;10.7.7\&quot; type=\&quot;device\&quot;&gt;&lt;diagram id=\&quot;_GEg1l8nubf1ai1I0eZx\&quot; name=\&quot;ç¬¬ 1 é¡µ\&quot;&gt;zVffk5owEP5rfGwHEhR9rD96nU5vxtGH3j1mYA/SBsLEoNC/vkGCIaKed6eeL072y27I7n4fKz08SYoHQbL4kYfAesgJix6e9hAaeo76rYCyBrwBqoFI0LCGXAMs6T/QoI6LchrCynKUnDNJMxsMeJpCIC2MCME3ttsLZ/ZTMxJBB1gGhHXR3zSUsU4L+Qb/ATSKmye7g1G9k5DGWWeyiknINy0Iz3p4IjiX9SopJsCq2jV1qeO+H9ndXUxAKs8JYEMf/gazxfjnFM0elw+LPMq+DPTdZNkkDKHKX5tcyJhHPCVsZtCx4HkaQnWqoyzj84vzTIGuAv+AlKVuJsklV1AsE6Z31YVF+aTjt8ZzZXztN+a0aG9OS20FuVhvn7s9pKDyyYQp67kJUmtzQmU0B9TJVhkeraGGVjwXAZwoXMNFIiKQJ/zQrtNKIcATUAmpOAGMSLq270E0V6Odnw79JgQpWw4Zp6lctU6eV4By0Kob9esDteZQ32KGWtQHNlbrZgbasucNTNI5rAnLdVZzt0OuTUwlLDOyLe1GvTBsYpBVVmv4hRZVo3XD1iAkFKdb1i2xDvAdqxbY0fbGqFmXx4lbQm6wQz1pFfLtdfLfoTiL+BeUn1HcTjsn5HdB9aAz1YM/qJ4PdQp1GL3oMlq91bNqqapAGAPGI0ESVawMBFXXALG/Nzcb41fkcAH2I8emv+J/h/7+Afp716L/8H7o79rTx39t/ByeOO6tJg4+UzPeZ0wc3LdHjuf41x85uDty0D2MHIz3RDf65Jkzuh/R7c0c93YzxztTP0d6e5uZ43VnTpfSdz5z3NHeX67h1WaOMs0HVP1aMV+hePYf&lt;/diagram&gt;&lt;/mxfile&gt;&quot;}"></div>

<p>å½“ç³»ç»Ÿä¸­åŒæ—¶å‡ºç°å¦‚ä¸‹å››ç§æ¡ä»¶æ—¶ï¼Œå°±ä¼šå¯¼è‡´è¿™ç§æƒ…å½¢ã€‚æˆ‘ä»¬ç§°å…¶ä¸º<strong>Coffmanæ¡ä»¶</strong>(äº§ç”Ÿæ­»é”çš„4ä¸ªå¿…è¦æ¡ä»¶)</p>
<p>å¦‚æœä¸€ä¸ªç³»ç»Ÿä¸­å¦‚ä¸‹4ç§æƒ…å½¢åŒæ—¶å­˜åœ¨ï¼Œåˆ™äº§ç”Ÿæ­»é”æƒ…å½¢çš„æœºä¼šå°±ä¼šä¸Šå‡</p>
<ul>
<li><strong>äº’æ–¥æ¡ä»¶</strong>ï¼šè¿›ç¨‹è¦æ±‚å¯¹æ‰€åˆ†é…çš„èµ„æºè¿›è¡Œæ’å®ƒæ€§æ§åˆ¶ï¼Œå³åœ¨ä¸€æ®µæ—¶é—´å†…æŸèµ„æºä»…ä¸ºä¸€è¿›ç¨‹æ‰€å ç”¨(æ­»é”ä¸­æ¶‰åŠçš„èµ„æºå¿…é¡»æ˜¯ä¸å¯å…±äº«çš„ã€‚ä¸€æ¬¡åªæœ‰ä¸€ä¸ªä»»åŠ¡å¯ä»¥ä½¿ç”¨è¯¥èµ„æº)</li>
<li><strong>å æœ‰å¹¶ç­‰å¾…æ¡ä»¶</strong>ï¼šå½“è¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾(ä¸€ä¸ªä»»åŠ¡åœ¨å æœ‰æŸä¸€äº’æ–¥çš„èµ„æºæ—¶åˆè¯·æ±‚å¦ä¸€äº’æ–¥çš„èµ„æºã€‚å½“å®ƒåœ¨ç­‰å¾…æ—¶ï¼Œä¸ä¼šé‡Šæ”¾ä»»ä½•èµ„æº)</li>
<li><strong>ä¸å¯å‰¥å¤ºæ¡ä»¶</strong>ï¼šè¿›ç¨‹å·²è·å¾—çš„èµ„æºåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½å‰¥å¤ºï¼Œåªèƒ½åœ¨ä½¿ç”¨å®Œæ—¶ç”±è‡ªå·±é‡Šæ”¾(èµ„æºåªèƒ½è¢«é‚£äº›æŒæœ‰å®ƒä»¬çš„ä»»åŠ¡é‡Šæ”¾)</li>
<li><strong>å¾ªç¯ç­‰å¾…æ¡ä»¶</strong>ï¼šåœ¨å‘ç”Ÿæ­»é”æ—¶ï¼Œå¿…ç„¶å­˜åœ¨ä¸€ä¸ªè¿›ç¨‹â€“èµ„æºçš„ç¯å½¢é“¾ã€‚ä¾‹å¦‚å­˜åœ¨è¿›ç¨‹é›†åˆ{P1,P2,P3â€¦.Pn}ï¼ŒP1 ç”³è¯·P2è·å–çš„èµ„æºï¼ŒP2ç”³è¯·P3èµ„æºâ€¦.è€ŒPnç”³è¯·P1è·å–çš„èµ„æºï¼Œè¿™æ ·å½¢æˆäº†ä¸€ä¸ªé—­ç¯ï¼Œå³å¾ªç¯ç­‰å¾…ã€‚</li>
</ul>
<p>è¿™4ä¸ªæ¡ä»¶å³Coffmanæ¡ä»¶ï¼Œç”±Edward G.Coffman, Jrå…ˆç”Ÿäº1971å¹´é¦–æ¬¡æå‡ºã€‚</p>
<h1 id="å¦‚ä½•é¿å…æ­»é”"><a href="#å¦‚ä½•é¿å…æ­»é”" class="headerlink" title="å¦‚ä½•é¿å…æ­»é”"></a>å¦‚ä½•é¿å…æ­»é”</h1><p>æœ‰ä¸€äº›æœºåˆ¶å¯ä»¥ç”¨æ¥é¿å…æ­»é”ï¼š</p>
<ul>
<li><strong>å¿½ç•¥å®ƒä»¬</strong>ï¼šè¿™æ˜¯æœ€å¸¸ç”¨çš„æœºåˆ¶ã€‚ä½ å¯ä»¥å‡è®¾è‡ªå·±çš„ç³»ç»Ÿç»å¯¹ä¸ä¼šå‡ºç°æ­»é”ï¼Œè€Œå¦‚æœå‘ç”Ÿæ­»é”ï¼Œç»“æœå°±æ˜¯ä½ å¯ä»¥åœæ­¢åº”ç”¨ç¨‹åºå¹¶ä¸”é‡æ–°æ‰§è¡Œå®ƒã€‚</li>
<li><strong>æ£€æµ‹ä¸ä¿®å¤</strong>ï¼šç³»ç»Ÿä¸­æœ‰ä¸€é¡¹ä¸“é—¨åˆ†æç³»ç»ŸçŠ¶æ€çš„ä»»åŠ¡ï¼Œå¯ä»¥æ£€æµ‹æ˜¯å¦å‘ç”Ÿäº†æ­»é”ã€‚å¦‚æœå®ƒæ£€æµ‹åˆ°äº†æ­»é”ï¼Œå¯ä»¥é‡‡å–ä¸€äº›æªæ–½æ¥ä¿®å¤è¯¥é—®é¢˜ï¼Œä¾‹å¦‚ï¼Œç»“æŸæŸä¸ªä»»åŠ¡æˆ–è€…å¼ºåˆ¶é‡Šæ”¾æŸä¸€èµ„æºã€‚</li>
<li><strong>é¢„é˜²</strong>ï¼šå¦‚æœä½ æƒ³é˜²æ­¢ç³»ç»Ÿå‡ºç°æ­»é”ï¼Œå°±å¿…é¡»é¢„é˜²Coffmanæ¡ä»¶ä¸­çš„ä¸€æ¡æˆ–è€…å¤šæ¡å‡ºç°ã€‚</li>
<li><strong>è§„é¿</strong>ï¼šå¦‚æœä½ å¯ä»¥åœ¨æŸä¸€ä»»åŠ¡æ‰§è¡Œä¹‹å‰å¾—åˆ°è¯¥ä»»åŠ¡æ‰€ä½¿ç”¨èµ„æºçš„ç›¸å…³ä¿¡æ¯ï¼Œé‚£ä¹ˆæ­»é”æ˜¯å¯ä»¥è§„é¿çš„ã€‚å½“ä¸€ä¸ªä»»åŠ¡è¦å¼€å§‹æ‰§è¡Œæ—¶ï¼Œä½ å¯ä»¥å¯¹ç³»ç»Ÿä¸­ç©ºé—²çš„èµ„æºå’Œä»»åŠ¡æ‰€éœ€çš„èµ„æºè¿›è¡Œåˆ†æï¼Œè¿™æ ·å°±å¯ä»¥åˆ¤æ–­ä»»åŠ¡æ˜¯å¦èƒ½å¤Ÿå¼€å§‹æ‰§è¡Œã€‚</li>
</ul>
<h2 id="å¿½ç•¥å®ƒä»¬"><a href="#å¿½ç•¥å®ƒä»¬" class="headerlink" title="å¿½ç•¥å®ƒä»¬"></a>å¿½ç•¥å®ƒä»¬</h2><p>æœ‰æ—¶å€™ä¹Ÿç§°ä¸ºé¸µé¸Ÿç­–ç•¥ï¼š<br>æŠŠå¤´åŸ‹åœ¨æ²™å­é‡Œï¼Œå‡è£…æ ¹æœ¬æ²¡å‘ç”Ÿé—®é¢˜ã€‚</p>
<p>å› ä¸ºè§£å†³æ­»é”é—®é¢˜çš„ä»£ä»·å¾ˆé«˜ï¼Œå› æ­¤é¸µé¸Ÿç­–ç•¥è¿™ç§ä¸é‡‡å–ä»»åŠ¡æªæ–½çš„æ–¹æ¡ˆä¼šè·å¾—æ›´é«˜çš„æ€§èƒ½ã€‚</p>
<p>å½“å‘ç”Ÿæ­»é”æ—¶ä¸ä¼šå¯¹ç”¨æˆ·é€ æˆå¤šå¤§å½±å“ï¼Œæˆ–å‘ç”Ÿæ­»é”çš„æ¦‚ç‡å¾ˆä½ï¼Œå¯ä»¥é‡‡ç”¨é¸µé¸Ÿç­–ç•¥ã€‚</p>
<p>å¤§å¤šæ•°æ“ä½œç³»ç»Ÿï¼ŒåŒ…æ‹¬ Unixï¼ŒLinux å’Œ Windowsï¼Œå¤„ç†æ­»é”é—®é¢˜çš„åŠæ³•ä»…ä»…æ˜¯å¿½ç•¥å®ƒã€‚</p>
<h2 id="æ­»é”æ£€æµ‹ä¸ä¿®å¤"><a href="#æ­»é”æ£€æµ‹ä¸ä¿®å¤" class="headerlink" title="æ­»é”æ£€æµ‹ä¸ä¿®å¤"></a>æ­»é”æ£€æµ‹ä¸ä¿®å¤</h2><ul>
<li>æ¯ç§ç±»å‹ä¸€ä¸ªèµ„æºçš„æ­»é”æ£€æµ‹<br>  <img src="What-is-deadlock-How-to-troubleshoot-deadlocks/1.png"><br>ä¸Šå›¾ä¸ºèµ„æºåˆ†é…å›¾ï¼Œå…¶ä¸­æ–¹æ¡†è¡¨ç¤ºèµ„æºï¼Œåœ†åœˆè¡¨ç¤ºè¿›ç¨‹ã€‚èµ„æºæŒ‡å‘è¿›ç¨‹è¡¨ç¤ºè¯¥èµ„æºå·²ç»åˆ†é…ç»™è¯¥è¿›ç¨‹ï¼Œè¿›ç¨‹æŒ‡å‘èµ„æºè¡¨ç¤ºè¿›ç¨‹è¯·æ±‚è·å–è¯¥èµ„æºã€‚<br>å›¾aå¯ä»¥æŠ½å–å‡ºç¯ï¼Œå¦‚å›¾bï¼Œå®ƒæ»¡è¶³äº†ç¯è·¯ç­‰å¾…æ¡ä»¶ï¼Œå› æ­¤ä¼šå‘ç”Ÿæ­»é”ã€‚</li>
<li>*æ¯ç§ç±»å‹ä¸€ä¸ªèµ„æºçš„æ­»é”æ£€æµ‹ç®—æ³•æ˜¯é€šè¿‡æ£€æµ‹æœ‰å‘å›¾æ˜¯å¦å­˜åœ¨ç¯æ¥å®ç°**ï¼Œä»ä¸€ä¸ªèŠ‚ç‚¹å‡ºå‘è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå¯¹è®¿é—®è¿‡çš„èŠ‚ç‚¹è¿›è¡Œæ ‡è®°ï¼Œå¦‚æœè®¿é—®äº†å·²ç»æ ‡è®°çš„èŠ‚ç‚¹ï¼Œå°±è¡¨ç¤ºæœ‰å‘å›¾å­˜åœ¨ç¯ï¼Œä¹Ÿå°±æ˜¯æ£€æµ‹åˆ°æ­»é”çš„å‘ç”Ÿã€‚</li>
<li>æ¯ç§ç±»å‹å¤šä¸ªèµ„æºçš„æ­»é”æ£€æµ‹<br><img src="What-is-deadlock-How-to-troubleshoot-deadlocks/2.png"><br>ä¸Šå›¾ä¸­ï¼Œæœ‰ä¸‰ä¸ªè¿›ç¨‹å››ä¸ªèµ„æºï¼Œæ¯ä¸ªæ•°æ®ä»£è¡¨çš„å«ä¹‰å¦‚ä¸‹ï¼š<ul>
<li>E å‘é‡ï¼šèµ„æºæ€»é‡</li>
<li>A å‘é‡ï¼šèµ„æºå‰©ä½™é‡</li>
<li>C çŸ©é˜µï¼šæ¯ä¸ªè¿›ç¨‹æ‰€æ‹¥æœ‰çš„èµ„æºæ•°é‡ï¼Œæ¯ä¸€è¡Œéƒ½ä»£è¡¨ä¸€ä¸ªè¿›ç¨‹æ‹¥æœ‰èµ„æºçš„æ•°é‡</li>
<li>R çŸ©é˜µï¼šæ¯ä¸ªè¿›ç¨‹è¯·æ±‚çš„èµ„æºæ•°é‡<br>è¿›ç¨‹ P1 å’Œ P2 æ‰€è¯·æ±‚çš„èµ„æºéƒ½å¾—ä¸åˆ°æ»¡è¶³ï¼Œåªæœ‰è¿›ç¨‹ P3 å¯ä»¥ï¼Œè®© P3 æ‰§è¡Œï¼Œä¹‹åé‡Šæ”¾ P3 æ‹¥æœ‰çš„èµ„æºï¼Œæ­¤æ—¶ A = (2 2 2 0)ã€‚P2 å¯ä»¥æ‰§è¡Œï¼Œæ‰§è¡Œåé‡Šæ”¾ P2 æ‹¥æœ‰çš„èµ„æºï¼ŒA = (4 2 2 1) ã€‚P1 ä¹Ÿå¯ä»¥æ‰§è¡Œã€‚æ‰€æœ‰è¿›ç¨‹éƒ½å¯ä»¥é¡ºåˆ©æ‰§è¡Œï¼Œæ²¡æœ‰æ­»é”ã€‚<br>ç®—æ³•æ€»ç»“å¦‚ä¸‹ï¼š<br>æ¯ä¸ªè¿›ç¨‹æœ€å¼€å§‹æ—¶éƒ½ä¸è¢«æ ‡è®°ï¼Œæ‰§è¡Œè¿‡ç¨‹æœ‰å¯èƒ½è¢«æ ‡è®°ã€‚å½“ç®—æ³•ç»“æŸæ—¶ï¼Œä»»ä½•æ²¡æœ‰è¢«æ ‡è®°çš„è¿›ç¨‹éƒ½æ˜¯æ­»é”è¿›ç¨‹ã€‚</li>
</ul>
<ol>
<li>å¯»æ‰¾ä¸€ä¸ªæ²¡æœ‰æ ‡è®°çš„è¿›ç¨‹ Piï¼Œå®ƒæ‰€è¯·æ±‚çš„èµ„æºå°äºç­‰äº Aã€‚</li>
<li>å¦‚æœæ‰¾åˆ°äº†è¿™æ ·ä¸€ä¸ªè¿›ç¨‹ï¼Œé‚£ä¹ˆå°† C çŸ©é˜µçš„ç¬¬ i è¡Œå‘é‡åŠ åˆ° A ä¸­ï¼Œæ ‡è®°è¯¥è¿›ç¨‹ï¼Œå¹¶è½¬å› 1ã€‚</li>
<li>å¦‚æœæ²¡æœ‰è¿™æ ·ä¸€ä¸ªè¿›ç¨‹ï¼Œç®—æ³•ç»ˆæ­¢ã€‚</li>
</ol>
</li>
<li>æ­»é”æ¢å¤<ul>
<li>åˆ©ç”¨æŠ¢å æ¢å¤</li>
<li>åˆ©ç”¨å›æ»šæ¢å¤</li>
<li>é€šè¿‡æ€æ­»è¿›ç¨‹æ¢å¤</li>
</ul>
</li>
</ul>
<h2 id="æ­»é”é¢„é˜²"><a href="#æ­»é”é¢„é˜²" class="headerlink" title="æ­»é”é¢„é˜²"></a>æ­»é”é¢„é˜²</h2><ul>
<li>ç ´åäº’æ–¥æ¡ä»¶<br>ä¾‹å¦‚å‡è„±æœºæ‰“å°æœºæŠ€æœ¯å…è®¸è‹¥å¹²ä¸ªè¿›ç¨‹åŒæ—¶è¾“å‡ºï¼Œå”¯ä¸€çœŸæ­£è¯·æ±‚ç‰©ç†æ‰“å°æœºçš„è¿›ç¨‹æ˜¯æ‰“å°æœºå®ˆæŠ¤è¿›ç¨‹ã€‚</li>
<li>ç ´åå æœ‰å¹¶ç­‰å¾…æ¡ä»¶<br>ä¸€ç§å®ç°æ–¹å¼æ˜¯è§„å®šæ‰€æœ‰è¿›ç¨‹åœ¨å¼€å§‹æ‰§è¡Œå‰è¯·æ±‚æ‰€éœ€è¦çš„å…¨éƒ¨èµ„æºã€‚</li>
<li>ç ´åä¸å¯æŠ¢å æ¡ä»¶</li>
<li>ç ´åç¯è·¯ç­‰å¾…<br>ç»™èµ„æºç»Ÿä¸€ç¼–å·ï¼Œè¿›ç¨‹åªèƒ½æŒ‰ç¼–å·é¡ºåºæ¥è¯·æ±‚èµ„æºã€‚</li>
</ul>
<p>æ¯”å¦‚:</p>
<ul>
<li>è¶…æ—¶æ”¾å¼ƒ<br>å½“ä½¿ç”¨synchronizedå…³é”®è¯æä¾›çš„å†…ç½®é”æ—¶ï¼Œåªè¦çº¿ç¨‹æ²¡æœ‰è·å¾—é”ï¼Œé‚£ä¹ˆå°±ä¼šæ°¸è¿œç­‰å¾…ä¸‹å»ï¼Œç„¶è€ŒLockæ¥å£æä¾›äº†boolean tryLock(long time, TimeUnit unit) throws InterruptedExceptionæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥æŒ‰ç…§å›ºå®šæ—¶é•¿ç­‰å¾…é”ï¼Œå› æ­¤çº¿ç¨‹å¯ä»¥åœ¨è·å–é”è¶…æ—¶ä»¥åï¼Œä¸»åŠ¨é‡Šæ”¾ä¹‹å‰å·²ç»è·å¾—çš„æ‰€æœ‰çš„é”ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä¹Ÿå¯ä»¥å¾ˆæœ‰æ•ˆåœ°é¿å…æ­»é”ã€‚</li>
</ul>
<h2 id="æ­»é”è§„é¿-é¿å…"><a href="#æ­»é”è§„é¿-é¿å…" class="headerlink" title="æ­»é”è§„é¿(é¿å…)"></a>æ­»é”è§„é¿(é¿å…)</h2><p>åœ¨ç¨‹åºè¿è¡Œæ—¶é¿å…å‘ç”Ÿæ­»é”ã€‚</p>
<ul>
<li><p>å®‰å…¨çŠ¶æ€<br><img src="What-is-deadlock-How-to-troubleshoot-deadlocks/3.png"><br>å›¾ a çš„ç¬¬äºŒåˆ— Has è¡¨ç¤ºå·²æ‹¥æœ‰çš„èµ„æºæ•°ï¼Œç¬¬ä¸‰åˆ— Max è¡¨ç¤ºæ€»å…±éœ€è¦çš„èµ„æºæ•°ï¼ŒFree è¡¨ç¤ºè¿˜æœ‰å¯ä»¥ä½¿ç”¨çš„èµ„æºæ•°ã€‚ä»å›¾ a å¼€å§‹å‡ºå‘ï¼Œå…ˆè®© B æ‹¥æœ‰æ‰€éœ€çš„æ‰€æœ‰èµ„æºï¼ˆå›¾ bï¼‰ï¼Œè¿è¡Œç»“æŸåé‡Šæ”¾ Bï¼Œæ­¤æ—¶ Free å˜ä¸º 5ï¼ˆå›¾ cï¼‰ï¼›æ¥ç€ä»¥åŒæ ·çš„æ–¹å¼è¿è¡Œ C å’Œ Aï¼Œä½¿å¾—æ‰€æœ‰è¿›ç¨‹éƒ½èƒ½æˆåŠŸè¿è¡Œï¼Œå› æ­¤å¯ä»¥ç§°å›¾ a æ‰€ç¤ºçš„çŠ¶æ€æ—¶å®‰å…¨çš„ã€‚</p>
<p>å®šä¹‰ï¼šå¦‚æœæ²¡æœ‰æ­»é”å‘ç”Ÿï¼Œå¹¶ä¸”å³ä½¿æ‰€æœ‰è¿›ç¨‹çªç„¶è¯·æ±‚å¯¹èµ„æºçš„æœ€å¤§éœ€æ±‚ï¼Œä¹Ÿä»ç„¶å­˜åœ¨æŸç§è°ƒåº¦æ¬¡åºèƒ½å¤Ÿä½¿å¾—æ¯ä¸€ä¸ªè¿›ç¨‹è¿è¡Œå®Œæ¯•ï¼Œåˆ™ç§°è¯¥çŠ¶æ€æ˜¯å®‰å…¨çš„ã€‚</p>
<p>å®‰å…¨çŠ¶æ€çš„æ£€æµ‹ä¸æ­»é”çš„æ£€æµ‹ç±»ä¼¼ï¼Œå› ä¸ºå®‰å…¨çŠ¶æ€å¿…é¡»è¦æ±‚ä¸èƒ½å‘ç”Ÿæ­»é”ã€‚ä¸‹é¢çš„é“¶è¡Œå®¶ç®—æ³•ä¸æ­»é”æ£€æµ‹ç®—æ³•éå¸¸ç±»ä¼¼ï¼Œå¯ä»¥ç»“åˆç€åšå‚è€ƒå¯¹æ¯”ã€‚</p>
</li>
<li><p>å•ä¸ªèµ„æºçš„é“¶è¡Œå®¶ç®—æ³•<br>ä¸€ä¸ªå°åŸé•‡çš„é“¶è¡Œå®¶ï¼Œä»–å‘ä¸€ç¾¤å®¢æˆ·åˆ†åˆ«æ‰¿è¯ºäº†ä¸€å®šçš„è´·æ¬¾é¢åº¦ï¼Œç®—æ³•è¦åšçš„æ˜¯åˆ¤æ–­å¯¹è¯·æ±‚çš„æ»¡è¶³æ˜¯å¦ä¼šè¿›å…¥ä¸å®‰å…¨çŠ¶æ€ï¼Œå¦‚æœæ˜¯ï¼Œå°±æ‹’ç»è¯·æ±‚ï¼›å¦åˆ™äºˆä»¥åˆ†é…ã€‚<br><img src="What-is-deadlock-How-to-troubleshoot-deadlocks/4.png"><br>ä¸Šå›¾ c ä¸ºä¸å®‰å…¨çŠ¶æ€ï¼Œå› æ­¤ç®—æ³•ä¼šæ‹’ç»ä¹‹å‰çš„è¯·æ±‚ï¼Œä»è€Œé¿å…è¿›å…¥å›¾ c ä¸­çš„çŠ¶æ€ã€‚</p>
</li>
<li><p>å¤šä¸ªèµ„æºçš„é“¶è¡Œå®¶ç®—æ³•<br><img src="What-is-deadlock-How-to-troubleshoot-deadlocks/5.png"><br>ä¸Šå›¾ä¸­æœ‰äº”ä¸ªè¿›ç¨‹ï¼Œå››ä¸ªèµ„æºã€‚å·¦è¾¹çš„å›¾è¡¨ç¤ºå·²ç»åˆ†é…çš„èµ„æºï¼Œå³è¾¹çš„å›¾è¡¨ç¤ºè¿˜éœ€è¦åˆ†é…çš„èµ„æºã€‚æœ€å³è¾¹çš„ Eã€P ä»¥åŠ A åˆ†åˆ«è¡¨ç¤ºï¼šæ€»èµ„æºã€å·²åˆ†é…èµ„æºä»¥åŠå¯ç”¨èµ„æºï¼Œæ³¨æ„è¿™ä¸‰ä¸ªä¸ºå‘é‡ï¼Œè€Œä¸æ˜¯å…·ä½“æ•°å€¼ï¼Œä¾‹å¦‚ A=(1020)ï¼Œè¡¨ç¤º 4 ä¸ªèµ„æºåˆ†åˆ«è¿˜å‰©ä¸‹ 1/0/2/0ã€‚</p>
<p>æ£€æŸ¥ä¸€ä¸ªçŠ¶æ€æ˜¯å¦å®‰å…¨çš„ç®—æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li>æŸ¥æ‰¾å³è¾¹çš„çŸ©é˜µæ˜¯å¦å­˜åœ¨ä¸€è¡Œå°äºç­‰äºå‘é‡ Aã€‚å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„è¡Œï¼Œé‚£ä¹ˆç³»ç»Ÿå°†ä¼šå‘ç”Ÿæ­»é”ï¼ŒçŠ¶æ€æ˜¯ä¸å®‰å…¨çš„ã€‚</li>
<li>å‡è‹¥æ‰¾åˆ°è¿™æ ·ä¸€è¡Œï¼Œå°†è¯¥è¿›ç¨‹æ ‡è®°ä¸ºç»ˆæ­¢ï¼Œå¹¶å°†å…¶å·²åˆ†é…èµ„æºåŠ åˆ° A ä¸­ã€‚</li>
<li>é‡å¤ä»¥ä¸Šä¸¤æ­¥ï¼Œç›´åˆ°æ‰€æœ‰è¿›ç¨‹éƒ½æ ‡è®°ä¸ºç»ˆæ­¢ï¼Œåˆ™çŠ¶æ€æ—¶å®‰å…¨çš„ã€‚<br>å¦‚æœä¸€ä¸ªçŠ¶æ€ä¸æ˜¯å®‰å…¨çš„ï¼Œéœ€è¦æ‹’ç»è¿›å…¥è¿™ä¸ªçŠ¶æ€ã€‚</li>
</ul>
</li>
</ul>
<h1 id="ä¸¾ä¸ªæ —å­"><a href="#ä¸¾ä¸ªæ —å­" class="headerlink" title="ä¸¾ä¸ªæ —å­"></a>ä¸¾ä¸ªæ —å­</h1><p><a target="_blank" rel="noopener" href="http://tpcg.io/EW1UmT">http://tpcg.io/EW1UmT</a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Object a = <span class="keyword">new</span> Object();</span><br><span class="line">    <span class="keyword">final</span> Object b = <span class="keyword">new</span> Object();</span><br><span class="line">    Thread threadA = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (a) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;now i in threadA-locka&quot;</span>);</span><br><span class="line">                    Thread.sleep(<span class="number">1000l</span>);</span><br><span class="line">                    <span class="keyword">synchronized</span> (b) &#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;now i in threadA-lockb&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    <span class="comment">// ignore</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    Thread threadB = <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (b) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;now i in threadB-lockb&quot;</span>);</span><br><span class="line">                    Thread.sleep(<span class="number">1000l</span>);</span><br><span class="line">                    <span class="keyword">synchronized</span> (a) &#123;</span><br><span class="line">                        System.out.println(<span class="string">&quot;now i in threadB-locka&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    <span class="comment">// ignore</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    threadA.start();</span><br><span class="line">    threadB.start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¨‹åºæ‰§è¡Œç»“æœ:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">now i in threadA-locka</span><br><span class="line">now i in threadB-lockb</span><br></pre></td></tr></table></figure>

<h1 id="æ­»é”æ£€æµ‹"><a href="#æ­»é”æ£€æµ‹" class="headerlink" title="æ­»é”æ£€æµ‹"></a>æ­»é”æ£€æµ‹</h1><h2 id="Jstackå‘½ä»¤"><a href="#Jstackå‘½ä»¤" class="headerlink" title="Jstackå‘½ä»¤"></a>Jstackå‘½ä»¤</h2><p>jstackæ˜¯javaè™šæ‹Ÿæœºè‡ªå¸¦çš„ä¸€ç§å †æ ˆè·Ÿè¸ªå·¥å…·ã€‚jstackç”¨äºæ‰“å°å‡ºç»™å®šçš„javaè¿›ç¨‹IDæˆ–core fileæˆ–è¿œç¨‹è°ƒè¯•æœåŠ¡çš„Javaå †æ ˆä¿¡æ¯ã€‚<br>Jstackå·¥å…·å¯ä»¥ç”¨äºç”Ÿæˆjavaè™šæ‹Ÿæœºå½“å‰æ—¶åˆ»çš„çº¿ç¨‹å¿«ç…§ã€‚çº¿ç¨‹å¿«ç…§æ˜¯å½“å‰javaè™šæ‹Ÿæœºå†…æ¯ä¸€æ¡çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•å †æ ˆçš„é›†åˆï¼Œç”Ÿæˆçº¿ç¨‹å¿«ç…§çš„ä¸»è¦ç›®çš„æ˜¯å®šä½çº¿ç¨‹å‡ºç°é•¿æ—¶é—´åœé¡¿çš„åŸå› ï¼Œå¦‚çº¿ç¨‹é—´æ­»é”ã€æ­»å¾ªç¯ã€è¯·æ±‚å¤–éƒ¨èµ„æºå¯¼è‡´çš„é•¿æ—¶é—´ç­‰å¾…ç­‰ã€‚ çº¿ç¨‹å‡ºç°åœé¡¿çš„æ—¶å€™é€šè¿‡jstackæ¥æŸ¥çœ‹å„ä¸ªçº¿ç¨‹çš„è°ƒç”¨å †æ ˆï¼Œå°±å¯ä»¥çŸ¥é“æ²¡æœ‰å“åº”çš„çº¿ç¨‹åˆ°åº•åœ¨åå°åšä»€ä¹ˆäº‹æƒ…ï¼Œæˆ–è€…ç­‰å¾…ä»€ä¹ˆèµ„æºã€‚<br>é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡jpsç¡®å®šå½“å‰æ‰§è¡Œä»»åŠ¡çš„è¿›ç¨‹å·:</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡jpsç¡®å®šå½“å‰æ‰§è¡Œä»»åŠ¡çš„è¿›ç¨‹å·:<br><img src="What-is-deadlock-How-to-troubleshoot-deadlocks/6.png"></p>
<p>å¯ä»¥ç¡®å®šä»»åŠ¡è¿›ç¨‹å·æ˜¯51028ï¼Œç„¶åæ‰§è¡Œjstackå‘½ä»¤æŸ¥çœ‹å½“å‰è¿›ç¨‹å †æ ˆä¿¡æ¯(åœ¨eclipseä¸­è¿è¡Œåå¯èƒ½ä¼šæœ‰jstackæ— æ³•è¿æ¥æŠ¥é”™çš„ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘æ¢æˆäº†IDEAæ¥æ‰§è¡Œ ORZ)ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\homxu&gt;jps</span><br><span class="line">10896</span><br><span class="line">47284 Jps</span><br><span class="line">52168 DeadLock</span><br><span class="line"></span><br><span class="line">C:\Users\homxu&gt;jstack -F 52168</span><br><span class="line">Attaching to process ID 52168, please wait...</span><br><span class="line">Debugger attached successfully.</span><br><span class="line">Server compiler detected.</span><br><span class="line">JVM version is 25.144-b01</span><br><span class="line">Deadlock Detection:</span><br><span class="line"></span><br><span class="line">Found one Java-level deadlock:</span><br><span class="line">=============================</span><br><span class="line"></span><br><span class="line">&quot;Thread-0&quot;:</span><br><span class="line">  waiting to lock Monitor@0x00000000569a3968 (Object@0x00000000e071b2f8, a java/lang/Object),</span><br><span class="line">  which is held by &quot;Thread-1&quot;</span><br><span class="line">&quot;Thread-1&quot;:</span><br><span class="line">  waiting to lock Monitor@0x00000000569a1188 (Object@0x00000000e071b2e8, a java/lang/Object),</span><br><span class="line">  which is held by &quot;Thread-0&quot;</span><br><span class="line"></span><br><span class="line">Found a total of 1 deadlock.</span><br><span class="line"></span><br><span class="line">Thread 1: (state = BLOCKED)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Thread 23: (state = BLOCKED)</span><br><span class="line"> - com.study.DeadLock$2.run() @bci=28, line=30 (Interpreted frame)</span><br><span class="line"> - java.lang.Thread.run() @bci=11, line=748 (Interpreted frame)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Thread 22: (state = BLOCKED)</span><br><span class="line"> - com.study.DeadLock$1.run() @bci=28, line=14 (Interpreted frame)</span><br><span class="line"> - java.lang.Thread.run() @bci=11, line=748 (Interpreted frame)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Thread 15: (state = IN_NATIVE)</span><br><span class="line"> - java.net.SocketInputStream.socketRead0(java.io.FileDescriptor, byte[], int, int, int) @bci=0 (Interpreted frame)</span><br><span class="line"></span><br><span class="line"> - java.net.SocketInputStream.socketRead(java.io.FileDescriptor, byte[], int, int, int) @bci=8, line=116 (Interpret</span><br><span class="line">ed frame)</span><br><span class="line"> - java.net.SocketInputStream.read(byte[], int, int, int) @bci=117, line=171 (Interpreted frame)</span><br><span class="line"> - java.net.SocketInputStream.read(byte[], int, int) @bci=11, line=141 (Interpreted frame)</span><br><span class="line"> - sun.nio.cs.StreamDecoder.readBytes() @bci=135, line=284 (Interpreted frame)</span><br><span class="line"> - sun.nio.cs.StreamDecoder.implRead(char[], int, int) @bci=112, line=326 (Interpreted frame)</span><br><span class="line"> - sun.nio.cs.StreamDecoder.read(char[], int, int) @bci=180, line=178 (Interpreted frame)</span><br><span class="line"> - java.io.InputStreamReader.read(char[], int, int) @bci=7, line=184 (Interpreted frame)</span><br><span class="line"> - java.io.BufferedReader.fill() @bci=145, line=161 (Interpreted frame)</span><br><span class="line"> - java.io.BufferedReader.readLine(boolean) @bci=44, line=324 (Interpreted frame)</span><br><span class="line"> - java.io.BufferedReader.readLine() @bci=2, line=389 (Interpreted frame)</span><br><span class="line"> - com.intellij.rt.execution.application.AppMainV2$1.run() @bci=36, line=64 (Interpreted frame)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Thread 14: (state = BLOCKED)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Thread 13: (state = BLOCKED)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Thread 12: (state = BLOCKED)</span><br><span class="line"> - java.lang.Object.wait(long) @bci=0 (Interpreted frame)</span><br><span class="line"> - java.lang.ref.ReferenceQueue.remove(long) @bci=59, line=143 (Interpreted frame)</span><br><span class="line"> - java.lang.ref.ReferenceQueue.remove() @bci=2, line=164 (Interpreted frame)</span><br><span class="line"> - java.lang.ref.Finalizer$FinalizerThread.run() @bci=36, line=209 (Interpreted frame)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Thread 11: (state = BLOCKED)</span><br><span class="line"> - java.lang.Object.wait(long) @bci=0 (Interpreted frame)</span><br><span class="line"> - java.lang.Object.wait() @bci=2, line=502 (Interpreted frame)</span><br><span class="line"> - java.lang.ref.Reference.tryHandlePending(boolean) @bci=54, line=191 (Interpreted frame)</span><br><span class="line"> - java.lang.ref.Reference$ReferenceHandler.run() @bci=1, line=153 (Interpreted frame)</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿›ç¨‹çš„ç¡®å­˜åœ¨æ­»é”ï¼Œä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«åœ¨ç­‰å¾…å¯¹æ–¹æŒæœ‰çš„Objectå¯¹è±¡</p>
<h2 id="JConsoleå·¥å…·"><a href="#JConsoleå·¥å…·" class="headerlink" title="JConsoleå·¥å…·"></a>JConsoleå·¥å…·</h2><p>Jconsoleæ˜¯JDKè‡ªå¸¦çš„ç›‘æ§å·¥å…·ï¼Œåœ¨JDK/binç›®å½•ä¸‹å¯ä»¥æ‰¾åˆ°ã€‚å®ƒç”¨äºè¿æ¥æ­£åœ¨è¿è¡Œçš„æœ¬åœ°æˆ–è€…è¿œç¨‹çš„JVMï¼Œå¯¹è¿è¡Œåœ¨Javaåº”ç”¨ç¨‹åºçš„èµ„æºæ¶ˆè€—å’Œæ€§èƒ½è¿›è¡Œç›‘æ§ï¼Œå¹¶ç”»å‡ºå¤§é‡çš„å›¾è¡¨ï¼Œæä¾›å¼ºå¤§çš„å¯è§†åŒ–ç•Œé¢ã€‚è€Œä¸”æœ¬èº«å ç”¨çš„æœåŠ¡å™¨å†…å­˜å¾ˆå°ï¼Œç”šè‡³å¯ä»¥è¯´å‡ ä¹ä¸æ¶ˆè€—ã€‚<br>æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­æ•²å…¥jconsoleå‘½ä»¤ï¼Œä¼šè‡ªåŠ¨å¼¹å‡ºä»¥ä¸‹å¯¹è¯æ¡†ï¼Œé€‰æ‹©è¿›ç¨‹52168ï¼Œå¹¶ç‚¹å‡»â€œé“¾æ¥â€<br><img src="What-is-deadlock-How-to-troubleshoot-deadlocks/7.png"></p>
<p><img src="What-is-deadlock-How-to-troubleshoot-deadlocks/8.png"></p>
<p><img src="What-is-deadlock-How-to-troubleshoot-deadlocks/9.png"></p>
<p>å¯ä»¥çœ‹åˆ°è¿›ç¨‹ä¸­å­˜åœ¨æ­»é”ã€‚<br>ä»¥ä¸Šä¾‹å­æˆ‘éƒ½æ˜¯ç”¨synchronizedå…³é”®è¯å®ç°çš„æ­»é”ï¼Œå¦‚æœè¯»è€…ç”¨ReentrantLockåˆ¶é€ ä¸€æ¬¡æ­»é”ï¼Œå†æ¬¡ä½¿ç”¨æ­»é”æ£€æµ‹å·¥å…·ï¼Œä¹ŸåŒæ ·èƒ½æ£€æµ‹åˆ°æ­»é”ï¼Œä¸è¿‡æ˜¾ç¤ºçš„ä¿¡æ¯å°†ä¼šæ›´åŠ ä¸°å¯Œï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥è‡ªå·±å°è¯•ä¸€ä¸‹ã€‚</p>
<blockquote>
<p>åœ¨æˆ‘çš„ç†è§£å½“ä¸­ï¼Œæ­»é”å°±æ˜¯â€œä¸¤ä¸ªä»»åŠ¡ä»¥ä¸åˆç†çš„é¡ºåºäº’ç›¸äº‰å¤ºèµ„æºâ€é€ æˆï¼Œå› æ­¤ä¸ºäº†è§„é¿æ­»é”ï¼Œåº”ç”¨ç¨‹åºéœ€è¦å¦¥å–„å¤„ç†èµ„æºè·å–çš„é¡ºåºã€‚<br>å¦å¤–æœ‰äº›æ—¶å€™ï¼Œæ­»é”å¹¶ä¸ä¼šé©¬ä¸Šåœ¨åº”ç”¨ç¨‹åºä¸­ä½“ç°å‡ºæ¥ï¼Œåœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯åº”ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒè¿è¡Œäº†ä¸€æ®µæ—¶é—´åï¼Œæ‰å¼€å§‹æ…¢æ…¢æ˜¾ç°å‡ºæ¥ï¼Œåœ¨å®é™…æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œç”±äºæ­»é”çš„éšè”½æ€§ï¼Œå¾ˆéš¾åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­åŠæ—¶å‘ç°æ­»é”çš„å­˜åœ¨ï¼Œè€Œä¸”åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”ç”¨å‡ºç°äº†æ­»é”ï¼Œå¾€å¾€éƒ½æ˜¯åœ¨åº”ç”¨çŠ¶å†µæœ€ç³Ÿç³•çš„æ—¶å€™â€”â€”åœ¨é«˜è´Ÿè½½æƒ…å†µä¸‹ã€‚å› æ­¤ï¼Œå¼€å‘è€…åœ¨å¼€å‘è¿‡ç¨‹ä¸­è¦è°¨æ…åˆ†ææ¯ä¸ªç³»ç»Ÿèµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œåˆç†è§„é¿æ­»é”ï¼Œå¦å¤–ä¸€æ—¦å‡ºç°äº†æ­»é”ï¼Œä¹Ÿå¯ä»¥å°è¯•ä½¿ç”¨æœ¬æ–‡ä¸­æåˆ°çš„ä¸€äº›å·¥å…·ï¼Œä»”ç»†åˆ†æï¼Œæ€»æ˜¯èƒ½æ‰¾åˆ°é—®é¢˜æ‰€åœ¨çš„ã€‚</p>
</blockquote>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul>
<li>ã€Šç²¾é€šJAVAå¹¶å‘ç¼–ç¨‹(ç¬¬äºŒç‰ˆ)ã€‹</li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/thomaschen750215/p/4109646.html">https://www.cnblogs.com/thomaschen750215/p/4109646.html</a></li>
<li><a target="_blank" rel="noopener" href="https://cyc2018.github.io/CS-Notes/#/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20-%20%E6%AD%BB%E9%94%81?id=%E6%AD%BB%E9%94%81%E6%A3%80%E6%B5%8B%E4%B8%8E%E6%AD%BB%E9%94%81%E6%81%A2%E5%A4%8D">https://cyc2018.github.io/CS-Notes/#/notes/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20-%20%E6%AD%BB%E9%94%81?id=%E6%AD%BB%E9%94%81%E6%A3%80%E6%B5%8B%E4%B8%8E%E6%AD%BB%E9%94%81%E6%81%A2%E5%A4%8D</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.im/post/5aaf6ee76fb9a028d3753534#heading-1">https://juejin.im/post/5aaf6ee76fb9a028d3753534#heading-1</a></li>
</ul>
<script type="text/javascript" src="https://www.draw.io/js/viewer.min.js"></script>
  <p><a class="classtest-link" href="/tags/%E5%B9%B6%E5%8F%91/" rel="tag">å¹¶å‘</a> â€” Jun 12, 2019</p>
  


        </div>
        <div class="row mt-2">
  <h3>Search</h3>
  <div><input id="search-text" title="search" class="search-text" type="text" placeholder="search......"></div>
  <div style="margin-top: 1.5rem;">
    <ul id="result"></ul>
  </div>
</div>
        <div class="row mt-2">
  
    <div class="eight columns">
      <p id="madewith">Made with â¤ and
        <a class="footer-link icon" href="https://hexo.io" target="_blank" style="text-decoration: none;" rel="noreferrer" aria-label="Hexo.io">
        <svg class="hexo svg-hov" width="14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Hexo.js</title><path d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"/></svg>
        </a>
        
        at <a href="https://en.wikipedia.org/wiki/Earth" target="_blank" rel="noreferrer">Earth</a>.</p>
        
    </div>

    <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
    <div class="four columns mb-3 posisi" >
      
      <a class="ml-0 footer-link icon" href="https://github.com/homxuwang" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="GitHub">
        <svg class="github svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
      </a>
      

      

      

      

      

    </div>
  
</div>

      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>

  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

</body>

</html>