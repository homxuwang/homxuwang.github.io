<!DOCTYPE html>
<html lang="zh-Hans">

<head>

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta charset="utf-8">

  
  <title>Springå¸¸ç”¨æ³¨è§£</title>
  
  <link rel="canonical" href="http://homxuwang.github.io/2019/07/01/Spring%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/">
  
  <meta name="description" content="ç»„ä»¶æ³¨å†Œ@Configuration@Configuration æ”¾åœ¨å¯¹åº”ç±»çš„ä¸Šé¢,å‘Šè¯‰springè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚ é…ç½®ç±» == é…ç½®æ–‡ä»¶ @ComponentScan@ComponentScan æŒ‰ç…§ä¸€å®šè§„åˆ™è‡ªåŠ¨æ‰«ææŒ‡å®šåŒ…ä¸­çš„ç»„ä»¶ï¼ŒåŠ å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚å‡ ä¸ªå¸¸ç”¨çš„å€¼ï¼š value@Componen">
  
  
  <meta name="author" content="homxuwang">
  
  
  
  <meta property="og:site_name" content="Homxu" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Springå¸¸ç”¨æ³¨è§£" />
  
  <meta property="og:description" content="ç»„ä»¶æ³¨å†Œ@Configuration@Configuration æ”¾åœ¨å¯¹åº”ç±»çš„ä¸Šé¢,å‘Šè¯‰springè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚ é…ç½®ç±» == é…ç½®æ–‡ä»¶ @ComponentScan@ComponentScan æŒ‰ç…§ä¸€å®šè§„åˆ™è‡ªåŠ¨æ‰«ææŒ‡å®šåŒ…ä¸­çš„ç»„ä»¶ï¼ŒåŠ å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚å‡ ä¸ªå¸¸ç”¨çš„å€¼ï¼š value@Componen">
  
  <meta property="og:url" content="http://homxuwang.github.io/2019/07/01/Spring%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Springå¸¸ç”¨æ³¨è§£">
  
  <meta name="twitter:description" content="ç»„ä»¶æ³¨å†Œ@Configuration@Configuration æ”¾åœ¨å¯¹åº”ç±»çš„ä¸Šé¢,å‘Šè¯‰springè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚ é…ç½®ç±» == é…ç½®æ–‡ä»¶ @ComponentScan@ComponentScan æŒ‰ç…§ä¸€å®šè§„åˆ™è‡ªåŠ¨æ‰«ææŒ‡å®šåŒ…ä¸­çš„ç»„ä»¶ï¼ŒåŠ å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚å‡ ä¸ªå¸¸ç”¨çš„å€¼ï¼š value@Componen">
  
  
  
  
  <meta name="twitter:url" content="http://homxuwang.github.io/2019/07/01/Spring%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/" />

  <!-- Mobile Specific Metas
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="preload" href="/fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  
<link rel="stylesheet" href="/css/normalize.css">

  
<link rel="stylesheet" href="/css/skeleton.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
<link rel="stylesheet" href="/css/prism-dark.css">

  
<link rel="stylesheet" href="/css/prism-line-numbers.css">

  <!-- User css -->
  
  
<link rel="stylesheet" href="/css/user.css">

  

  <!-- Favicon
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

  <!-- Custom Theme Color Style
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <style>
  a:not(.icon) {
    text-decoration-color: #0FA0CE;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #0FA0CE 50%
    );
  }
  blockquote {
    border-left: 8px solid #0FA0CE;
  }
  .nanobar .bar {
    background: #0FA0CE;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #0FA0CE;
    border-color: #0FA0CE;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #0FA0CE;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  

  
  <script src="/js/pic.min.js" defer></script>
  

  
  <script src="/js/search.min.js" defer></script>
  

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="two columns" style="max-width: 50px">
    <h1 class="mt-2 mode">
      <div onclick=setDarkMode(true) id="darkBtn">ğŸŒ‘</div>
      <div onclick=setDarkMode(false) id="lightBtn" class=hidden>â˜€ï¸</div>
      <script >
        if (localStorage.getItem('preferredTheme') == 'dark') {
          setDarkMode(true)
        }
        function setDarkMode(isDark) {
          var darkBtn = document.getElementById('darkBtn')
          var lightBtn = document.getElementById('lightBtn')
          if (isDark) {
            lightBtn.style.display = "block"
            darkBtn.style.display = "none"
            localStorage.setItem('preferredTheme', 'dark');
          } else {
            lightBtn.style.display = "none"
            darkBtn.style.display = "block"
            localStorage.removeItem('preferredTheme');
          }
          document.body.classList.toggle("darkmode");
        }
      </script>
    </h1>
  </div>

  <div class="six columns ml-1">
    <h1 class="mt-2">
      Hi July.HX
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/">Home</a>
        
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>

        <div class="trans">
            <h2>Springå¸¸ç”¨æ³¨è§£</h2>

  <h1 id="ç»„ä»¶æ³¨å†Œ"><a href="#ç»„ä»¶æ³¨å†Œ" class="headerlink" title="ç»„ä»¶æ³¨å†Œ"></a>ç»„ä»¶æ³¨å†Œ</h1><h2 id="Configuration"><a href="#Configuration" class="headerlink" title="@Configuration"></a>@Configuration</h2><p>@Configuration æ”¾åœ¨å¯¹åº”ç±»çš„ä¸Šé¢,å‘Šè¯‰springè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»ã€‚</p>
<p>é…ç½®ç±» == é…ç½®æ–‡ä»¶</p>
<h2 id="ComponentScan"><a href="#ComponentScan" class="headerlink" title="@ComponentScan"></a>@ComponentScan</h2><p>@ComponentScan æŒ‰ç…§ä¸€å®šè§„åˆ™è‡ªåŠ¨æ‰«ææŒ‡å®šåŒ…ä¸­çš„ç»„ä»¶ï¼ŒåŠ å…¥åˆ°IOCå®¹å™¨ä¸­ã€‚<br>å‡ ä¸ªå¸¸ç”¨çš„å€¼ï¼š</p>
<h3 id="value"><a href="#value" class="headerlink" title="value"></a>value</h3><p>@ComponentScan(value = â€œcom.studyâ€)  è®¾ç½®è¦æ‰«æçš„åŒ…è·¯å¾„</p>
<h3 id="excludeFilters"><a href="#excludeFilters" class="headerlink" title="excludeFilters"></a>excludeFilters</h3><p>excludeFilters : Filter[] excludeFilters() default {}; </p>
<p>å…¶æ ¸å¿ƒæ˜¯è®¾ç½®Filteræ•°ç»„ï¼Œå³è¿‡æ»¤è§„åˆ™æ•°ç»„ï¼Œæ‰€ä»¥åœ¨ä»‹ç»<code>excludeFilters</code>ä¹‹å‰ï¼Œè¦ä»‹ç»<code>@ComponentScan.Filter</code>ï¼š</p>
<h4 id="ComponentScan-Filter"><a href="#ComponentScan-Filter" class="headerlink" title="@ComponentScan.Filter"></a>@ComponentScan.Filter</h4><p>æŒ‡å®šæ‰«ææ—¶æŒ‰ç…§ä»€ä¹ˆè§„åˆ™æ’é™¤ç»„ä»¶,æ˜¯ä¸€ä¸ªFilteræ•°ç»„ï¼Œå…¶ä¸­Filteræ•°ç»„ä¸­å¯ä»¥è®¾ç½®æ’é™¤è§„åˆ™type:</p>
<ul>
<li>FilterType.ANNOTATION : æŒ‰ç…§æ³¨è§£è¿›è¡Œè¿‡æ»¤</li>
<li>FilterType.ASSIGNABLE_TYPE: æŒ‰ç…§æŒ‡å®šç±»å‹è¿›è¡Œè¿‡æ»¤</li>
<li>FilterType.ASPECTJ : ASPECTJè¡¨è¾¾å¼(åŸºæœ¬ä¸ç”¨</li>
<li>FilterType.REGEX : ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</li>
<li>FilterType.CUSTOM : ä½¿ç”¨è‡ªå®šä¹‰è§„åˆ™</li>
</ul>
<p>å¦‚ï¼š</p>
<p>æŒ‰ç…§æ³¨è§£è¿›è¡Œè¿‡æ»¤ï¼Œæ’é™¤ç”¨<code>@Service</code>è¿›è¡Œæ³¨è§£çš„ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan(</span></span><br><span class="line"><span class="meta">   value = &quot;com.study&quot;,</span></span><br><span class="line"><span class="meta">   excludeFilters = &#123;</span></span><br><span class="line"><span class="meta">      @ComponentScan.Filter(type = FilterType.ANNOTATION , value = &#123;Service.class&#125;)</span></span><br><span class="line"><span class="meta">    &#125;</span></span><br><span class="line"><span class="meta">)</span></span><br></pre></td></tr></table></figure>

<p>æŒ‰ç…§æŒ‡å®šç±»è¿›è¡Œè¿‡æ»¤,å¦‚æ’é™¤<code>BookService</code>ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan(</span></span><br><span class="line"><span class="meta">   value = &quot;com.study&quot;,</span></span><br><span class="line"><span class="meta">   excludeFilters = &#123;</span></span><br><span class="line"><span class="meta">      @ComponentScan.Filter(type = FilterType.ANNOTATION , value = &#123;Service.class&#125;)</span></span><br><span class="line"><span class="meta">    &#125;</span></span><br><span class="line"><span class="meta">)</span></span><br></pre></td></tr></table></figure>

<p>æŒ‰ç…§è‡ªå®šä¹‰è§„åˆ™è¿›è¡Œè¿‡æ»¤,è¿™æ—¶å€™è¦è‡ªå·±å®šä¹‰è¿‡æ»¤è§„åˆ™(ä¸€ä¸ªç»§æ‰¿äº†<code>org.springframework.core.type.filter.TypeFilter</code>æ¥å£çš„ç±»):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan(</span></span><br><span class="line"><span class="meta">   value = &quot;com.study&quot;,</span></span><br><span class="line"><span class="meta">   excludeFilters = &#123;</span></span><br><span class="line"><span class="meta">       @ComponentScan.Filter(type = FilterType.CUSTOM,classes = &#123;MyTypeFilter.class&#125;)</span></span><br><span class="line"><span class="meta">    &#125;</span></span><br><span class="line"><span class="meta">)</span></span><br></pre></td></tr></table></figure>
<p>å¦‚<code>MyTypeFilter.java</code>,å¯ä»¥è·å–åˆ°ç±»åä¸­å«æœ‰<code>er</code>çš„ç±»:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.study.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.Resource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.type.AnnotationMetadata;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.type.ClassMetadata;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.type.classreading.MetadataReader;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.type.classreading.MetadataReaderFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.type.filter.TypeFilter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyTypeFilter</span> <span class="keyword">implements</span> <span class="title">TypeFilter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> metadataReader è¯»å–åˆ°çš„å½“å‰æ­£åœ¨æ‰«æçš„ç±»çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> metadataReaderFactory å¯ä»¥è·å–åˆ°å…¶ä»–ä»»ä½•ç±»çš„ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">match</span><span class="params">(MetadataReader metadataReader, MetadataReaderFactory metadataReaderFactory)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">//è·å–å½“å‰æ­£åœ¨æ‰«æçš„ç±»æ³¨è§£çš„ä¿¡æ¯</span></span><br><span class="line">        AnnotationMetadata annotationMetadata = metadataReader.getAnnotationMetadata();</span><br><span class="line">        <span class="comment">//è·å–å½“å‰æ­£åœ¨æ‰«æçš„ç±»çš„ä¿¡æ¯</span></span><br><span class="line">        ClassMetadata classMetadata = metadataReader.getClassMetadata();</span><br><span class="line">        <span class="comment">//è·å–å½“å‰ç±»çš„è·¯å¾„ä¿¡æ¯(å¦‚ï¼šç±»çš„è·¯å¾„)</span></span><br><span class="line">        Resource resource = metadataReader.getResource();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ¯”å¦‚è·å–ç±»å</span></span><br><span class="line">        String className = classMetadata.getClassName();</span><br><span class="line">        System.out.println(<span class="string">&quot;----&gt;&quot;</span> +className);</span><br><span class="line">        <span class="keyword">if</span> (className.contains(<span class="string">&quot;er&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="includeFilters"><a href="#includeFilters" class="headerlink" title="includeFilters"></a>includeFilters</h3><p>includeFiltersçš„ä½¿ç”¨æ–¹æ³•å’ŒexcludeFiltersç›¸ä¼¼,æŒ‡å®šæ‰«ææ—¶æŒ‰ç…§ä»€ä¹ˆè§„åˆ™åŠ è½½ç»„ä»¶ã€‚åªä¸è¿‡è¦å°†<code>useDefaultFilters</code>è®¾ç½®ä¸º<code>false</code>(é»˜è®¤ä¸ºtrue)ã€‚è¿™å’Œç”¨é…ç½®æ–‡ä»¶é…ç½®ä¹Ÿç›¸ä¼¼,åœ¨xmlä¸­è®¾ç½®use-default-filtersä¸ºfalse:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.study&quot;</span> <span class="attr">use-default-filters</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>includeFiltersçš„è®¾ç½®æ–¹æ³•å¦‚ä¸‹,</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScan(</span></span><br><span class="line"><span class="meta">                value = &quot;com.study&quot;,</span></span><br><span class="line"><span class="meta">//                excludeFilters = &#123;</span></span><br><span class="line"><span class="meta">//                    @ComponentScan.Filter(type = FilterType.ANNOTATION , value = &#123;Service.class&#125;)</span></span><br><span class="line"><span class="meta">//                &#125;,</span></span><br><span class="line"><span class="meta">                includeFilters = &#123;</span></span><br><span class="line"><span class="meta">//                        @ComponentScan.Filter(type = FilterType.ANNOTATION,classes = &#123;Controller.class&#125;),</span></span><br><span class="line"><span class="meta">//                        @ComponentScan.Filter(type = FilterType.ASSIGNABLE_TYPE,classes = &#123;BookService.class&#125;,</span></span><br><span class="line"><span class="meta">                        @ComponentScan.Filter(type = FilterType.CUSTOM,classes = &#123;MyTypeFilter.class&#125;)</span></span><br><span class="line"><span class="meta">                &#125;,</span></span><br><span class="line"><span class="meta">                useDefaultFilters = false</span></span><br><span class="line"><span class="meta">)</span></span><br></pre></td></tr></table></figure>

<h2 id="ComponentScans"><a href="#ComponentScans" class="headerlink" title="@ComponentScans"></a>@ComponentScans</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> ComponentScans &#123;</span><br><span class="line"></span><br><span class="line">	ComponentScan[] value();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹å…¶æºç å¯ä»¥çŸ¥é“ï¼Œå®ƒçš„valueæ˜¯ä¸€ä¸ªComponentScanæ•°ç»„ï¼Œå³æˆ‘ä»¬å¯ä»¥é…ç½®å¤šä¸ªComponentScanã€‚</p>
<p>å®ƒçš„å†™æ³•å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ComponentScans(value = &#123;</span></span><br><span class="line"><span class="meta">        @ComponentScan(</span></span><br><span class="line"><span class="meta">                value = &quot;com.study&quot;,</span></span><br><span class="line"><span class="meta">               excludeFilters = &#123;</span></span><br><span class="line"><span class="meta">                   @ComponentScan.Filter(type = FilterType.ANNOTATION , value = &#123;Service.class&#125;)</span></span><br><span class="line"><span class="meta">               &#125;,</span></span><br><span class="line"><span class="meta">        ),</span></span><br><span class="line"><span class="meta">        @ComponentScan(</span></span><br><span class="line"><span class="meta">                value = &quot;com.study&quot;,</span></span><br><span class="line"><span class="meta">                includeFilters = &#123;</span></span><br><span class="line"><span class="meta">                        @ComponentScan.Filter(type = FilterType.CUSTOM,classes = &#123;MyTypeFilter.class&#125;)</span></span><br><span class="line"><span class="meta">                &#125;,</span></span><br><span class="line"><span class="meta">                useDefaultFilters = false</span></span><br><span class="line"><span class="meta">        )</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br></pre></td></tr></table></figure>

<h2 id="Scope"><a href="#Scope" class="headerlink" title="@Scope"></a>@Scope</h2><p>@Scopeæ³¨è§£å’Œåœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®scopeå±æ€§ç±»ä¼¼ï¼Œå³è®¾ç½®æ˜¯å•å®ä¾‹è¿˜æ˜¯å¤šå®ä¾‹ã€‚</p>
<p>å¯å–å€¼:</p>
<ul>
<li>ConfigurableBeanFactory#SCOPE_PROTOTYPE    prototype â€”- å¤šå®ä¾‹çš„  å¤šå®ä¾‹æƒ…å†µä¸‹ï¼Œiocå®¹å™¨å¯åŠ¨æ—¶ä¸ä¼šè°ƒç”¨æ–¹æ³•å»åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯åœ¨è·å–æ—¶æ‰ä¼šè°ƒç”¨æ–¹æ³•åˆ›å»ºå¯¹è±¡</li>
<li>ConfigurableBeanFactory#SCOPE_SINGLETON    singleton â€”- å•å®ä¾‹çš„  å•å®ä¾‹æƒ…å†µä¸‹ï¼Œiocå®¹å™¨å¯åŠ¨æ—¶å³è°ƒç”¨æ–¹æ³•åˆ›å»ºå¯¹è±¡æ”¾åˆ°å®¹å™¨ä¸­ï¼Œä»¥åè·å–å°±ä»Iocå®¹å™¨ä¸­æ‹¿å°±å¯ä»¥äº†</li>
<li>org.springframework.web.context.WebApplicationContext#SCOPE_REQUEST    request â€”- åŒä¸€ä¸ªè¯·æ±‚åˆ›å»ºä¸€ä¸ªå®ä¾‹</li>
<li>org.springframework.web.context.WebApplicationContext#SCOPE_SESSION    session â€”- åŒä¸€ä¸ªsessionåˆ›å»ºä¸€ä¸ªå®ä¾‹</li>
</ul>
<p>æœ€åä¸¤ä¸ªå¹¶ä¸å¸¸ç”¨ï¼Œæ‰€ä»¥äº†è§£å³å¯ã€‚</p>
<p>ä½¿ç”¨æ–¹æ³•ï¼Œå¦‚åœ¨è¦æ³¨å…¥çš„ç±»ä¸Šé¢å†™ä¸Šå¯¹åº”çš„å€¼å³å¯:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean(&quot;person02&quot;)</span></span><br><span class="line"><span class="meta">@Scope(&quot;prototype&quot;)</span> <span class="comment">//å¤šå®ä¾‹çš„</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> Person <span class="title">person</span><span class="params">()</span></span>&#123;</span><br><span class="line">     System.out.println(<span class="string">&quot;åˆ›å»ºäº†person02 Bean&quot;</span>);</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">new</span> Person(<span class="string">&quot;æå››&quot;</span>,<span class="number">22</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Lazy"><a href="#Lazy" class="headerlink" title="@Lazy"></a>@Lazy</h2><p>æ‡’åŠ è½½ï¼Œä¸€èˆ¬å¯¹@Scope(â€œsingletonâ€) çš„ç»„ä»¶ä½¿ç”¨ã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½¿ç”¨@Scope(â€œsingletonâ€)æ ‡æ³¨çš„ç»„ä»¶ï¼Œåœ¨å®¹å™¨åŠ è½½å‰å°±å·²ç»åˆ›å»ºå¥½äº†å®ä¾‹ï¼Œä½†æ˜¯ä½¿ç”¨@Lazyæ³¨è§£æ ‡æ³¨çš„è¯ï¼Œåœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨è¯¥ç»„ä»¶æ—¶æ‰åˆ›å»ºç»„ä»¶åˆ°IOCå®¹å™¨ä¸­ã€‚</p>
<h2 id="Conditional"><a href="#Conditional" class="headerlink" title="@Conditional"></a>@Conditional</h2><p>@Conditional - æŒ‰ç…§æ¡ä»¶æ³¨å†Œbeanï¼Œsince 4.0 ï¼Œ4.0ç‰ˆæœ¬æ‰å¼•å…¥çš„è¿™ä¸ªæ³¨è§£</p>
<p>ä»å…¶æºç </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE, ElementType.METHOD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Conditional &#123;</span><br><span class="line">	Class&lt;? extends Condition&gt;[] value();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºï¼Œå®ƒå¯ä»¥æ ‡æ³¨åœ¨ç±»ä¸Šé¢ï¼Œä¹Ÿå¯ä»¥æ ‡æ³¨åœ¨æ–¹æ³•ä¸Šé¢.å¹¶ä¸”å…¶å‚æ•°æ˜¯å®ç°Conditionæ¥å£çš„æ•°ç»„ï¼ŒConditionæ¥å£æœ‰ä¸ªmatchesæ–¹æ³•ï¼Œå¦‚æœåŒ¹é…äº†è§„åˆ™åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</p>
<p>å³@Conditional({Condition})</p>
<p>ä¾‹,ä½¿ç”¨è§„åˆ™ï¼Œå¦‚æœæ˜¯windowsç³»ç»Ÿï¼Œç»™å®¹å™¨æ³¨å†Œ(â€œbillâ€),å¦‚æœæ˜¯linuxç³»ç»Ÿï¼Œç»™å®¹å™¨æ³¨å†Œ(â€œlinusâ€):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean(name = &quot;bill&quot;)</span></span><br><span class="line"><span class="meta">@Conditional(&#123;WindowsCondition.class&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Person <span class="title">person03</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Person(<span class="string">&quot;Bill Gates&quot;</span>,<span class="number">60</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean(name = &quot;linus&quot;)</span></span><br><span class="line"><span class="meta">@Conditional(&#123;LinuxCondition.class&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Person <span class="title">person04</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Person(<span class="string">&quot;Linus&quot;</span>,<span class="number">48</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.study.condition;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.config.ConfigurableListableBeanFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.support.BeanDefinitionRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Condition;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ConditionContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.env.Environment;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.type.AnnotatedTypeMetadata;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­æ˜¯å¦æ˜¯linuxç³»ç»Ÿ</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinuxCondition</span> <span class="keyword">implements</span> <span class="title">Condition</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context åˆ¤æ–­æ¡ä»¶èƒ½ä½¿ç”¨çš„ä¸Šä¸‹æ–‡ç¯å¢ƒ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> metadata æ ‡æ³¨äº†Conditionæ³¨è§£çš„æ³¨é‡Šä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">matches</span><span class="params">(ConditionContext context, AnnotatedTypeMetadata metadata)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1.è·å–åˆ°iocå½“å‰ä½¿ç”¨çš„beanfactory</span></span><br><span class="line">        ConfigurableListableBeanFactory beanFactory = context.getBeanFactory();</span><br><span class="line">        <span class="comment">//2.è·å–åˆ°ç±»åŠ è½½å™¨</span></span><br><span class="line">        ClassLoader classLoader = context.getClassLoader();</span><br><span class="line">        <span class="comment">//3.è·å–è¿è¡Œç¯å¢ƒä¿¡æ¯</span></span><br><span class="line">        Environment environment = context.getEnvironment();</span><br><span class="line">        <span class="comment">//4.è·å–åˆ°beanå®šä¹‰çš„æ³¨å†Œç±»,ä»å…¶æºç å¯ä»¥çœ‹å‡ºï¼Œå®ƒå¯ä»¥æ³¨å†Œä¸€ä¸ªbeançš„å®šä¹‰ï¼Œä¹Ÿèƒ½ç§»é™¤ä¸€ä¸ªbeançš„å®šä¹‰ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹æ˜¯å¦å«æœ‰ä¸€ä¸ªbeanï¼Œä¹Ÿèƒ½æŸ¥è¯¢bean</span></span><br><span class="line">        <span class="comment">//æ‰€ä»¥å¯ä»¥æ ¹æ®å®¹å™¨ä¸­beançš„æ³¨å†Œæƒ…å†µï¼Œç»™å®¹å™¨ä¸­æ³¨å†Œã€åˆ é™¤ç»„ä»¶ç­‰</span></span><br><span class="line">        BeanDefinitionRegistry registry = context.getRegistry();</span><br><span class="line"></span><br><span class="line">        String osName = environment.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(osName.contains(<span class="string">&quot;linux&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>â€¦çœç•¥WindowsCondition.java</p>
<h2 id="Import"><a href="#Import" class="headerlink" title="@Import"></a>@Import</h2><p>ç»™å®¹å™¨å¿«é€Ÿå¯¼å…¥ä¸€ä¸ªç»„ä»¶</p>
<p>å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Import(&#123;Color.class, Red.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainConfig2</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@importçš„æºç :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Import &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * &#123;<span class="doctag">@link</span> Configuration&#125;, &#123;<span class="doctag">@link</span> ImportSelector&#125;, &#123;<span class="doctag">@link</span> ImportBeanDefinitionRegistrar&#125;</span></span><br><span class="line"><span class="comment">	 * or regular component classes to import.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	Class&lt;?&gt;[] value();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯çœ‹å‡ºï¼Œå®ƒé™¤äº†å¯ä»¥ä¼ å…¥è¦å¯¼å…¥çš„Classä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥å®ç°äº† ImportSelectorå’ŒImportBeanDefinitionRegistraræ¥å£çš„ç±»ã€‚</p>
<h3 id="ImportSelector"><a href="#ImportSelector" class="headerlink" title="ImportSelector"></a>ImportSelector</h3><p>è‡ªå®šä¹‰é€»è¾‘ï¼Œè¿”å›éœ€è¦å¯¼å…¥çš„ç»„ä»¶ã€‚<br>ä»å…¶æºç å¯ä»¥çœ‹å‡ºï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªStringæ•°ç»„ï¼Œè¿™æ˜¯å®šä¹‰äº†è¦å¯¼å…¥çš„ç»„ä»¶çš„å…¨ç±»åçš„Stringæ•°ç»„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ImportSelector</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Select and return the names of which class(es) should be imported based on</span></span><br><span class="line"><span class="comment">	 * the &#123;<span class="doctag">@link</span> AnnotationMetadata&#125; of the importing @&#123;<span class="doctag">@link</span> Configuration&#125; class.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	String[] selectImports(AnnotationMetadata importingClassMetadata);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚ï¼Œä¸‹é¢å°†å¯¼å…¥å¯¹åº”åŒ…ä¸‹çš„Blueç±»å’ŒYellowç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.study.condition;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ImportSelector;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.type.AnnotationMetadata;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªå®šä¹‰é€»è¾‘ï¼Œè¿”å›éœ€è¦å¯¼å…¥çš„ç»„ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyImportSelector</span> <span class="keyword">implements</span> <span class="title">ImportSelector</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿”å›å€¼å°±æ˜¯è¦å¯¼å…¥åˆ°å®¹å™¨ä¸­çš„ç»„ä»¶å…¨ç±»å</span></span><br><span class="line">    <span class="comment">//AnnotationMetadata: å½“å‰æ ‡æ³¨@import æ³¨è§£çš„ç±»çš„æ‰€æœ‰æ³¨è§£ä¿¡æ¯(å³é™¤äº†@import å¯ä»¥è·å–è¿™ä¸ªè¢«æ ‡æ³¨çš„ç±»çš„å…¶ä»–çš„æ³¨è§£)</span></span><br><span class="line">    <span class="keyword">public</span> String[] selectImports(AnnotationMetadata importingClassMetadata) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿”å›è¦æ³¨å†Œçš„ç»„ä»¶çš„å…¨ç±»åæ•°ç»„</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> String[]&#123;<span class="string">&quot;com.study.bean.Blue&quot;</span>,<span class="string">&quot;com.study.bean.Yellow&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ImportBeanDefinitionRegistrar"><a href="#ImportBeanDefinitionRegistrar" class="headerlink" title="ImportBeanDefinitionRegistrar"></a>ImportBeanDefinitionRegistrar</h3><p>è¿™æ˜¯å®˜æ–¹çš„è§£é‡Š:</p>
<blockquote>
<p>Register bean definitions as necessary based on the given annotation metadata of the importing {@code @Configuration} class.</p>
</blockquote>
<p>ä½¿ç”¨ImportBeanDefinitionRegistraræ¥å£å®ç°çš„ç±»,å¯ä»¥è‡ªç”±å‘æŒ¥ï¼ŒåŠ¨æ€çš„ç”Ÿæˆä¸€äº›Beanã€‚</p>
<p>ä¾‹å¦‚,åŠ¨æ€æ·»åŠ ä¸€ä¸ªRainBowç»„ä»¶:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyImportBeanDefinitionRegistrar</span> <span class="keyword">implements</span> <span class="title">ImportBeanDefinitionRegistrar</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> importingClassMetadata å½“å‰ç±»çš„æ³¨è§£ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> registry BeanDefinitionæ³¨å†Œç±»ï¼Œå¯ä»¥æŠŠæ‰€æœ‰éœ€è¦æ·»åŠ åˆ°å®¹å™¨ä¸­çš„ç±»ï¼Œè°ƒç”¨BeanDefinitionRegistry.registerBeanDefinition æ–¹æ³•æ‰‹åŠ¨æ³¨å†Œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerBeanDefinitions</span><span class="params">(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//çœ‹å®¹å™¨ä¸­æ˜¯å¦å·²æœ‰è“è‰²å’Œçº¢è‰²ç»„ä»¶</span></span><br><span class="line">        <span class="keyword">boolean</span> blue = registry.containsBeanDefinition(<span class="string">&quot;com.study.bean.Blue&quot;</span>);</span><br><span class="line">        <span class="keyword">boolean</span> red = registry.containsBeanDefinition(<span class="string">&quot;com.study.bean.Red&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(blue &amp;&amp; red)&#123;</span><br><span class="line">            <span class="comment">//ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šbeançš„åå­—</span></span><br><span class="line">            <span class="comment">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯BeanDefinitionæ¥å£ï¼Œä½¿ç”¨ RootBeanDefinition å®ç°,å³æŒ‡å®šbeançš„å®šä¹‰ä¿¡æ¯(å“ªä¸ªç±»ï¼Œscopeç­‰ã€‚ã€‚ã€‚ã€‚)</span></span><br><span class="line">            RootBeanDefinition rainBowRootBeanDefinition = <span class="keyword">new</span> RootBeanDefinition(RainBow.class);</span><br><span class="line">            registry.registerBeanDefinition(<span class="string">&quot;rainBow&quot;</span>,rainBowRootBeanDefinition);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶å°èŠ‚"><a href="#ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶å°èŠ‚" class="headerlink" title="ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶å°èŠ‚"></a>ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶å°èŠ‚</h2><p>ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶ï¼š</p>
<ul>
<li>1.åŒ…æ‰«æ+ç»„ä»¶æ ‡æ³¨æ³¨è§£(@Controller/@Service/@Repository/@Component) [æœ‰å±€é™æ€§ï¼Œè‡ªå·±å†™çš„ç±»å¾ˆæ–¹ä¾¿å¼•å…¥ï¼Œä½†æ˜¯ç¬¬ä¸‰æ–¹åŒ…ä¸æ–¹ä¾¿å¼•å…¥]</li>
<li><ol start="2">
<li>@Bean[ å¯¼å…¥ç¬¬ä¸‰æ–¹åŒ…é‡Œé¢çš„ç»„ä»¶,ä½¿ç”¨æ— å‚æ„é€ å™¨åˆ›å»ºä¸€ä¸ªç»„ä»¶]</li>
</ol>
</li>
<li><ol start="3">
<li>@Import [å¿«é€Ÿç»™å®¹å™¨ä¸­æ³¨å†Œä¸€ä¸ªç»„ä»¶]</li>
</ol>
<ul>
<li><ol>
<li>@Import è¦å¯¼å…¥åˆ°å®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œå®¹å™¨ä¸­å°±ä¼šè‡ªåŠ¨æ³¨å†Œè¿™ä¸ªç»„ä»¶ï¼ŒIdé»˜è®¤æ˜¯å…¨ç±»å</li>
</ol>
</li>
<li>2ï¼‰ImportSelector:æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¿”å›selectImportsçš„String[]æ•°ç»„,è¿™ä¸ªæ•°ç»„å³ä¸ºè¦å¯¼å…¥çš„ç±»çš„å…¨ç±»åæ•°ç»„{@link com.study.condition.MyImportSelector}</li>
<li><ol start="3">
<li>ImportBeanDefinitionRegistrar: ä¹Ÿæ˜¯ä¸€ä¸ªæ¥å£ï¼Œæœ‰ä¸ªæ–¹æ³•registerBeanDefinitions</li>
</ol>
</li>
</ul>
</li>
<li><ol start="4">
<li>ä½¿ç”¨Springæä¾›çš„FactoryBean(å·¥å‚Bean),ä¸€èˆ¬çš„Beanï¼Œå®¹å™¨ä¼šè°ƒç”¨ä¸€èˆ¬çš„Beançš„æ— å‚æ„é€ å™¨ï¼Œé»˜è®¤åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚å®ƒæ˜¯ä¸€ä¸ªæ¥å£{@link org.springframework.beans.factory.FactoryBean}</li>
</ol>
</li>
</ul>
<h3 id="ä½¿ç”¨Springæä¾›çš„FactoryBean"><a href="#ä½¿ç”¨Springæä¾›çš„FactoryBean" class="headerlink" title="ä½¿ç”¨Springæä¾›çš„FactoryBean"></a>ä½¿ç”¨Springæä¾›çš„FactoryBean</h3><p>è¿™é‡Œè¡¥å……ä¸€ä¸‹ä¸Šé¢æåˆ°çš„ä½¿ç”¨Springæä¾›çš„FactoryBean(å·¥å‚Bean)</p>
<p>è®©è¦æ·»åŠ åˆ°å®¹å™¨ä¸­çš„ç±»å®ç°FactoryBean<T> æ¥å£ã€‚</p>
<p>å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ColorFactoryBean</span> <span class="keyword">implements</span> <span class="title">FactoryBean</span>&lt;<span class="title">Color</span>&gt; </span>&#123;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Color <span class="title">getObject</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Color();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; getObjectType() &#123;</span><br><span class="line">        <span class="keyword">return</span> Color.class;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯ä»¥è®¾ç½®æ˜¯å¦æ˜¯å•å®ä¾‹</span></span><br><span class="line">    <span class="comment">//trueä¸ºå•å®ä¾‹ falseä¸ºå¤šå®ä¾‹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isSingleton</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ—¶,ç›´æ¥è¿”å›è¿™ä¸ªç±»çš„å¯¹è±¡:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> ColorFactoryBean <span class="title">colorFactoryBean</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> ColorFactoryBean();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ³¨æ„:è™½ç„¶ä¸‹é¢çš„ colorFactoryBean æ³¨å†Œåˆ°äº†å®¹å™¨ä¸­ï¼Œä½†æ˜¯å¯¹å®ƒè¿›è¡Œè·å–ï¼Œå¾—åˆ°çš„æ˜¯Colorå®ä¾‹ï¼Œå³è·å–çš„æ˜¯è°ƒç”¨getObjectåˆ›å»ºçš„å¯¹è±¡ï¼Œ</li>
<li>è‹¥å°±æ˜¯è¦è·å–å·¥å‚Beanæœ¬èº«çš„è¯,è¦åœ¨idå‰é¢åŠ ä¸€ä¸ª&amp;æ ‡è¯†ï¼Œå¦‚ä¸‹é¢çš„:getBean(â€œ&amp;colorFactoryBeanâ€) æºç :{@link org.springframework.beans.factory.BeanFactory}</li>
</ul>
<h1 id="Beanç”Ÿå‘½å‘¨æœŸ"><a href="#Beanç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Beanç”Ÿå‘½å‘¨æœŸ"></a>Beanç”Ÿå‘½å‘¨æœŸ</h1><p>beançš„ç”Ÿå‘½å‘¨æœŸæ˜¯æŒ‡beanåˆ›å»ºâ€”åˆå§‹åŒ–â€”é”€æ¯çš„è¿‡ç¨‹</p>
<p>ä¸€èˆ¬éƒ½éµå¾ªä¸‹é¢çš„æµç¨‹ï¼š</p>
<p> æ„é€ (å¯¹è±¡åˆ›å»º)<br>     å•å®ä¾‹:åœ¨å®¹å™¨å¯åŠ¨æ—¶åˆ›å»ºå¯¹è±¡<br>     å¤šå®ä¾‹:åœ¨æ¯æ¬¡è·å–çš„æ—¶å€™åˆ›å»ºå¯¹è±¡</p>
<p> åˆå§‹åŒ–ä¹‹å‰è°ƒç”¨BeanPostProcessor.postProcessBeforeInitialization()<br> åˆå§‹åŒ–ï¼š<br>     å¯¹è±¡åˆ›å»ºå®Œæˆå¹¶èµ‹å€¼å¥½åï¼Œè°ƒç”¨åˆå§‹åŒ–æ–¹æ³•<br> åˆå§‹åŒ–ä¹‹åè°ƒç”¨BeanPostProcessor.postProcessAfterInitialization()</p>
<p> é”€æ¯ï¼š<br>     å•å®ä¾‹ï¼šbeanå®¹å™¨å…³é—­çš„æ—¶å€™é”€æ¯<br>     å¤šå®ä¾‹ï¼šå®¹å™¨ä¸å…³é—­æ—¶ä¸é”€æ¯</p>
<h2 id="ä½¿ç”¨Beanå®šä¹‰åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•"><a href="#ä½¿ç”¨Beanå®šä¹‰åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•" class="headerlink" title="ä½¿ç”¨Beanå®šä¹‰åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•"></a>ä½¿ç”¨Beanå®šä¹‰åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•</h2><p>è®©å®¹å™¨ç®¡ç†beançš„ç”Ÿå‘½å‘¨æœŸï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•,åœ¨beanè¿›è¡Œåˆ°å½“å‰ç”Ÿå‘½å‘¨æœŸçš„æ—¶å€™,å®¹å™¨è°ƒç”¨å¯¹åº”æ–¹æ³•ã€‚</p>
<p>1).ä½¿ç”¨ä»¥å‰çš„xmlé…ç½®: init-method=â€â€   destory-method=â€â€</p>
<p>2).çœ‹@Beançš„æºç ,å«æœ‰ä¸¤ä¸ªå€¼initMethod å’ŒdestoryMethond.ç”¨å®ƒä»¬æ¥åˆ¶å®šå¯¹åº”çš„initå’Œdestoryæ–¹æ³•<br>å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean(initMethod = &quot;init&quot;,destroyMethod = &quot;destory&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Car <span class="title">car</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Car();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Car</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Car...Constructor&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Car...init...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destory</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Car...destory...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å®ç°æ¥å£InitializingBean-DisposableBean"><a href="#å®ç°æ¥å£InitializingBean-DisposableBean" class="headerlink" title="å®ç°æ¥å£InitializingBean/DisposableBean"></a>å®ç°æ¥å£InitializingBean/DisposableBean</h2><p>è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯è®©è¦æ³¨å†Œçš„beanå®ç°æ¥å£:</p>
<ul>
<li><p>{@link org.springframework.beans.factory.InitializingBean} å®ƒçš„afterPropertiesSet()æ–¹æ³•å®šä¹‰åˆå§‹åŒ–é€»è¾‘ï¼ˆåœ¨å…¶beançš„å±æ€§éƒ½èµ‹å€¼å®Œæˆåï¼‰</p>
</li>
<li><p>{@link org.springframework.beans.factory.DisposableBean}  å®ƒçš„destroy()æ–¹æ³•å®šä¹‰é”€æ¯é€»è¾‘</p>
</li>
</ul>
<p>å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Cat</span> <span class="keyword">implements</span> <span class="title">InitializingBean</span>, <span class="title">DisposableBean</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Cat</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Cat ... constructor...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Cat  .... destory...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;cat ...afterPropertiesSet...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨JSR250è§„èŒƒä¸­å®šä¹‰çš„ä¸¤ä¸ªæ³¨è§£-PostConstruct-PreDestroy"><a href="#ä½¿ç”¨JSR250è§„èŒƒä¸­å®šä¹‰çš„ä¸¤ä¸ªæ³¨è§£-PostConstruct-PreDestroy" class="headerlink" title="ä½¿ç”¨JSR250è§„èŒƒä¸­å®šä¹‰çš„ä¸¤ä¸ªæ³¨è§£ @PostConstruct/@PreDestroy"></a>ä½¿ç”¨JSR250è§„èŒƒä¸­å®šä¹‰çš„ä¸¤ä¸ªæ³¨è§£ @PostConstruct/@PreDestroy</h2><p>ä»å­—é¢æ„æ€å°±å¾ˆå¥½ç†è§£è¿™ä¸¤ä¸ªæ³¨è§£çš„æ„æ€ã€‚</p>
<ul>
<li><p> @PostConstruct : åœ¨beanåˆ›å»ºå®Œæˆå¹¶ä¸”å±æ€§èµ‹å€¼å®Œæˆåæ‰§è¡Œä¸€äº›åˆå§‹åŒ–æ–¹æ³•.(@Target(METHOD)æ ‡æ³¨åœ¨æ–¹æ³•ä¸Šï¼‰</p>
</li>
<li><p> @PreDestroy : åœ¨beanè¢«ç§»é™¤ä¹‹å‰è¿›è¡Œå›è°ƒé€šçŸ¥.ï¼ˆ@Target(METHOD)æ ‡æ³¨åœ¨æ–¹æ³•ä¸Šï¼‰</p>
</li>
</ul>
<p>ä»è¿™ä¸¤ä¸ªçš„æºç å¯ä»¥çœ‹å‡º,ä»–ä»¬æ˜¯æ ‡æ³¨åœ¨æ–¹æ³•ä¸Šçš„æ³¨è§£:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention</span> (RUNTIME)</span><br><span class="line"><span class="meta">@Target(METHOD)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> PostConstruct &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Dog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dog....constructor...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹è±¡åˆ›å»ºå®Œæˆåè°ƒç”¨</span></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dog....@PostConstruct...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®¹å™¨ç§»é™¤å¯¹è±¡ä¹‹å‰</span></span><br><span class="line">    <span class="meta">@PreDestroy</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destory</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;dog....@PreDestroy...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BeanPostProcessor"><a href="#BeanPostProcessor" class="headerlink" title="BeanPostProcessor"></a>BeanPostProcessor</h2><p>çœ‹å®˜æ–¹æ³¨é‡Šçš„è§£é‡Š:</p>
<blockquote>
<p>Apply this BeanPostProcessor to the given new bean instance <i>before</i> any bean initialization callbacks (like InitializingBeanâ€™s {@code afterPropertiesSet} or a custom init-method). The bean will already be populated with property values.</p>
</blockquote>
<p>BeanPostProcessor æ¥å£å®šä¹‰äº†ä¸€ä¸ªä½ å¯ä»¥è‡ªå·±å®ç°çš„å›è°ƒæ–¹æ³•ï¼Œæ¥å®ç°ä½ è‡ªå·±çš„å®ä¾‹åŒ–é€»è¾‘ã€ä¾èµ–è§£å†³é€»è¾‘ç­‰ï¼Œå¦‚æœä½ æƒ³è¦åœ¨Springå®Œæˆå¯¹è±¡å®ä¾‹åŒ–ã€é…ç½®ã€åˆå§‹åŒ–ä¹‹åå®ç°è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ï¼Œä½ å¯ä»¥è¡¥å……å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªBeanPostProcessorçš„å®ç°ã€‚</p>
<p>å³åœ¨beanåˆå§‹åŒ–å‰åè¿›è¡Œä¸€äº›å¤„ç†å·¥ä½œ ã€‚å®ƒæ˜¯ä¸€ä¸ªæ¥å£ã€‚<br>å…¶ä¸­æœ‰ä¸¤ä¸ªè¦å®ç°çš„æ–¹æ³•:</p>
<ul>
<li>postProcessBeforeInitialization() : åˆå§‹åŒ–ä¹‹å‰è¿›è¡Œä¸€äº›åç½®å¤„ç†å·¥ä½œ (è¯¦æƒ…è§æºç ä»‹ç»</li>
<li> postProcessAfterInitialization()  : åˆå§‹åŒ–ä¹‹åè¿›è¡Œä¸€äº›åç½®å¤„ç†å·¥ä½œ (è¯¦æƒ…è§æºç ä»‹ç»</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ³¨é‡ŠpostProcessBeforeInitializationæ–¹æ³•æ˜¯åœ¨æ‰€æœ‰çš„beançš„InitializingBeançš„afterPropertiesSetæ–¹æ³•ä¹‹å‰æ‰§è¡Œè€ŒpostProcessAfterInitializationæ–¹æ³•åˆ™æ˜¯åœ¨æ‰€æœ‰çš„beançš„InitializingBeançš„afterPropertiesSetæ–¹æ³•ä¹‹åæ‰§è¡Œçš„ã€‚â€”â€”<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/fb39f568cd5e">æ‘˜è‡ª</a></p>
<p>å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åç½®å¤„ç†å™¨ï¼šåˆå§‹åŒ–å‰åè¿›è¡Œå¤„ç†å·¥ä½œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title">BeanPostProcessor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyBeanPostProcessor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;MyBeanPostProcessor...constructor&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;postProcessBeforeInitialization:&quot;</span> + beanName + <span class="string">&quot; ---&gt; &quot;</span> + bean);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;postProcessAfterInitialization:&quot;</span> + beanName + <span class="string">&quot; ---&gt; &quot;</span> + bean);</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BeanPostProcessoråœ¨Springåº•å±‚è¿˜æœ‰å¾ˆå¤šåº”ç”¨ï¼Œè¦å¤šåŠ å­¦ä¹ ã€‚</p>
<h1 id="å±æ€§èµ‹å€¼"><a href="#å±æ€§èµ‹å€¼" class="headerlink" title="å±æ€§èµ‹å€¼"></a>å±æ€§èµ‹å€¼</h1><h2 id="Valueèµ‹å€¼"><a href="#Valueèµ‹å€¼" class="headerlink" title="@Valueèµ‹å€¼"></a>@Valueèµ‹å€¼</h2><p>åœ¨è¦æ³¨å…¥çš„å±æ€§åŸŸä¸Šé¢ç”¨@Value().</p>
<ul>
<li>1.åŸºæœ¬æ•°å€¼</li>
<li>2.å¯ä»¥å†™SpEL:#{}</li>
<li>3.å–å‡ºé…ç½®æ–‡ä»¶(propertiesæ–‡ä»¶)ä¸­çš„å€¼ï¼ˆåœ¨è¿è¡Œçš„ç¯å¢ƒå˜é‡ä¸­çš„å€¼ï¼‰: ${}</li>
</ul>
<p>3çš„ä½¿ç”¨è§ä¸‹ä¸€å°èŠ‚</p>
<p>å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;å¼ ä¸‰&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Value(&quot;#&#123;20-2&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;person.nickName&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String nickName;</span><br><span class="line"></span><br><span class="line">    getters/setters..</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="PropertySourceåŠ è½½å¤–éƒ¨é…ç½®æ–‡ä»¶"><a href="#PropertySourceåŠ è½½å¤–éƒ¨é…ç½®æ–‡ä»¶" class="headerlink" title="@PropertySourceåŠ è½½å¤–éƒ¨é…ç½®æ–‡ä»¶"></a>@PropertySourceåŠ è½½å¤–éƒ¨é…ç½®æ–‡ä»¶</h2><p>ä½¿ç”¨@PropertySourceè¯»å–å¤–éƒ¨é…ç½®æ–‡ä»¶ä¸­çš„k/v ä¿å­˜åˆ°è¿è¡Œçš„ç¯å¢ƒå˜é‡ä¸­,ä½¿ç”¨${}å–å‡ºé…ç½®æ–‡ä»¶ä¸­çš„å€¼ã€‚é…ç½®æ–‡ä»¶çš„å€¼å¯ä»¥åœ¨ä¸Šä¸‹æ–‡ç¯å¢ƒè·å–åˆ°</p>
<p>PropertySourceçš„æœ‰ @Repeatable(PropertySources.class)æ ‡æ³¨, å¯ä»¥æ ‡æ³¨<br>å¤šä¸ªPropertySource.å¯ä»¥ä½¿ç”¨PropertySources ä¼ å…¥å¤šä¸ªPropertySource</p>
<p>å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span> <span class="comment">//è¡¨åæ˜¯é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="meta">@PropertySource(value = &#123;&quot;classpath:person.properties&quot;&#125;,encoding = &quot;UTF-8&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainConfigOfPropertyValue</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">person</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Person();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è§ä¸Šä¸€å°èŠ‚ï¼Œåœ¨Personä¸­å°±å¯ä»¥ç”¨@Valueå–å‡ºé…ç½®æ–‡ä»¶ä¸­çš„å€¼äº†</p>
<h2 id="è‡ªåŠ¨è£…é…-Autowried-amp-Qualifier-amp-Primary"><a href="#è‡ªåŠ¨è£…é…-Autowried-amp-Qualifier-amp-Primary" class="headerlink" title="è‡ªåŠ¨è£…é…:@Autowried&amp;@Qualifier&amp;@Primary"></a>è‡ªåŠ¨è£…é…:@Autowried&amp;@Qualifier&amp;@Primary</h2><p>è‡ªåŠ¨è£…é…ï¼š Springä½¿ç”¨ä¾èµ–æ³¨å…¥(DI),å®Œæˆå¯¹IOCå®¹å™¨ä¸­å„ä¸ªç»„ä»¶çš„ä¾èµ–å…³ç³»èµ‹å€¼</p>
<ul>
<li>1.) @Autowired<ul>
<li>1.å½“ä¸€ä¸ªç±»ä¸­éœ€è¦å¦ä¸€ä¸ªç»„ä»¶æ—¶ï¼Œæ ‡æ³¨äº†@Autowriedï¼Œé»˜è®¤ä¼˜å…ˆæŒ‰ç…§ç±»å‹å»å®¹å™¨ä¸­æ‰¾å¯¹åº”çš„ç»„ä»¶,ç±»ä¼¼äºapplicationContext.getBean(Bean.class);</li>
<li>2.å¦‚æœæŒ‰ç…§ç±»å‹æ‰¾åˆ°å¤šä¸ªç›¸åŒç±»å‹çš„ç»„ä»¶ï¼Œå†å°†å±æ€§çš„åç§°ä½œä¸ºç»„ä»¶çš„idå»å®¹å™¨ä¸­æŸ¥æ‰¾</li>
</ul>
</li>
<li>2.) @Qualifier<ul>
<li>ä½¿ç”¨@Qualifier(â€œâ€) æŒ‡å®šè¦è£…é…çš„ç»„ä»¶çš„idï¼Œè€Œä¸æ˜¯ä½¿ç”¨å±æ€§å</li>
</ul>
</li>
<li>3.) @Primary<ul>
<li>æ²¡æœ‰æ˜ç¡®æŒ‡å®šçš„æƒ…å†µä¸‹,è®©å®¹å™¨è‡ªåŠ¨è£…é…æ—¶é»˜è®¤ä½¿ç”¨é¦–é€‰çš„bean.</li>
</ul>
</li>
<li>4.) ä½¿ç”¨è‡ªåŠ¨è£…é…é»˜è®¤ä¸€å®šè¦å°†å±æ€§èµ‹å€¼å¥½ï¼›æ²¡æœ‰çš„è¯å°±ä¼šæŠ¥é”™ã€‚<ul>
<li>å¯ä»¥ä½¿ç”¨@Autowired(required=false) ä½¿å…¶å˜ä¸ºéå¿…é¡»çš„(å¦‚æœæ²¡æœ‰è¦çš„ç»„ä»¶çš„è¯å°±ä¸º null,è€Œä¸æ˜¯æŠ¥é”™</li>
</ul>
</li>
</ul>
<h2 id="è‡ªåŠ¨è£…é…-Resource-amp-Inject"><a href="#è‡ªåŠ¨è£…é…-Resource-amp-Inject" class="headerlink" title="è‡ªåŠ¨è£…é…:@Resource&amp;@Inject"></a>è‡ªåŠ¨è£…é…:@Resource&amp;@Inject</h2><p>Springè¿˜æ”¯æŒä½¿ç”¨@Resource(JSR250)å’Œ@Inject(JSR330)ã€è¿™ä¸¤ä¸ªæ˜¯javaè§„èŒƒæ³¨è§£ã€‘è¿›è¡Œè‡ªåŠ¨è£…é…</p>
<ul>
<li>@Resource: å¯ä»¥å’Œ@Autowriedä¸€æ ·å®ç°è‡ªåŠ¨è£…é…åŠŸèƒ½ï¼Œé»˜è®¤æŒ‰ç…§å±æ€§åç§°è£…é…ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨nameè®¾ç½®è¦è£…é…çš„ç»„ä»¶çš„Id:@Resource(name=â€â€), æ²¡æœ‰æ”¯æŒ@PrimaryåŠŸèƒ½å’Œ@Autowried(required=false)åŠŸèƒ½</li>
<li>@Inject: ä½¿ç”¨æ—¶éœ€è¦å…ˆå¯¼å…¥ä¾èµ–:{@url <a target="_blank" rel="noopener" href="https://mvnrepository.com/artifact/javax.inject/javax.inject/1%7D">https://mvnrepository.com/artifact/javax.inject/javax.inject/1}</a>  åŠŸèƒ½ä¸@Autowriedä¸€æ ·ï¼Œé»˜è®¤æ”¯æŒPrimaryçš„ç‰¹æ€§,ä½†ä¸æ”¯æŒ@Autowried(required=false)åŠŸèƒ½</li>
</ul>
<h2 id="è‡ªåŠ¨è£…é…-æ–¹æ³•ã€æ„é€ å™¨ä½ç½®çš„è‡ªåŠ¨è£…é…"><a href="#è‡ªåŠ¨è£…é…-æ–¹æ³•ã€æ„é€ å™¨ä½ç½®çš„è‡ªåŠ¨è£…é…" class="headerlink" title="è‡ªåŠ¨è£…é…:æ–¹æ³•ã€æ„é€ å™¨ä½ç½®çš„è‡ªåŠ¨è£…é…"></a>è‡ªåŠ¨è£…é…:æ–¹æ³•ã€æ„é€ å™¨ä½ç½®çš„è‡ªåŠ¨è£…é…</h2><p>@Autuwried èƒ½æ ‡æ³¨çš„ä½ç½®ä¸åªæ˜¯åœ¨ç»„ä»¶ä¸Šé¢ï¼Œè¿˜å¯ä»¥åœ¨æ„é€ å™¨ï¼Œæ–¹æ³•ï¼Œå‚æ•°ï¼Œå±æ€§  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.CONSTRUCTOR, ElementType.METHOD, </span></span><br><span class="line"><span class="meta">ElementType.PARAMETER, ElementType.FIELD, ElementType.ANNOTATION_TYPE&#125;)</span></span><br></pre></td></tr></table></figure>

<p>1.)å¦‚æœ<code>æ ‡æ³¨åœ¨æ–¹æ³•</code>ä¸Šï¼ŒSpringåˆ›å»ºå½“å‰å¯¹è±¡ï¼Œå°±ä¼šè°ƒç”¨æ–¹æ³•ï¼Œå®Œæˆèµ‹å€¼ã€‚å…¶ä¸­ï¼Œæ–¹æ³•ä½¿ç”¨çš„å‚æ•°ï¼Œè‡ªå®šä¹‰ç±»å‹çš„å€¼ä»IOCå®¹å™¨ä¸­è·å–<br>2.)å¦‚æœ<code>æ ‡æ³¨åœ¨æœ‰å‚æ„é€ å™¨</code>ä¸Š,é‚£ä¹ˆSpringåœ¨å¯åŠ¨æ—¶å°±ä¼šè°ƒç”¨æœ‰å‚æ„é€ å™¨ï¼Œå¦‚æœæ„é€ å™¨è¦ç”¨åˆ°ç»„ä»¶ï¼Œé‚£ä¹ˆä¹Ÿä¼šä»å®¹å™¨ä¸­è·å–ã€‚å¦‚æœåªæœ‰ä¸€ä¸ªæœ‰å‚æ„é€ å™¨ï¼Œé‚£ä¹ˆå…¶@Autowriedå¯ä»¥çœç•¥<br>3.)å¦‚æœ<code>æ ‡æ³¨åœ¨æ–¹æ³•ä½ç½®</code>:æ ‡æ³¨çš„æ–¹æ³•åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œæ–¹æ³•å‚æ•°çš„å€¼ä»å®¹å™¨ä¸­è·å–ï¼Œæ‰€ä»¥é»˜è®¤ä¸å†™@Autowriedæ˜¯ä¸€æ ·çš„ï¼Œéƒ½èƒ½è‡ªåŠ¨è£…é…<br>å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainConfigOfAutowired</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Color <span class="title">color</span><span class="params">(<span class="meta">@Autowried</span> Car car)</span></span>&#123; <span class="comment">//æˆ–è€…çœç•¥@Autowried</span></span><br><span class="line">        Color color = <span class="keyword">new</span> Color();</span><br><span class="line">        <span class="keyword">return</span> color;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨:é»˜è®¤åŠ è½½IOCå®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œä¼šå¯åŠ¨è°ƒç”¨æ— å‚æ„é€ å™¨åˆ›å»ºå¯¹è±¡ï¼Œç„¶åå†è¿›è¡Œåˆå§‹åŒ–èµ‹å€¼ç­‰æ“ä½œã€‚</p>
<h2 id="è‡ªåŠ¨è£…é…-Awareæ³¨å…¥Springåº•å±‚ç»„ä»¶"><a href="#è‡ªåŠ¨è£…é…-Awareæ³¨å…¥Springåº•å±‚ç»„ä»¶" class="headerlink" title="è‡ªåŠ¨è£…é…:Awareæ³¨å…¥Springåº•å±‚ç»„ä»¶"></a>è‡ªåŠ¨è£…é…:Awareæ³¨å…¥Springåº•å±‚ç»„ä»¶</h2><p>è‡ªå®šä¹‰ç»„ä»¶æƒ³è¦ä½¿ç”¨Springå®¹å™¨åº•å±‚çš„ä¸€äº›ç»„ä»¶(å¦‚ApplicationContex  BeanFactor xxxç­‰)ï¼Œå³:æŠŠSpringåº•å±‚çš„ä¸€äº›ç»„ä»¶æ³¨å…¥åˆ°è‡ªå®šä¹‰çš„beanä¸­è¿›è¡Œä½¿ç”¨.é‚£ä¹ˆè®©è‡ªå®šä¹‰ç»„ä»¶å®ç° xxxAware æ¥å£.ä»{@link org.springframework.beans.factory.Aware} ä»‹ç»</p>
<blockquote>
<p>Marker superinterface indicating that a bean is eligible to be notified by the Spring container of a particular framework object through a callback-style method.</p>
</blockquote>
<p>å¯ä»¥çœ‹å‡º,å®ƒæä¾›äº†ä¸€äº›å¯ä»¥ä½¿ç”¨Spring å®¹å™¨åº•å±‚å¯¹è±¡çš„åŠŸèƒ½ã€‚ç±»ä¼¼äºå›è°ƒå‡½æ•°çš„é£æ ¼ï¼ŒAwareæ¥å£è§„å®šçš„æ–¹æ³•åœ¨å¯¹è±¡åˆ›å»ºçš„æ—¶å€™å°±ä¼šè¢«è°ƒç”¨ï¼Œæ³¨å…¥ç›¸å…³ç»„ä»¶ã€‚</p>
<p>å¦‚,å®ç°ä¸‰ä¸ªAwareæ¥å£:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Red</span> <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span>, <span class="title">BeanNameAware</span>, <span class="title">EmbeddedValueResolverAware</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;ä¼ å…¥çš„ioc&quot;</span> + applicationContext);</span><br><span class="line">        <span class="keyword">this</span>.applicationContext = applicationContext; <span class="comment">//åœ¨åé¢ä¹Ÿå¯ä»¥ä½¿ç”¨</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBeanName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å½“å‰beançš„åå­—: &quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//èƒ½å¤Ÿè§£æå­—ç¬¦ä¸²çš„å€¼</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmbeddedValueResolver</span><span class="params">(StringValueResolver resolver)</span> </span>&#123;</span><br><span class="line">        String s = resolver.resolveStringValue(<span class="string">&quot;ä½ å¥½ $&#123;os.name&#125; æˆ‘æ˜¯ #&#123;20*18&#125;&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;è§£æçš„å­—ç¬¦ä¸²:&quot;</span> + s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ApplicationContextAwareæ¥å£æ˜¯ç”¨æ¥è·å–applicationContextä¸Šä¸‹æ–‡:</p>
<blockquote>
<p>Interface to be implemented by any object that wishes to be notified of the {@link ApplicationContext} that it runs in.</p>
</blockquote>
<p>BeanNameAwareçš„ä»‹ç»:</p>
<blockquote>
<p>Interface to be implemented by beans that want to be aware of their bean name in a bean factory.</p>
</blockquote>
<p>EmbeddedValueResolverAwareçš„ä»‹ç»:</p>
<blockquote>
<p>Interface to be implemented by any object that wishes to be notified of a <b>StringValueResolver</b> for the <b> resolution of embedded definition values.</p>
</blockquote>
<p>EmbeddedValueResolverAwareçš„æ–¹æ³•ä¸­çš„å‚æ•°StringValueResolverå¯ä»¥è§£æå­—ç¬¦ä¸²ä¸­çš„å€¼,å³å°†<code>#&#123;&#125;</code>æˆ–è€…<code>$&#123;&#125;</code>çš„å€¼è§£æ</p>
<p>xxxAwareçš„åŠŸèƒ½æ˜¯ä½¿ç”¨xxxProcessoræ¥å¤„ç†çš„ï¼Œæ¯ä¸ªéƒ½æœ‰å¯¹åº”çš„xxxProcessor.å¦‚ApplicationContextAware â€”&gt; ApplicationContextAwareProcessor.</p>
<h2 id="è‡ªåŠ¨è£…é…-Profile"><a href="#è‡ªåŠ¨è£…é…-Profile" class="headerlink" title="è‡ªåŠ¨è£…é…:@Profile"></a>è‡ªåŠ¨è£…é…:@Profile</h2><p>@Profileçš„åŠŸèƒ½:Springæä¾›çš„å¯ä»¥æ ¹æ®å½“å‰ç¯å¢ƒï¼ŒåŠ¨æ€çš„æ¿€æ´»å’Œåˆ‡æ¢ä¸€ç³»åˆ—ç»„ä»¶çš„åŠŸèƒ½ã€‚å¦‚å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒç”¨çš„æ•°æ®åº“ä¸ä¸€æ ·ï¼Œä½†æ˜¯ä¸åŒçš„ç¯å¢ƒä¸ç”¨ä¿®æ”¹ä»£ç ã€‚@Profileå°±æ˜¯æŒ‡å®šç»„ä»¶åœ¨å“ªä¸ªç¯å¢ƒä¸‹æ‰èƒ½è¢«æ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚å¦‚æœä¸æŒ‡å®šï¼Œåˆ™ä»»ä½•ç¯å¢ƒä¸‹éƒ½èƒ½æ³¨å†Œè¿™ä¸ªç»„ä»¶ã€‚</p>
<p>å¦‚@Profile(â€œtestâ€) @Profile(â€œdevâ€) @Profile(â€œprodâ€)</p>
<ul>
<li><p>1.åŠ äº†ç¯å¢ƒæ ‡è¯†çš„beanï¼Œåªæœ‰è¿™ä¸ªç¯å¢ƒè¢«æ¿€æ´»çš„æ—¶å€™æ‰èƒ½æ³¨å†Œåˆ°å®¹å™¨ä¸­ã€‚é»˜è®¤æ˜¯defaultç¯å¢ƒ<br>ä½¿ç”¨:</p>
<ul>
<li>1.ä½¿ç”¨å‘½ä»¤è¡ŒåŠ¨æ€å‚æ•°:åœ¨è™šæ‹Ÿæœºå‚æ•°ä½ç½®åŠ è½½-DSpring.profiles.active</li>
<li>ä½¿ç”¨ä»£ç : â‘ ä½¿ç”¨AnnotationConfigApplicationContextçš„æ— å‚æ„é€ å™¨åˆ›å»ºä¸€ä¸ªapplicationContextå¯¹è±¡, â‘¡è®¾ç½®éœ€è¦æ¿€æ´»çš„ç¯å¢ƒ â‘¢æ³¨å†Œä¸»é…ç½®ç±» â‘£å¯åŠ¨åˆ·æ–°å®¹å™¨<br>å¦‚:</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test01</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="comment">//1.è°ƒç”¨AnnotationConfigApplicationContextçš„æ— å‚æ„é€ å™¨</span></span><br><span class="line">      AnnotationConfigApplicationContext applicationContext = <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line">      <span class="comment">//2.è®¾ç½®è¦æ¿€æ´»çš„ç¯å¢ƒ</span></span><br><span class="line">      applicationContext.getEnvironment().setActiveProfiles(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">      <span class="comment">//3.æ³¨å†Œä¸»é…ç½®ç±»</span></span><br><span class="line">      applicationContext.register(MainConfigOfProfile.class);</span><br><span class="line">      <span class="comment">//4å¯åŠ¨åˆ·æ–°å®¹å™¨</span></span><br><span class="line">      applicationContext.refresh();</span><br><span class="line"></span><br><span class="line">      applicationContext.close();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>2.å¦‚æœå†™åœ¨é…ç½®ç±»ä¸Šï¼Œé‚£ä¹ˆåªæœ‰æ˜¯æŒ‡å®šç¯å¢ƒçš„æ—¶å€™ï¼Œæ•´ä¸ªé…ç½®ç±»é‡Œé¢çš„æ‰€æœ‰é…ç½®æ‰èƒ½å¼€å§‹ç”Ÿæ•ˆ</p>
</li>
<li><p>3.æ²¡æœ‰æ ‡æ³¨ç¯å¢ƒæ ‡è¯†çš„beanï¼Œåœ¨ä»»ä½•ç¯å¢ƒä¸‹éƒ½æ˜¯åŠ è½½çš„</p>
</li>
</ul>

  <p><a class="classtest-link" href="/tags/Spring/" rel="tag">Spring</a> â€” Jul 1, 2019</p>
  


        </div>
        <div class="row mt-2">
  <h3>Search</h3>
  <div><input id="search-text" title="search" class="search-text" type="text" placeholder="search......"></div>
  <div style="margin-top: 1.5rem;">
    <ul id="result"></ul>
  </div>
</div>
        <div class="row mt-2">
  
    <div class="eight columns">
      <p id="madewith">Made with â¤ and
        <a class="footer-link icon" href="https://hexo.io" target="_blank" style="text-decoration: none;" rel="noreferrer" aria-label="Hexo.io">
        <svg class="hexo svg-hov" width="14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Hexo.js</title><path d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"/></svg>
        </a>
        
        at <a href="https://en.wikipedia.org/wiki/Earth" target="_blank" rel="noreferrer">Earth</a>.</p>
        
    </div>

    <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
    <div class="four columns mb-3 posisi" >
      
      <a class="ml-0 footer-link icon" href="https://github.com/homxuwang" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="GitHub">
        <svg class="github svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
      </a>
      

      

      

      

      

    </div>
  
</div>

      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>

  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

</body>

</html>