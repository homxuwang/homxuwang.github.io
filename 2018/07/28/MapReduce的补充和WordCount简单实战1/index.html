<!DOCTYPE html>
<html lang="zh-Hans">

<head>

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta charset="utf-8">

  
  <title>MapReduceçš„è¡¥å……å’ŒWordCountç®€å•å®æˆ˜(ä¸€)</title>
  
  <link rel="canonical" href="http://homxuwang.github.io/2018/07/28/MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/">
  
  <meta name="description" content="å®˜ç½‘ä»‹ç»ï¼šhttp://hadoop.apache.org/docs/current/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html é¦–å…ˆå›é¡¾ä¸€äº›MapReduceçš„åŸºç¡€çŸ¥è¯†ï¼šhttps://ho">
  
  
  <meta name="author" content="homxuwang">
  
  
  
  <meta property="og:site_name" content="Homxu" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="MapReduceçš„è¡¥å……å’ŒWordCountç®€å•å®æˆ˜(ä¸€)" />
  
  <meta property="og:description" content="å®˜ç½‘ä»‹ç»ï¼šhttp://hadoop.apache.org/docs/current/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html é¦–å…ˆå›é¡¾ä¸€äº›MapReduceçš„åŸºç¡€çŸ¥è¯†ï¼šhttps://ho">
  
  <meta property="og:url" content="http://homxuwang.github.io/2018/07/28/MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="MapReduceçš„è¡¥å……å’ŒWordCountç®€å•å®æˆ˜(ä¸€)">
  
  <meta name="twitter:description" content="å®˜ç½‘ä»‹ç»ï¼šhttp://hadoop.apache.org/docs/current/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html é¦–å…ˆå›é¡¾ä¸€äº›MapReduceçš„åŸºç¡€çŸ¥è¯†ï¼šhttps://ho">
  
  
  
  
  <meta name="twitter:url" content="http://homxuwang.github.io/2018/07/28/MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/" />

  <!-- Mobile Specific Metas
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="preload" href="/fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  
<link rel="stylesheet" href="/css/normalize.css">

  
<link rel="stylesheet" href="/css/skeleton.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
<link rel="stylesheet" href="/css/prism-dark.css">

  
<link rel="stylesheet" href="/css/prism-line-numbers.css">

  <!-- User css -->
  
  
<link rel="stylesheet" href="/css/user.css">

  

  <!-- Favicon
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

  <!-- Custom Theme Color Style
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <style>
  a:not(.icon) {
    text-decoration-color: #0FA0CE;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #0FA0CE 50%
    );
  }
  blockquote {
    border-left: 8px solid #0FA0CE;
  }
  .nanobar .bar {
    background: #0FA0CE;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #0FA0CE;
    border-color: #0FA0CE;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #0FA0CE;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  

  
  <script src="/js/pic.min.js" defer></script>
  

  
  <script src="/js/search.min.js" defer></script>
  

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="two columns" style="max-width: 50px">
    <h1 class="mt-2 mode">
      <div onclick=setDarkMode(true) id="darkBtn">ğŸŒ‘</div>
      <div onclick=setDarkMode(false) id="lightBtn" class=hidden>â˜€ï¸</div>
      <script >
        if (localStorage.getItem('preferredTheme') == 'dark') {
          setDarkMode(true)
        }
        function setDarkMode(isDark) {
          var darkBtn = document.getElementById('darkBtn')
          var lightBtn = document.getElementById('lightBtn')
          if (isDark) {
            lightBtn.style.display = "block"
            darkBtn.style.display = "none"
            localStorage.setItem('preferredTheme', 'dark');
          } else {
            lightBtn.style.display = "none"
            darkBtn.style.display = "block"
            localStorage.removeItem('preferredTheme');
          }
          document.body.classList.toggle("darkmode");
        }
      </script>
    </h1>
  </div>

  <div class="six columns ml-1">
    <h1 class="mt-2">
      Hi July.HX
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/">Home</a>
        
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>

        <div class="trans">
            <h2>MapReduceçš„è¡¥å……å’ŒWordCountç®€å•å®æˆ˜(ä¸€)</h2>

  <p>å®˜ç½‘ä»‹ç»ï¼š<a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/current/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html">http://hadoop.apache.org/docs/current/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html</a></p>
<p>é¦–å…ˆå›é¡¾ä¸€äº›MapReduceçš„åŸºç¡€çŸ¥è¯†ï¼š<br><a href="https://homxuwang.github.io/2018/04/24/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89%E2%80%94%E2%80%94MapReduce/">https://homxuwang.github.io/2018/04/24/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89%E2%80%94%E2%80%94MapReduce/</a></p>
<ul>
<li>Hadoop MapReduceæ˜¯Google MapReduceçš„å®ç°</li>
<li>MapReduceçš„ä¼˜ç‚¹ï¼š æµ·é‡æ•°æ®ç¦»çº¿å¤„ç† æ˜“å¼€å‘(JAVA API) æ˜“è¿è¡Œ</li>
<li>MapReduceçš„ç¼ºç‚¹ï¼š<br>  å®æ—¶æµå¼è®¡ç®—ï¼ˆMRæ˜¯æ ¹æ®è¯·æ±‚æœåŠ¡çš„æ–¹å¼è¿›è¡Œè®¡ç®—ï¼›å¤šä¸ªåº”ç”¨ç¨‹åºå­˜åœ¨ä¾èµ–å…³ç³»ï¼ŒMRçš„ä½œä¸šï¼Œæ•°æ®éœ€è¦è½åœ°åˆ°HDFSæˆ–è€…ç£ç›˜ã€‚æ‰€ä»¥ä¸èƒ½å®ç°å®æ—¶æµå¼è®¡ç®—ï¼‰</li>
</ul>
<h1 id="MapReduceçš„æ‰§è¡Œè¿‡ç¨‹"><a href="#MapReduceçš„æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="MapReduceçš„æ‰§è¡Œè¿‡ç¨‹"></a>MapReduceçš„æ‰§è¡Œè¿‡ç¨‹</h1><blockquote>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/ahu-lichang/p/6645074.html">https://www.cnblogs.com/ahu-lichang/p/6645074.html</a></p>
</blockquote>
<p>å®˜ç½‘çš„ä»‹ç»ï¼š</p>
<blockquote>
<p>A MapReduce job usually splits the input data-set into independent chunks which are processed by the map tasks in a completely parallel manner. The framework sorts the outputs of the maps, which are then input to the reduce tasks. Typically both the input and the output of the job are stored in a file-system. The framework takes care of scheduling tasks, monitoring them and re-executes the failed tasks.</p>
</blockquote>
<p><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/1.png"></p>
<ul>
<li>Input â€“&gt; Spliting ä¸€ä¸ªæ–‡ä»¶è¢«åˆ†æˆå¾ˆå¤šä¸ªå—ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä¸€ä¸ªsplitå¯¹åº”HDFSä¸­çš„ä¸€ä¸ªblockï¼Œç”¨æˆ·å¯ä»¥è¿›è¡Œä¿®æ”¹ï¼‰</li>
<li>Spliting â€“&gt; Mapping ä¸€ä¸ªå—äº¤ç”±ä¸€ä¸ªMapä»»åŠ¡å¤„ç†ï¼Œå¤„ç†å®Œçš„ç»“æœå†™åˆ°æœ¬åœ°</li>
<li>Mapping â€“&gt; Shuffling â€“&gt; Reducingå†™åˆ°æœ¬åœ°çš„æ–‡ä»¶é€šè¿‡Shuffleåè¿›è¡Œä¼ è¾“ï¼ŒæŠŠç›¸åŒçš„keyå†™åˆ°ä¸€ä¸ªReduceä¸­,åœ¨Reduceä¸­è¿›è¡Œç»Ÿè®¡</li>
<li>Reducingç»Ÿè®¡çš„ç»“æœæœ€ç»ˆå†™åˆ°æ–‡ä»¶ç³»ç»Ÿä¸Š</li>
</ul>
<p>çœ‹çœ‹å®˜ç½‘çš„è§£é‡Šï¼š</p>
<blockquote>
<p>The MapReduce framework operates exclusively on &lt;key, value&gt; pairs, that is, the framework views the input to the job as a set of &lt;key, value&gt; pairs and produces a set of &lt;key, value&gt; pairs as the output of the job, conceivably of different types.</p>
<p>The key and value classes have to be serializable by the framework and hence need to implement the Writable interface. Additionally, the key classes have to implement the WritableComparable interface to facilitate sorting by the framework.</p>
<p>Input and Output types of a MapReduce job:</p>
<p>(input) &lt;k1, v1&gt; -&gt; map -&gt; &lt;k2, v2&gt; -&gt; combine -&gt; &lt;k2, v2&gt; -&gt; reduce -&gt; &lt;k3, v3&gt; (output)</p>
</blockquote>
<h2 id="å…³äºWritableæ¥å£"><a href="#å…³äºWritableæ¥å£" class="headerlink" title="å…³äºWritableæ¥å£"></a>å…³äºWritableæ¥å£</h2><p>åœ¨ä¸Šé¢çš„ä»‹ç»ä¸­çœ‹åˆ°ï¼Œkeyå’Œvalueéœ€è¦å®ç°<code>Writable</code>æ¥å£ï¼Œå¹¶ä¸”keyè¿˜éœ€è¦å®ç°<code>WritableComparable</code>æ¥å£</p>
<p>è¿™ä¸ªæ¥å£éœ€è¦åå¤é˜…è¯»</p>
<p>å…³äº<code>Writable</code>æ¥å£çš„ä»‹ç»ï¼š<a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/current/api/org/apache/hadoop/io/Writable.html">http://hadoop.apache.org/docs/current/api/org/apache/hadoop/io/Writable.html</a></p>
<p>å…³äº<code>WritableComparable</code>æ¥å£çš„ä»‹ç»ï¼š<br><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/current/api/org/apache/hadoop/io/WritableComparable.html">http://hadoop.apache.org/docs/current/api/org/apache/hadoop/io/WritableComparable.html</a></p>
<p>åœ¨<code>Writable</code>æ¥å£ä¸­ä¸»è¦å®ç°<code>write</code>å’Œ<code>readFields</code>æ–¹æ³•ã€‚</p>
<p>å†çœ‹ä¸Šæ–‡é¢çš„wordcountçš„å›¾å’Œ<code>(input) &lt;k1, v1&gt; -&gt; map -&gt; &lt;k2, v2&gt; -&gt; combine -&gt; &lt;k2, v2&gt; -&gt; reduce -&gt; &lt;k3, v3&gt; (output)</code>è¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<p>å…¶ä¸­<code>k1</code>å°±æ˜¯<code>åç§»é‡</code>ã€‚ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä»0å¼€å§‹ï¼Œ<code>v1</code>å°±æ˜¯è¿™ä¸€è¡Œçš„æ•°æ®<code>Deer Bear River</code>ã€‚é‚£ä¹ˆç¬¬äºŒè¡Œçš„åç§»é‡å°±æ˜¯ç¬¬ä¸€è¡Œçš„å­—ç¬¦çš„é•¿åº¦ç›¸åŠ ï¼Œå€¼å°±æ˜¯<code>Car Car River</code>ã€‚ä»¥æ­¤ç±»æ¨</p>
<p>ç»è¿‡ä¸€å±‚è½¬æ¢<code>k2</code>å°±æ˜¯ä¸Šé¢æ¯ä¸€è¡Œçš„å•è¯,æ¯ä¸ªå•è¯ç›¸å½“äºæ˜¯ä»<code>v1</code>ä¸­æ‹†åˆ†å‡ºæ¥(Split(â€œ â€œ))ï¼Œæ˜¯ä¸€ä¸ª<code>Text</code>ç±»å‹ï¼Œæ¯ä¸ªå•è¯å°±æ˜¯ä¸€ä¸ª1ã€‚<code>v2</code>å°±æ˜¯ä¸€ä¸ª<code>IntWritable</code>æˆ–<code> LongWritable</code>ç±»å‹ã€‚</p>
<p>reduceè¾“å‡ºçš„å°±æ˜¯æ¯ä¸ªå•è¯è¾“å‡ºçš„æ€»å’Œã€‚<code>k3</code>å°±æ˜¯æ¯ä¸ªå•è¯ï¼Œ<code>v3</code>å°±æ˜¯å•è¯å‡ºç°çš„æ€»å’Œã€‚</p>
<h2 id="JAVA-APIçš„ç®€å•ä»‹ç»"><a href="#JAVA-APIçš„ç®€å•ä»‹ç»" class="headerlink" title="JAVA APIçš„ç®€å•ä»‹ç»"></a>JAVA APIçš„ç®€å•ä»‹ç»</h2><p><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/3_1.png"></p>
<ol>
<li>çœ‹ä¸Šå›¾ï¼Œé¦–å…ˆè¯»å–æ–‡ä»¶ä½¿ç”¨<code>InputFormat</code>ç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¥å£ï¼Œåœ¨æºç ä¸­æè¿°ä¸º<blockquote>
<p><code>InputFormat</code> describes the input-specification for a  Map-Reduce job.<br><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/3.png" alt="InputFormatçš„å®ç°ç±»"></p>
</blockquote>
</li>
<li><code>InputFormat</code>çš„å®ç°ç±»ä¸­ï¼Œç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯<code>FileInputFormat</code>ç±».è¿™æ˜¯ä¸€ä¸ªè¯»å–æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬çš„ç±».ä½†æ˜¯<code>FileInputFormat</code>ç±»ä»ç„¶æ˜¯ä¸ªæŠ½è±¡ç±»ã€‚<br>é‚£ä¹ˆç»§ç»­æ‰¾å®ƒçš„å­ç±»<br><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/4.png" alt="FileInputFormatçš„å®ç°ç±»"><br>å¯ä»¥çœ‹åˆ°<code>TextInputFormat</code>ç±».è¿™æ—¶å€™å®ƒå°±æ˜¯ä¸€ä¸ªå®ç°çš„ç±»äº†</li>
</ol>
<p><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/5.png" alt="TextInputFormatç±»"></p>
<p>å®˜æ–¹æ–‡æ¡£çš„ä»‹ç»ï¼š</p>
<blockquote>
<p>An {@link InputFormat} for plain text files.  Files are broken into lines.<br> Either linefeed or carriage-return are used to signal end of line.  Keys are<br> the position in the file, and values are the line of text.. </p>
</blockquote>
<p>å…¶ä¸­<code>InputFormat</code>ä¸­æœ‰å‡ ä¸ªå…³é”®çš„æ–¹æ³•ï¼š</p>
<ol>
<li><code>InputSplit[] getSplits(JobConf job, int numSplits) throws IOException;</code><br>å³å°†ä¸€ä¸ªè¾“å…¥æ–‡ä»¶åˆ†æˆå¾ˆå¤šSplitï¼Œæ¯ä¸€ä¸ªSplitäº¤ç»™ä¸€ä¸ªMapTaskå¤„ç†çš„æ–¹æ³•ã€‚å®ƒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå¯è§ä¸€ä¸ªè¾“å…¥æ–‡ä»¶å¯èƒ½ä¼šçš„åˆ°å¥½å‡ ä¸ª<code>InputSplit</code></li>
</ol>
<p><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/6.png" alt="getSplitsæ–¹æ³•"></p>
<ol start="2">
<li><code>RecordReader&lt;K, V&gt; getRecordReader(InputSplit split,JobConf job,Reporter reporter) throws IOException;</code><br>å®ƒæ˜¯ä¸€ä¸ªè®°å½•è¯»å–çš„æ–¹æ³•ï¼Œä»å‚æ•°å¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»<code>InputSplit[]</code>æ•°ç»„ä¸­è¯»è¿›æ•°æ®ï¼Œå¯ä»¥çŸ¥é“æ¯ä¸€è¡Œçš„æ•°æ®æ˜¯ä»€ä¹ˆã€‚</li>
</ol>
<p><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/7.png" alt="getRecordReaderæ–¹æ³•"></p>
<p>åœ¨<code>InputFormat</code>è¯»è¿›æ•°æ®å(å¯¹äºæ–‡æœ¬å°±æ˜¯ä½¿ç”¨<code>TextInputFormat</code>ï¼‰ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¢«æ‹†åˆ†æˆå¥½å¤šä¸ª<code>Split</code>ã€‚æ‹¿åˆ°<code>Split</code>åï¼Œä½¿ç”¨RR(RecordReader)æŠŠæ¯ä¸ª<code>Split</code>ä¸­çš„æ•°æ®è¯»å–å‡ºæ¥,ä¸€è¡Œä¸€è¡Œçš„è¯»ï¼Œæ¯è¯»ä¸€è¡Œï¼Œäº¤ç”±ä¸€ä¸ª<code>map</code>å¤„ç†.<code>Partitioner</code>å°†ç›¸åŒçš„<code>key</code>äº¤åˆ°åŒä¸€ä¸ª<code>Reduce</code>ä¸Šï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œ<code>key</code>å¯èƒ½ä¼šè¢«å‘é€åˆ°node1æˆ–è€…node2.ä¸­é—´æœ‰ä¸€ä¸ª<code>shuffle</code>çš„è¿‡ç¨‹ï¼Œç»“æœäº¤ç”±<code>reduce</code>å¤„ç†ã€‚å¤„ç†å®Œçš„ç»“æœäº¤ç»™<code>OutputFormat</code>ã€‚</p>
<ol start="3">
<li><code>OutputFormat</code></li>
</ol>
<blockquote>
<p><code>OutputFormat</code> describes the output-specification for a  Map-Reduce job.</p>
</blockquote>
<p><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/8.png" alt="OutputFormatçš„æ–¹æ³•"></p>
<p>å…¶ä¸­<code>getRecordWriter</code>æ–¹æ³•å°±å¯¹åº”<code>InputFormat</code>çš„<code>getRecordReader</code>æ–¹æ³•</p>
<p>ç»§ç»­å¯»æ‰¾å®ƒçš„å®ç°ç±»-&gt;<code>FileOutputFormat</code>-&gt;<code>TextOutputFormat</code></p>
<blockquote>
<p>An {@link OutputFormat} that writes plain text files.<br>å°†æ•°æ®ä»¥æ–‡æœ¬çš„æ–¹å¼å†™å‡ºå»</p>
</blockquote>
<h2 id="å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µ"><a href="#å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µ"></a>å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µ</h2><ul>
<li><p><code>Split</code><br>  Splitæ˜¯äº¤ç”±MapReduceä½œä¸šæ¥å¤„ç†çš„æ•°æ®å—ï¼Œæ˜¯MapReduceä¸­æœ€å°çš„è®¡ç®—å•å…ƒ<br>  HDFSï¼šblocksizeæ˜¯HDFSä¸­æœ€å°çš„å­˜å‚¨å•å…ƒ 128Mï¼ˆæˆ–è€…è‡ªå·±è®¾å®šï¼‰<br>  é»˜è®¤æƒ…å†µä¸‹ï¼šå®ƒä»¬ä¸¤ä¸ªä¸€ä¸€å¯¹åº”ï¼ˆä¹Ÿå¯ä»¥æ‰‹åŠ¨è®¾ç½®ï¼‰</p>
</li>
<li><p><code>InputFormat</code><br>InputFormatå°†è¾“å…¥æ•°æ®è¿›è¡Œåˆ†ç‰‡(split)ï¼š<code>InputSplit[] getSplits(JobConf job, int numSplits) throws IOException</code><br>é»˜è®¤å®ç”¨æ¯”è¾ƒå¤šçš„æ˜¯<code>TextInputFormat</code>,å¤„ç†æ–‡æœ¬æ ¼å¼çš„æ•°æ®</p>
</li>
<li><p><code>OutputFormat</code><br>  å’ŒInputFormatå¯¹åº”</p>
</li>
<li><p><code>Combiner</code></p>
</li>
<li><p><code>Partitioner</code></p>
</li>
</ul>
<p>åœ¨é€šè¿‡ä¸€å¼ å›¾å¯¹ä»¥ä¸Šå†…å®¹è¿›è¡Œæ¢³ç†ï¼š<br><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/9.png" alt="MapreduceåŸç†"></p>
<h1 id="MapReduceæ¶æ„"><a href="#MapReduceæ¶æ„" class="headerlink" title="MapReduceæ¶æ„"></a>MapReduceæ¶æ„</h1><h2 id="MapReduce1-xæ¶æ„"><a href="#MapReduce1-xæ¶æ„" class="headerlink" title="MapReduce1.xæ¶æ„"></a>MapReduce1.xæ¶æ„</h2><p><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/10.png" alt="MapReduce1.xæ¶æ„"></p>
<ol>
<li>JobTracker:JT<br> ä½œä¸šçš„ç®¡ç†è€…<br> å°†ä½œä¸šåˆ†è§£æˆä¸€å †ä»»åŠ¡ï¼šTaskï¼ˆåŒ…æ‹¬MapTaskå’ŒReduceTask)<br> å°†ä»»åŠ¡åˆ†æ´¾ç»™TaskTrackerè¿è¡Œ<br> ä½œä¸šçš„ç›‘æ§ã€å®¹é”™å¤„ç†ï¼ˆtaskä½œä¸šæŒ‚äº†ï¼Œé‡å¯taskï¼‰<br> åœ¨ä¸€å®šæ—¶é—´é—´éš”å†…ï¼ŒJTæ²¡æœ‰æ”¶åˆ°TTçš„å¿ƒè·³ä¿¡æ¯,åˆ™å°†ä»»åŠ¡åˆ†é…åˆ°å…¶ä»–TTä¸Šæ‰§è¡Œ</li>
<li>TaskTrackerï¼šTT<br> ä»»åŠ¡çš„æ‰§è¡Œè€…<br> åœ¨TTä¸Šæ‰§è¡ŒTaskï¼ˆMapTaskå’ŒReduceTaskï¼‰<br> ä¼šä¸JTè¿›è¡Œäº¤äº’ï¼šæ‰§è¡Œ/å¯åŠ¨/åœæ­¢ä½œä¸šï¼Œå‘é€å¿ƒè·³ä¿¡æ¯ç»™JT</li>
<li>MapTask<br> è‡ªå·±å¼€å‘çš„mapä»»åŠ¡äº¤ç”±è¯¥Taskæ¥å¤„ç†<br> è§£ææ¯æ¡è®°å½•çš„æ•°æ®ï¼Œäº¤ç»™è‡ªå·±çš„mapæ–¹æ³•å¤„ç†<br> å°†mapçš„è¾“å‡ºç»“æœå†™åˆ°æœ¬åœ°ç£ç›˜ï¼ˆæœ‰äº›ä½œä¸šåªæœ‰Mapï¼Œåˆ™å†™åˆ°HDFSï¼‰<br>4ï¼‰ ReduceTadk<br> å°†MapTaskè¾“å‡ºçš„æ•°æ®è¿›è¡Œè¯»å–<br> æŒ‰ç…§æ•°æ®è¿›è¡Œåˆ†ç»„ä¼ ç»™è‡ªå·±ç¼–å†™çš„reduceæ–¹æ³•å¤„ç†<br> å¤„ç†ç»“æœè¾“å‡º</li>
</ol>
<h2 id="MapReduce2-xæ¶æ„"><a href="#MapReduce2-xæ¶æ„" class="headerlink" title="MapReduce2.xæ¶æ„"></a>MapReduce2.xæ¶æ„</h2><p><img src="MapReduce%E7%9A%84%E8%A1%A5%E5%85%85%E5%92%8CWordCount%E7%AE%80%E5%8D%95%E5%AE%9E%E6%88%981/1.jpeg" alt="MapReduce2.xæ¶æ„"></p>
<p>å’Œyarnä¸­çš„æµç¨‹ç±»ä¼¼,MapReduceå¯ä»¥åœ¨YARNä¸Šè·‘ã€‚</p>
<p>ä¸‹ä¸€ç¯‡å®æˆ˜ã€‚</p>

  <p><a class="classtest-link" href="/tags/hadoop/" rel="tag">hadoop</a>, <a class="classtest-link" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" rel="tag">å¤§æ•°æ®</a> â€” Jul 28, 2018</p>
  


        </div>
        <div class="row mt-2">
  <h3>Search</h3>
  <div><input id="search-text" title="search" class="search-text" type="text" placeholder="search......"></div>
  <div style="margin-top: 1.5rem;">
    <ul id="result"></ul>
  </div>
</div>
        <div class="row mt-2">
  
    <div class="eight columns">
      <p id="madewith">Made with â¤ and
        <a class="footer-link icon" href="https://hexo.io" target="_blank" style="text-decoration: none;" rel="noreferrer" aria-label="Hexo.io">
        <svg class="hexo svg-hov" width="14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Hexo.js</title><path d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"/></svg>
        </a>
        
        at <a href="https://en.wikipedia.org/wiki/Earth" target="_blank" rel="noreferrer">Earth</a>.</p>
        
    </div>

    <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
    <div class="four columns mb-3 posisi" >
      
      <a class="ml-0 footer-link icon" href="https://github.com/homxuwang" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="GitHub">
        <svg class="github svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
      </a>
      

      

      

      

      

    </div>
  
</div>

      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>

  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

</body>

</html>