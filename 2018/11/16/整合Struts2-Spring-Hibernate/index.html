<!DOCTYPE html>
<html lang="zh-Hans">

<head>

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta charset="utf-8">

  
  <title>æ•´åˆStruts2+Spring+Hibernate</title>
  
  <link rel="canonical" href="http://homxuwang.github.io/2018/11/16/%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/">
  
  <meta name="description" content="é¡¹ç›®æ‰€éœ€ä¾èµ–åŒ…ï¼š å•ç‹¬é…ç½®Springåˆ›å»ºé…ç½®æ–‡ä»¶ å¯¼å…¥xmlçº¦æŸçº¦æŸåŒ…æ‹¬beans|context|aop|tx åˆ›å»ºUserAction,å¹¶åœ¨Springé…ç½®æ–‡ä»¶ä¸­é…ç½®. 1234567package my.study.web.action;import com.opensymphony.xwo">
  
  
  <meta name="author" content="homxuwang">
  
  
  
  <meta property="og:site_name" content="Homxu" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="æ•´åˆStruts2+Spring+Hibernate" />
  
  <meta property="og:description" content="é¡¹ç›®æ‰€éœ€ä¾èµ–åŒ…ï¼š å•ç‹¬é…ç½®Springåˆ›å»ºé…ç½®æ–‡ä»¶ å¯¼å…¥xmlçº¦æŸçº¦æŸåŒ…æ‹¬beans|context|aop|tx åˆ›å»ºUserAction,å¹¶åœ¨Springé…ç½®æ–‡ä»¶ä¸­é…ç½®. 1234567package my.study.web.action;import com.opensymphony.xwo">
  
  <meta property="og:url" content="http://homxuwang.github.io/2018/11/16/%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="æ•´åˆStruts2+Spring+Hibernate">
  
  <meta name="twitter:description" content="é¡¹ç›®æ‰€éœ€ä¾èµ–åŒ…ï¼š å•ç‹¬é…ç½®Springåˆ›å»ºé…ç½®æ–‡ä»¶ å¯¼å…¥xmlçº¦æŸçº¦æŸåŒ…æ‹¬beans|context|aop|tx åˆ›å»ºUserAction,å¹¶åœ¨Springé…ç½®æ–‡ä»¶ä¸­é…ç½®. 1234567package my.study.web.action;import com.opensymphony.xwo">
  
  
  
  
  <meta name="twitter:url" content="http://homxuwang.github.io/2018/11/16/%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/" />

  <!-- Mobile Specific Metas
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="preload" href="/fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  
<link rel="stylesheet" href="/css/normalize.css">

  
<link rel="stylesheet" href="/css/skeleton.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
<link rel="stylesheet" href="/css/prism-dark.css">

  
<link rel="stylesheet" href="/css/prism-line-numbers.css">

  <!-- User css -->
  
  
<link rel="stylesheet" href="/css/user.css">

  

  <!-- Favicon
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

  <!-- Custom Theme Color Style
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <style>
  a:not(.icon) {
    text-decoration-color: #0FA0CE;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #0FA0CE 50%
    );
  }
  blockquote {
    border-left: 8px solid #0FA0CE;
  }
  .nanobar .bar {
    background: #0FA0CE;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #0FA0CE;
    border-color: #0FA0CE;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #0FA0CE;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  

  
  <script src="/js/pic.min.js" defer></script>
  

  
  <script src="/js/search.min.js" defer></script>
  

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="two columns" style="max-width: 50px">
    <h1 class="mt-2 mode">
      <div onclick=setDarkMode(true) id="darkBtn">ğŸŒ‘</div>
      <div onclick=setDarkMode(false) id="lightBtn" class=hidden>â˜€ï¸</div>
      <script >
        if (localStorage.getItem('preferredTheme') == 'dark') {
          setDarkMode(true)
        }
        function setDarkMode(isDark) {
          var darkBtn = document.getElementById('darkBtn')
          var lightBtn = document.getElementById('lightBtn')
          if (isDark) {
            lightBtn.style.display = "block"
            darkBtn.style.display = "none"
            localStorage.setItem('preferredTheme', 'dark');
          } else {
            lightBtn.style.display = "none"
            darkBtn.style.display = "block"
            localStorage.removeItem('preferredTheme');
          }
          document.body.classList.toggle("darkmode");
        }
      </script>
    </h1>
  </div>

  <div class="six columns ml-1">
    <h1 class="mt-2">
      Hi July.HX
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/">Home</a>
        
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>

        <div class="trans">
            <h2>æ•´åˆStruts2+Spring+Hibernate</h2>

  <p>é¡¹ç›®æ‰€éœ€ä¾èµ–åŒ…ï¼š<br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/1.png" alt="ä¾èµ–åŒ…"><br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/2.png" alt="ä¾èµ–åŒ…"></p>
<h1 id="å•ç‹¬é…ç½®Spring"><a href="#å•ç‹¬é…ç½®Spring" class="headerlink" title="å•ç‹¬é…ç½®Spring"></a>å•ç‹¬é…ç½®Spring</h1><h2 id="åˆ›å»ºé…ç½®æ–‡ä»¶-å¯¼å…¥xmlçº¦æŸ"><a href="#åˆ›å»ºé…ç½®æ–‡ä»¶-å¯¼å…¥xmlçº¦æŸ" class="headerlink" title="åˆ›å»ºé…ç½®æ–‡ä»¶ å¯¼å…¥xmlçº¦æŸ"></a>åˆ›å»ºé…ç½®æ–‡ä»¶ å¯¼å…¥xmlçº¦æŸ</h2><p>çº¦æŸåŒ…æ‹¬<code>beans</code>|<code>context</code>|<code>aop</code>|<code>tx</code><br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/3.png" alt="å‘½åç©ºé—´"><br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/4.png" alt="å‘½åç©ºé—´"></p>
<p>åˆ›å»º<code>UserAction</code>,å¹¶åœ¨Springé…ç½®æ–‡ä»¶ä¸­é…ç½®.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;userAction&quot;</span> <span class="attr">class</span>=<span class="string">&quot;my.study.web.action.UserAction&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®tomcatçš„web-xml"><a href="#é…ç½®tomcatçš„web-xml" class="headerlink" title="é…ç½®tomcatçš„web.xml"></a>é…ç½®tomcatçš„web.xml</h2><p>åœ¨<code>web.xml</code>ä¸­é…ç½®è®©springéšwebå¯åŠ¨è€Œåˆ›å»ºçš„ç›‘å¬å™¨,å¹¶é…ç½®springé…ç½®æ–‡ä»¶é…ç½®å‚æ•°:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è®©springéšwebå¯åŠ¨è€Œåˆ›å»ºçš„ç›‘å¬å™¨ --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- é…ç½®springé…ç½®æ–‡ä»¶å‚æ•° --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶å¯ä»¥å¯åŠ¨æœåŠ¡çœ‹çœ‹æœ‰æ²¡æœ‰æŠ¥é”™ï¼Œå¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œè¿™ä¸€æ­¥å°±é…ç½®æˆåŠŸäº†ã€‚</p>
<h1 id="å•ç‹¬é…ç½®Struts2"><a href="#å•ç‹¬é…ç½®Struts2" class="headerlink" title="å•ç‹¬é…ç½®Struts2"></a>å•ç‹¬é…ç½®Struts2</h1><h2 id="é…ç½®struts2ä¸»é…ç½®æ–‡ä»¶"><a href="#é…ç½®struts2ä¸»é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®struts2ä¸»é…ç½®æ–‡ä»¶"></a>é…ç½®struts2ä¸»é…ç½®æ–‡ä»¶</h2><p>é¦–å…ˆåˆ›å»º<code>struts.xml</code>ï¼Œæ·»åŠ çº¦æŸ,å¹¶é…ç½®<code>UserAction</code>(çº¦æŸå¯ä»¥åœ¨struts2-core-2.3.35.jaråŒ…ä¸‹çš„struts-2.3.dtdä¸­æŸ¥æ‰¾åˆ°)ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">	<span class="meta-string">&quot;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&quot;</span></span></span><br><span class="line"><span class="meta">	<span class="meta-string">&quot;http://struts.apache.org/dtds/struts-2.3.dtd&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;ssh&quot;</span> <span class="attr">namespace</span>=<span class="string">&quot;/&quot;</span> <span class="attr">extends</span>=<span class="string">&quot;struts-default&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">&quot;UserAction_*&quot;</span> <span class="attr">class</span>=<span class="string">&quot;my.study.web.action.UserAction&quot;</span> <span class="attr">method</span>=<span class="string">&quot;&#123;1&#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">&quot;success&quot;</span>&gt;</span>/success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>jspæ–‡ä»¶è‡ªå·±å®šä¹‰ä¸€ä¸ªæ”¾åœ¨<code>WebContent</code>ç›®å½•ä¸‹å³å¯.</p>
<h2 id="é…ç½®struts2æ ¸å¿ƒè¿‡æ»¤å™¨åˆ°web-xml"><a href="#é…ç½®struts2æ ¸å¿ƒè¿‡æ»¤å™¨åˆ°web-xml" class="headerlink" title="é…ç½®struts2æ ¸å¿ƒè¿‡æ»¤å™¨åˆ°web.xml"></a>é…ç½®struts2æ ¸å¿ƒè¿‡æ»¤å™¨åˆ°web.xml</h2><p>åœ¨<code>web.xml</code>ä¸­é…ç½®struts2æ ¸å¿ƒè¿‡æ»¤å™¨</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="comment">&lt;!-- struts2æ ¸å¿ƒè¿‡æ»¤å™¨ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">  	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p><code>url-pattern</code>ä¸º<code>/*</code>è¡¨ç¤ºæ‰€æœ‰è·¯å¾„éƒ½è¦ç»è¿‡æ ¸å¿ƒè¿‡æ»¤å™¨<br>å¦‚æœå¯åŠ¨æœåŠ¡å™¨æ²¡æœ‰é”™è¯¯å°±è¯´æ˜é…ç½®æˆåŠŸ</p>
<h1 id="Springå’ŒStruts2æ•´åˆ"><a href="#Springå’ŒStruts2æ•´åˆ" class="headerlink" title="Springå’ŒStruts2æ•´åˆ"></a>Springå’ŒStruts2æ•´åˆ</h1><p>æ•´åˆçš„ç›®çš„æ˜¯è®©strutsçš„Actionä¸å†è‡ªå·±åˆ›å»ºï¼Œè€Œæ˜¯ç”±springåˆ›å»º(ä¾èµ–åŒ…æ˜¯struts2-spring-plugin-2.3.35.jar)ã€‚</p>
<h2 id="é…ç½®å¸¸é‡"><a href="#é…ç½®å¸¸é‡" class="headerlink" title="é…ç½®å¸¸é‡"></a>é…ç½®å¸¸é‡</h2><p>åœ¨<code>struts2-core-2.3.35.jar</code>-&gt;<code>org.apache.struts2</code>-&gt;<code>default.properties</code>ä¸­æŸ¥æ‰¾å¸¸é‡ã€‚</p>
<p><code>struts.objectFactory = spring</code>æ˜¯å°†actionçš„åˆ›å»ºäº¤ç»™springå®¹å™¨<br><code>struts.objectFactory.spring.autoWire = name</code>springè´Ÿè´£è£…é…Action<br>ä¸€èˆ¬åªéœ€é…ç½®<code>struts.objectFactory</code>ç¬¬äºŒä¸ªè‡ªåŠ¨å¼€å¯</p>
<p>åœ¨<code>&lt;struts&gt;&lt;/struts&gt;</code>æ ‡ç­¾ä¸­é…ç½®<code>&lt;constant name=&quot;struts.objectFactory&quot; value=&quot;spring&quot;&gt;</code></p>
<h2 id="ä¸¤ç§æ–¹æ¡ˆ"><a href="#ä¸¤ç§æ–¹æ¡ˆ" class="headerlink" title="ä¸¤ç§æ–¹æ¡ˆ"></a>ä¸¤ç§æ–¹æ¡ˆ</h2><p>åˆ›å»ºå„ä¸ªç±»è¿›è¡Œæµ‹è¯•ï¼š<br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/6.png" alt="æµ‹è¯•ç±»éƒ¨åˆ†"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> my.study.web.service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserService</span><span class="params">(UserService userService)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.userService = userService;</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">		System.out.println(userService);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Long user_id;</span><br><span class="line">	<span class="keyword">private</span> String user_code;</span><br><span class="line">	<span class="keyword">private</span> String user_name;</span><br><span class="line">	<span class="keyword">private</span> String user_password;</span><br><span class="line">	<span class="keyword">private</span> Character user_state;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Long <span class="title">getUser_id</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser_id</span><span class="params">(Long user_id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.user_id = user_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUser_code</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user_code;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser_code</span><span class="params">(String user_code)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.user_code = user_code;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUser_name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user_name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser_name</span><span class="params">(String user_name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.user_name = user_name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUser_password</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user_password;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser_password</span><span class="params">(String user_password)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.user_password = user_password;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Character <span class="title">getUser_state</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user_state;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser_state</span><span class="params">(Character user_state)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.user_state = user_state;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;User [user_id=&quot;</span> + user_id + <span class="string">&quot;, user_code=&quot;</span> + user_code + <span class="string">&quot;, user_name=&quot;</span> + user_name + <span class="string">&quot;, user_password=&quot;</span></span><br><span class="line">				+ user_password + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">	&#125;		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> my.study.web.domain.User;</span><br><span class="line"><span class="keyword">import</span> my.study.web.service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getUserByCodePassword</span><span class="params">(User u)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;getUserByCodePassword&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> my.study.web.domain.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="function">User <span class="title">getUserByCodePassword</span><span class="params">(User u)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨springé…ç½®æ–‡ä»¶ä¸­é…ç½®service:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- actioné…ç½® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;userAction&quot;</span> <span class="attr">class</span>=<span class="string">&quot;my.study.web.action.UserAction&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- servieé…ç½® --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;my.study.web.impl.UserServiceImpl&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>æ•´åˆæ–¹æ¡ˆ1:classå±æ€§ä¸Šä»ç„¶é…ç½®actionçš„å®Œæ•´ç±»åï¼Œè¿™æ ·struts2ä»ç„¶åˆ›å»ºaction,ç”±springè´Ÿè´£ç»„è£…Actionä¸­çš„ä¾èµ–å±æ€§<br><code>UserAction</code>ä¸­çš„<code>login()</code>æ–¹æ³•å°±æ˜¯ä¸ºäº†æ£€æµ‹æ˜¯å¦æ˜¯ç”±springè£…é…å±æ€§ã€‚<br>è®¿é—®<code>http://localhost:8080/SSH/UserAction_login</code>çœ‹åˆ°æ‰“å°ç»“æœ:<br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/7.png" alt="æµ‹è¯•ç»“æœ"><br>å½“ç„¶è¿™ç§æ–¹æ³•å¹¶ä¸æ¨èï¼Œæœ€å¥½ç”±springå®Œæ•´ç®¡ç†actionçš„ç”Ÿå‘½å‘¨æœŸã€‚springä¸­åŠŸèƒ½æ‰åº”ç”¨åˆ°Actionä¸Š.</p>
</li>
<li><p>æ•´åˆæ–¹æ¡ˆ2:springè´Ÿè´£åˆ›å»ºactionä»¥åŠç»„è£….é¦–å…ˆé…ç½®<code>applicationContext.xml</code>ä¸­çš„<code>action</code>ï¼Œç„¶åé…ç½®<code>struts.xml</code><br>è¿™ç§æ–¹å¼ä¸‹åœ¨<code>class</code>å±æ€§å¤„å¡«å†™springä¸­actionå¯¹è±¡çš„<code>BeanName</code>.å®Œå…¨ç”±springç®¡ç†actionç”Ÿå‘½å‘¨æœŸï¼Œè¿™æ ·springéœ€è¦æ‰‹åŠ¨ç»„è£…ä¾èµ–å±æ€§ã€‚å³éœ€è¦åœ¨<code>applicationContext.xml</code>ä¸­actionçš„<code>&lt;bean&gt;&lt;/bean&gt;</code>ä¸­ä½¿ç”¨<code>&lt;property&gt;&lt;/property&gt;</code>è¿›è¡Œæ‰‹åŠ¨æ³¨å…¥ï¼š<br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/8.png" alt="æ‰‹åŠ¨æ³¨å…¥"><br>åŒæ—¶ï¼Œè¦æ³¨æ„ï¼ŒActionå¯¹è±¡ä½œç”¨èŒƒå›´ä¸€å®šæ˜¯å¤šä¾‹çš„ï¼Œè¿™æ ·æ‰ç¬¦åˆStruts2çš„æ¶æ„ã€‚æ‰€ä»¥å°†<code>scope</code>å±æ€§é…ç½®ä¸º<code>prototype</code></p>
</li>
</ul>
<p>è®¿é—®<code>http://localhost:8080/SSH/UserAction_login</code>ä¾ç„¶å¯ä»¥æ‰“å°å‡º<code>my.study.web.impl.UserServiceImpl</code><br>è‡³æ­¤ï¼Œstrutsä¸springå°±æ•´åˆç»“æŸäº†ã€‚</p>
<h1 id="å•ç‹¬é…ç½®Hibernate"><a href="#å•ç‹¬é…ç½®Hibernate" class="headerlink" title="å•ç‹¬é…ç½®Hibernate"></a>å•ç‹¬é…ç½®Hibernate</h1><h2 id="å¯¼å…¥å®ä½“ç±»å’Œormå…ƒæ•°æ®"><a href="#å¯¼å…¥å®ä½“ç±»å’Œormå…ƒæ•°æ®" class="headerlink" title="å¯¼å…¥å®ä½“ç±»å’Œormå…ƒæ•°æ®"></a>å¯¼å…¥å®ä½“ç±»å’Œormå…ƒæ•°æ®</h2><p><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/9.png" alt="æ‰‹åŠ¨æ³¨å…¥"><br><code>User.hbm.xml</code>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span> </span></span><br><span class="line"><span class="meta">    <span class="meta-string">&quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">&quot;http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">&quot;my.study.web.domain&quot;</span> &gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">&quot;User&quot;</span> <span class="attr">table</span>=<span class="string">&quot;sys_user&quot;</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;user_id&quot;</span>  &gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;native&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user_code&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user_name&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user_password&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user_state&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>Customer.hbm.xml</code>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span> </span></span><br><span class="line"><span class="meta">    <span class="meta-string">&quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">&quot;http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">&quot;my.study.web.domain&quot;</span> &gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">&quot;LinkMan&quot;</span> <span class="attr">table</span>=<span class="string">&quot;cst_linkman&quot;</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;lkm_id&quot;</span>  &gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;native&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;lkm_gender&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;lkm_name&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;lkm_phone&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;lkm_email&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;lkm_qq&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;lkm_mobile&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;lkm_memo&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;lkm_position&quot;</span>  &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- å¤šå¯¹ä¸€ --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			nameå±æ€§:å¼•ç”¨å±æ€§å</span></span><br><span class="line"><span class="comment">			columnå±æ€§: å¤–é”®åˆ—å</span></span><br><span class="line"><span class="comment">			classå±æ€§: ä¸æˆ‘å…³è”çš„å¯¹è±¡å®Œæ•´ç±»å</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		  <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		 	çº§è”æ“ä½œ:	cascade</span></span><br><span class="line"><span class="comment">		 		save-update: çº§è”ä¿å­˜æ›´æ–°</span></span><br><span class="line"><span class="comment">		 		delete:çº§è”åˆ é™¤</span></span><br><span class="line"><span class="comment">		 		all:save-update+delete</span></span><br><span class="line"><span class="comment">		 	çº§è”æ“ä½œ: ç®€åŒ–æ“ä½œ.ç›®çš„å°±æ˜¯ä¸ºäº†å°‘äº›ä¸¤è¡Œä»£ç .</span></span><br><span class="line"><span class="comment">		  --&gt;</span></span><br><span class="line">		  <span class="comment">&lt;!-- å¤šçš„ä¸€æ–¹: ä¸èƒ½æ”¾å¼ƒç»´æŠ¤å…³ç³»çš„.å¤–é”®å­—æ®µå°±åœ¨å¤šçš„ä¸€æ–¹.  --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">many-to-one</span> <span class="attr">name</span>=<span class="string">&quot;customer&quot;</span> <span class="attr">column</span>=<span class="string">&quot;lkm_cust_id&quot;</span> <span class="attr">class</span>=<span class="string">&quot;Customer&quot;</span>  &gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">many-to-one</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>Customer.hbm.xml</code>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-mapping</span> <span class="meta-keyword">PUBLIC</span> </span></span><br><span class="line"><span class="meta">    <span class="meta-string">&quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">&quot;http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd&quot;</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- é…ç½®è¡¨ä¸å®ä½“å¯¹è±¡çš„å…³ç³» --&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- packageå±æ€§:å¡«å†™ä¸€ä¸ªåŒ…å.åœ¨å…ƒç´ å†…éƒ¨å‡¡æ˜¯éœ€è¦ä¹¦å†™å®Œæ•´ç±»åçš„å±æ€§,å¯ä»¥ç›´æ¥å†™ç®€ç­”ç±»åäº†. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-mapping</span> <span class="attr">package</span>=<span class="string">&quot;my.study.web.domain&quot;</span> &gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		classå…ƒç´ : é…ç½®å®ä½“ä¸è¡¨çš„å¯¹åº”å…³ç³»çš„</span></span><br><span class="line"><span class="comment">			name: å®Œæ•´ç±»å</span></span><br><span class="line"><span class="comment">			table:æ•°æ®åº“è¡¨å</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">class</span> <span class="attr">name</span>=<span class="string">&quot;Customer&quot;</span> <span class="attr">table</span>=<span class="string">&quot;cst_customer&quot;</span> &gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- idå…ƒç´ :é…ç½®ä¸»é”®æ˜ å°„çš„å±æ€§</span></span><br><span class="line"><span class="comment">				name: å¡«å†™ä¸»é”®å¯¹åº”å±æ€§å</span></span><br><span class="line"><span class="comment">				column(å¯é€‰): å¡«å†™è¡¨ä¸­çš„ä¸»é”®åˆ—å.é»˜è®¤å€¼:åˆ—åä¼šé»˜è®¤ä½¿ç”¨å±æ€§å</span></span><br><span class="line"><span class="comment">				type(å¯é€‰):å¡«å†™åˆ—(å±æ€§)çš„ç±»å‹.hibernateä¼šè‡ªåŠ¨æ£€æµ‹å®ä½“çš„å±æ€§ç±»å‹.</span></span><br><span class="line"><span class="comment">						æ¯ä¸ªç±»å‹æœ‰ä¸‰ç§å¡«æ³•: javaç±»å‹|hibernateç±»å‹|æ•°æ®åº“ç±»å‹</span></span><br><span class="line"><span class="comment">				not-null(å¯é€‰):é…ç½®è¯¥å±æ€§(åˆ—)æ˜¯å¦ä¸èƒ½ä¸ºç©º. é»˜è®¤å€¼:false</span></span><br><span class="line"><span class="comment">				length(å¯é€‰):é…ç½®æ•°æ®åº“ä¸­åˆ—çš„é•¿åº¦. é»˜è®¤å€¼:ä½¿ç”¨æ•°æ®åº“ç±»å‹çš„æœ€å¤§é•¿åº¦</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">name</span>=<span class="string">&quot;cust_id&quot;</span>  &gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- generator:ä¸»é”®ç”Ÿæˆç­–ç•¥(æ˜å¤©è®²) --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">generator</span> <span class="attr">class</span>=<span class="string">&quot;native&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">generator</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- propertyå…ƒç´ :é™¤idä¹‹å¤–çš„æ™®é€šå±æ€§æ˜ å°„</span></span><br><span class="line"><span class="comment">				name: å¡«å†™å±æ€§å</span></span><br><span class="line"><span class="comment">				column(å¯é€‰): å¡«å†™åˆ—å</span></span><br><span class="line"><span class="comment">				type(å¯é€‰):å¡«å†™åˆ—(å±æ€§)çš„ç±»å‹.hibernateä¼šè‡ªåŠ¨æ£€æµ‹å®ä½“çš„å±æ€§ç±»å‹.</span></span><br><span class="line"><span class="comment">						æ¯ä¸ªç±»å‹æœ‰ä¸‰ç§å¡«æ³•: javaç±»å‹|hibernateç±»å‹|æ•°æ®åº“ç±»å‹</span></span><br><span class="line"><span class="comment">				not-null(å¯é€‰):é…ç½®è¯¥å±æ€§(åˆ—)æ˜¯å¦ä¸èƒ½ä¸ºç©º. é»˜è®¤å€¼:false</span></span><br><span class="line"><span class="comment">				length(å¯é€‰):é…ç½®æ•°æ®åº“ä¸­åˆ—çš„é•¿åº¦. é»˜è®¤å€¼:ä½¿ç”¨æ•°æ®åº“ç±»å‹çš„æœ€å¤§é•¿åº¦</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cust_name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;cust_name&quot;</span> &gt;</span></span><br><span class="line">			<span class="comment">&lt;!--  &lt;column name=&quot;cust_name&quot; sql-type=&quot;varchar&quot; &gt;&lt;/column&gt; --&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cust_source&quot;</span> <span class="attr">column</span>=<span class="string">&quot;cust_source&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cust_industry&quot;</span> <span class="attr">column</span>=<span class="string">&quot;cust_industry&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cust_level&quot;</span> <span class="attr">column</span>=<span class="string">&quot;cust_level&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cust_linkman&quot;</span> <span class="attr">column</span>=<span class="string">&quot;cust_linkman&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cust_phone&quot;</span> <span class="attr">column</span>=<span class="string">&quot;cust_phone&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;cust_mobile&quot;</span> <span class="attr">column</span>=<span class="string">&quot;cust_mobile&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>LinkMan.java</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkMan</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Long lkm_id;</span><br><span class="line">	<span class="keyword">private</span> Character lkm_gender;</span><br><span class="line">	<span class="keyword">private</span> String lkm_name;</span><br><span class="line">	<span class="keyword">private</span> String lkm_phone;</span><br><span class="line">	<span class="keyword">private</span> String lkm_email;</span><br><span class="line">	<span class="keyword">private</span> String lkm_qq;</span><br><span class="line">	<span class="keyword">private</span> String lkm_mobile;</span><br><span class="line">	<span class="keyword">private</span> String lkm_memo;</span><br><span class="line">	<span class="keyword">private</span> String lkm_position;</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">private</span> Customer customer ;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Long cust_id;	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Long <span class="title">getCust_id</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cust_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCust_id</span><span class="params">(Long cust_id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cust_id = cust_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Customer <span class="title">getCustomer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> customer;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCustomer</span><span class="params">(Customer customer)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.customer = customer;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Long <span class="title">getLkm_id</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lkm_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLkm_id</span><span class="params">(Long lkm_id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lkm_id = lkm_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Character <span class="title">getLkm_gender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lkm_gender;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLkm_gender</span><span class="params">(Character lkm_gender)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lkm_gender = lkm_gender;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLkm_name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lkm_name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLkm_name</span><span class="params">(String lkm_name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lkm_name = lkm_name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLkm_phone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lkm_phone;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLkm_phone</span><span class="params">(String lkm_phone)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lkm_phone = lkm_phone;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLkm_email</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lkm_email;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLkm_email</span><span class="params">(String lkm_email)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lkm_email = lkm_email;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLkm_qq</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lkm_qq;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLkm_qq</span><span class="params">(String lkm_qq)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lkm_qq = lkm_qq;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLkm_mobile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lkm_mobile;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLkm_mobile</span><span class="params">(String lkm_mobile)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lkm_mobile = lkm_mobile;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLkm_memo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lkm_memo;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLkm_memo</span><span class="params">(String lkm_memo)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lkm_memo = lkm_memo;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLkm_position</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lkm_position;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLkm_position</span><span class="params">(String lkm_position)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lkm_position = lkm_position;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Customer.java</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Long cust_id;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String cust_name;</span><br><span class="line">	<span class="keyword">private</span> String cust_source;</span><br><span class="line">	<span class="keyword">private</span> String cust_industry;</span><br><span class="line">	<span class="keyword">private</span> String cust_level;</span><br><span class="line">	<span class="keyword">private</span> String cust_linkman;</span><br><span class="line">	<span class="keyword">private</span> String cust_phone;</span><br><span class="line">	<span class="keyword">private</span> String cust_mobile;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Long <span class="title">getCust_id</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cust_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCust_id</span><span class="params">(Long cust_id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cust_id = cust_id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCust_name</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cust_name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCust_name</span><span class="params">(String cust_name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cust_name = cust_name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCust_source</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cust_source;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCust_source</span><span class="params">(String cust_source)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cust_source = cust_source;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCust_industry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cust_industry;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCust_industry</span><span class="params">(String cust_industry)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cust_industry = cust_industry;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCust_level</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cust_level;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCust_level</span><span class="params">(String cust_level)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cust_level = cust_level;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCust_linkman</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cust_linkman;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCust_linkman</span><span class="params">(String cust_linkman)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cust_linkman = cust_linkman;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCust_phone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cust_phone;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCust_phone</span><span class="params">(String cust_phone)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cust_phone = cust_phone;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCust_mobile</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cust_mobile;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCust_mobile</span><span class="params">(String cust_mobile)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.cust_mobile = cust_mobile;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Customer [cust_id=&quot;</span> + cust_id + <span class="string">&quot;, cust_name=&quot;</span> + cust_name + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨hibernateçš„é…ç½®æ–‡ä»¶ä¸­ï¼Œä¸ç”¨é…ç½®éš”ç¦»çº§åˆ«ï¼Œåœ¨springä¸­è¿›è¡Œé…ç½®ã€‚ä¹Ÿä¸éœ€é…ç½®sessionä¸å½“å‰çº¿ç¨‹ç»‘å®šçš„é…ç½®ï¼Œå› ä¸ºspringæœ‰ç®¡ç†sessionçš„æœºåˆ¶ã€‚<br><code>hibernate.cfg.xml</code>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">hibernate-configuration</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">	<span class="meta-string">&quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">	<span class="meta-string">&quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hibernate-configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">session-factory</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.driver_class&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.url&quot;</span>&gt;</span>jdbc:mysql:///customer1<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.connection.password&quot;</span>&gt;</span>12345<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- æ•°æ®åº“æ–¹è¨€			</span></span><br><span class="line"><span class="comment">			æ³¨æ„: MYSQLåœ¨é€‰æ‹©æ–¹è¨€æ—¶,è¯·é€‰æ‹©æœ€çŸ­çš„æ–¹è¨€.</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.dialect&quot;</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- #hibernate.show_sql true</span></span><br><span class="line"><span class="comment">		#hibernate.format_sql true</span></span><br><span class="line"><span class="comment">		--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.format_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		## auto schema export  è‡ªåŠ¨å¯¼å‡ºè¡¨ç»“æ„. è‡ªåŠ¨å»ºè¡¨</span></span><br><span class="line"><span class="comment">		#hibernate.hbm2ddl.auto create		è‡ªåŠ¨å»ºè¡¨.æ¯æ¬¡æ¡†æ¶è¿è¡Œéƒ½ä¼šåˆ›å»ºæ–°çš„è¡¨.ä»¥å‰è¡¨å°†ä¼šè¢«è¦†ç›–,è¡¨æ•°æ®ä¼šä¸¢å¤±.(å¼€å‘ç¯å¢ƒä¸­æµ‹è¯•ä½¿ç”¨)</span></span><br><span class="line"><span class="comment">		#hibernate.hbm2ddl.auto create-drop è‡ªåŠ¨å»ºè¡¨.æ¯æ¬¡æ¡†æ¶è¿è¡Œç»“æŸéƒ½ä¼šå°†æ‰€æœ‰è¡¨åˆ é™¤.(å¼€å‘ç¯å¢ƒä¸­æµ‹è¯•ä½¿ç”¨)</span></span><br><span class="line"><span class="comment">		#hibernate.hbm2ddl.auto update(æ¨èä½¿ç”¨) è‡ªåŠ¨ç”Ÿæˆè¡¨.å¦‚æœå·²ç»å­˜åœ¨ä¸ä¼šå†ç”Ÿæˆ.å¦‚æœè¡¨æœ‰å˜åŠ¨.è‡ªåŠ¨æ›´æ–°è¡¨(ä¸ä¼šåˆ é™¤ä»»ä½•æ•°æ®).</span></span><br><span class="line"><span class="comment">		#hibernate.hbm2ddl.auto validate	æ ¡éªŒ.ä¸è‡ªåŠ¨ç”Ÿæˆè¡¨.æ¯æ¬¡å¯åŠ¨ä¼šæ ¡éªŒæ•°æ®åº“ä¸­è¡¨æ˜¯å¦æ­£ç¡®.æ ¡éªŒå¤±è´¥.</span></span><br><span class="line"><span class="comment">		 --&gt;</span>		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernate.hbm2ddl.auto&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- å¼•å…¥ormå…ƒæ•°æ®</span></span><br><span class="line"><span class="comment">			è·¯å¾„ä¹¦å†™: å¡«å†™srcä¸‹çš„è·¯å¾„</span></span><br><span class="line"><span class="comment">		 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">&quot;my/study/web/domain/Customer.hbm.xml&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">&quot;my/study/web/domain/LinkMan.hbm.xml&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapping</span> <span class="attr">resource</span>=<span class="string">&quot;my/study/web/domain/User.hbm.xml&quot;</span>/&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">session-factory</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">hibernate-configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºç±»è¿›è¡Œæµ‹è¯•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> my.study.web.domain.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HibernateTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Configuration conf = <span class="keyword">new</span> Configuration().configure();</span><br><span class="line">		</span><br><span class="line">		SessionFactory sf = conf.buildSessionFactory();</span><br><span class="line">		</span><br><span class="line">		Session session = sf.openSession();</span><br><span class="line">		</span><br><span class="line">		Transaction tx = session.beginTransaction();</span><br><span class="line">		</span><br><span class="line">		User u = <span class="keyword">new</span> User();</span><br><span class="line">		</span><br><span class="line">		u.setUser_code(<span class="string">&quot;hey&quot;</span>);</span><br><span class="line">		u.setUser_name(<span class="string">&quot;å“ˆå–½&quot;</span>);</span><br><span class="line">		u.setUser_password(<span class="string">&quot;12345&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		session.save(u);		</span><br><span class="line">		tx.commit();		</span><br><span class="line">		session.close();</span><br><span class="line">		</span><br><span class="line">		sf.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/11.png" alt="æµ‹è¯•ç»“æœ"><br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/10.png" alt="æµ‹è¯•ç»“æœ"></p>
<p>å•ç‹¬é…ç½®Hibernateå°±æˆåŠŸäº†</p>
<h1 id="hibernateå’Œspringæ•´åˆ"><a href="#hibernateå’Œspringæ•´åˆ" class="headerlink" title="hibernateå’Œspringæ•´åˆ"></a>hibernateå’Œspringæ•´åˆ</h1><p>æ•´åˆåŸç†ï¼šå°†<code>SessionFactory</code>å¯¹è±¡äº¤ç»™springå®¹å™¨ç®¡ç†</p>
<h2 id="åœ¨springä¸­é…ç½®sessionFactory"><a href="#åœ¨springä¸­é…ç½®sessionFactory" class="headerlink" title="åœ¨springä¸­é…ç½®sessionFactory"></a>åœ¨springä¸­é…ç½®sessionFactory</h2><p>ä¹Ÿå°±æ˜¯è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®sessionFactory,ç„¶å<code>sessionFactory</code>åŠ è½½é…ç½®æœ‰ä¸¤ç§æ–¹æ¡ˆ:</p>
<ul>
<li>1.ä»ç„¶ä½¿ç”¨å¤–éƒ¨çš„hibernate.cfg.xmlé…ç½®ä¿¡æ¯</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- å°†sessionFactoryé…ç½®åˆ°springå®¹å™¨ä¸­ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate5.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:hibernate.cfg.xml&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„é€‰æ‹©å’Œè‡ªå·±çš„hibernateç‰ˆæœ¬ä¸€æ ·çš„(æˆ‘çš„æ˜¯hibernate5)</p>
<p>ä¹¦å†™ä»£ç è¿›è¡Œæµ‹è¯•ï¼Œç›´æ¥ä½¿ç”¨springæ³¨å…¥çš„sessionFactory:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Transaction;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.cfg.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> my.study.web.domain.User;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="meta">@ContextConfiguration(&quot;classpath:applicationContext.xml&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HibernateTest</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Resource(name=&quot;sessionFactory&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> SessionFactory sf;</span><br><span class="line">	</span><br><span class="line">  	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ....</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> </span>&#123;			</span><br><span class="line">		Session session = sf.openSession();</span><br><span class="line">		</span><br><span class="line">		Transaction tx = session.beginTransaction();</span><br><span class="line">		</span><br><span class="line">		User u = <span class="keyword">new</span> User();</span><br><span class="line">		</span><br><span class="line">		u.setUser_code(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">		u.setUser_name(<span class="string">&quot;ä½ å¥½&quot;</span>);</span><br><span class="line">		u.setUser_password(<span class="string">&quot;8765&quot;</span>);		</span><br><span class="line">		session.save(u);		</span><br><span class="line">		tx.commit();</span><br><span class="line">		</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ sessionFactoryçš„å…³é—­å¯ä»¥äº¤ç»™springæ¥ç®¡ç†,æ‰€ä»¥close()æ–¹æ³•å¯ä»¥ä¸ç”¨å†™<br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/12.png" alt="æµ‹è¯•ç»“æœ"></p>
<ul>
<li>2.åœ¨springé…ç½®ä¸­æ”¾ç½®hibernateé…ç½®ä¿¡æ¯<br>ç¬¬äºŒç§é…ç½®æ–¹æ³•å°±æ˜¯åœ¨springä¸­é…ç½®hibernateé…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¿…é€‰é…ç½®ï¼Œå¯é€‰é…ç½®å’Œå¼•å…¥ormå…ƒæ•°æ®ã€‚<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate5.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- é…ç½®hibernateåŸºæœ¬ä¿¡æ¯ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernateProperties&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- å¿…é€‰é…ç½® --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.connection.driver_class&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.connection.url&quot;</span>&gt;</span>jdbc:mysql:///customer1<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.connection.username&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.connection.password&quot;</span>&gt;</span>12345<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.dialect&quot;</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- å¯é€‰é…ç½® --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.format_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.hbm2ddl.auto&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">prop</span>&gt;</span>				</span><br><span class="line">		<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- å¼•å…¥ormå…ƒæ•°æ®ï¼ŒæŒ‡å®šormå…ƒæ•°æ®æ‰€åœ¨çš„åŒ…è·¯å¾„ï¼Œspringä¼šè¯»å–åŒ…ä¸­çš„æ‰€æœ‰é…ç½® --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mappingDirectoryLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:my/study/web/domain&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
å°†æ–¹æ³•1ä¸­çš„é…ç½®æ¢æˆä¸Šé¢çš„é…ç½®ï¼Œè¿›è¡Œæµ‹è¯•:<br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/13.png" alt="æµ‹è¯•ç»“æœ"><br>è¿™æ ·å°±å®Œæˆäº†springå’Œhibernateçš„æ•´åˆ</li>
</ul>
<p>é‡ç‚¹æ€»ç»“ï¼Œæ•´åˆåŸç†å°±æ˜¯å°†<code>SessionFactory</code>å¯¹è±¡äº¤ç»™springå®¹å™¨ç®¡ç†</p>
<h1 id="springæ•´åˆc3p0è¿æ¥æ± "><a href="#springæ•´åˆc3p0è¿æ¥æ± " class="headerlink" title="springæ•´åˆc3p0è¿æ¥æ± "></a>springæ•´åˆc3p0è¿æ¥æ± </h1><p>c3p0çš„é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è¯»å–db.properties --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:db.properties&quot;</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®c3p0è¿æ¥æ±  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;JdbcUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.JdbcUrl&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;DriverClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.DriverClass&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;User&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.User&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;Password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.Password&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å°†c3p0æ³¨å…¥åˆ°sessionFactoryä¸­,hibernateä¼šé€šè¿‡è¿æ¥æ± è·å¾—è¿æ¥:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate5.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- é…ç½®hibernateåŸºæœ¬ä¿¡æ¯ --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- å°†è¿æ¥æ± æ³¨å…¥åˆ°sessionFactoryä¸­ --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;hibernateProperties&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.dialect&quot;</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!-- å¯é€‰é…ç½® --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.show_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.format_sql&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;hibernate.hbm2ddl.auto&quot;</span>&gt;</span>update<span class="tag">&lt;/<span class="name">prop</span>&gt;</span>				</span><br><span class="line">			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- å¼•å…¥ormå…ƒæ•°æ®ï¼ŒæŒ‡å®šormå…ƒæ•°æ®æ‰€åœ¨çš„åŒ…è·¯å¾„ï¼Œspringä¼šè¯»å–åŒ…ä¸­çš„æ‰€æœ‰é…ç½® --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;mappingDirectoryLocations&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:my/study/web/domain&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="springæ•´åˆhibernateç¯å¢ƒæ“ä½œæ•°æ®åº“"><a href="#springæ•´åˆhibernateç¯å¢ƒæ“ä½œæ•°æ®åº“" class="headerlink" title="springæ•´åˆhibernateç¯å¢ƒæ“ä½œæ•°æ®åº“"></a>springæ•´åˆhibernateç¯å¢ƒæ“ä½œæ•°æ®åº“</h1><p>å…ˆåˆ›å»ºæµ‹è¯•ç±»ã€‚<br>åˆ›å»º<code>UserDao</code>æ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> my.study.web.domain.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;	</span><br><span class="line">	<span class="comment">//æ ¹æ®ç™»é™†åç§°æŸ¥è¯¢userå¯¹è±¡</span></span><br><span class="line">	<span class="function">User <span class="title">getByUserCode</span><span class="params">(String usercode)</span></span>;</span><br><span class="line">	<span class="comment">//ä¿å­˜ç”¨æˆ·</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">(User u)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶ååˆ›å»º<code>UserDaoImpl</code>å®ç°ç±»ï¼Œåœ¨æ•´åˆç¯å¢ƒä¸­æ“ä½œæ•°æ®åº“ï¼Œspringæä¾›äº†ä¸€ä¸ªhibernateæ¨¡æ¿å¯¹è±¡<code>HibernateTemplate</code>.å¯ä»¥è®©å®ç°ç±»ç»§æ‰¿<code>HibernateDaoSupport</code>,ä»è€Œç®€å°‘Daoçš„ä¾èµ–å…³ç³»,ä¸ç”¨å†å»é…ç½®<code>HibernateTemplate</code>.è¿™æ ·åœ¨ä½¿ç”¨æ¨¡æ¿æ—¶ï¼Œç›´æ¥ä½¿ç”¨<code>getHibernateTemplate()</code>æ–¹æ³•å°±å¯ä»¥äº†.<br>è¦æ˜ç¡®å…¶ä¸­çš„ä¾èµ–å…³ç³»ï¼š<code>HibernateTemplate</code>é€šè¿‡<code>HibernateDaoSupport</code>åˆ›å»ºå‡ºæ¥ï¼Œéœ€è¦ä¾èµ–<code>SessionFactory</code>,è¿™ä¸ªæ¨¡æ¿ä¸­å°è£…çš„æ“ä½œéƒ½æ˜¯sessionä¸­çš„æ“ä½œ.æ‰€ä»¥è¦å…ˆä¸ºdaoæ³¨å…¥<code>SessionFactory</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.HibernateException;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Query;</span><br><span class="line"><span class="keyword">import</span> org.hibernate.Session;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate5.HibernateCallback;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate5.support.HibernateDaoSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> my.study.web.dao.UserDao;</span><br><span class="line"><span class="keyword">import</span> my.study.web.domain.User;</span><br><span class="line"><span class="comment">//HibernateDaoSupport è¦ä¸ºdaoæ³¨å…¥sessionFactory</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">extends</span> <span class="title">HibernateDaoSupport</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getByUserCode</span><span class="params">(<span class="keyword">final</span> String usercode)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//HQL</span></span><br><span class="line">		<span class="keyword">return</span> getHibernateTemplate().execute(<span class="keyword">new</span> HibernateCallback&lt;User&gt;() &#123;</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> User <span class="title">doInHibernate</span><span class="params">(Session session)</span> <span class="keyword">throws</span> HibernateException </span>&#123;</span><br><span class="line">					String hql = <span class="string">&quot;from User where user_code = ? &quot;</span>;</span><br><span class="line">					Query query = session.createQuery(hql);</span><br><span class="line">					query.setParameter(<span class="number">0</span>, usercode);</span><br><span class="line">					User user = (User) query.uniqueResult();</span><br><span class="line">				<span class="keyword">return</span> user;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="comment">//Criteria</span></span><br><span class="line">		<span class="comment">/*DetachedCriteria dc = DetachedCriteria.forClass(User.class);</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		dc.add(Restrictions.eq(&quot;user_code&quot;, usercode));</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		List&lt;User&gt; list = (List&lt;User&gt;) getHibernateTemplate().findByCriteria(dc);</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">		if(list != null &amp;&amp; list.size()&gt;0)&#123;</span></span><br><span class="line"><span class="comment">			return list.get(0);</span></span><br><span class="line"><span class="comment">		&#125;else&#123;</span></span><br><span class="line"><span class="comment">			return null;</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨springä¸­é…ç½®<code>UserDao</code>,å¹¶æ³¨å…¥sessionFactoryï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®UserDao --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;my.study.web.impl.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- æ³¨å…¥sessionFactory --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFacroty&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨<code>HibernateTest.java</code>ä¸­æ·»åŠ æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="meta">@Resource(name=&quot;userDao&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> UserDao ud;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="comment">//æµ‹è¯•Dao Hibernateæ¨¡æ¿</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		User user = ud.getByUserCode(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		System.out.println(user);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/14.png" alt="æµ‹è¯•ç»“æœ"></p>
<h1 id="Springä¸­çš„aopäº‹åŠ¡"><a href="#Springä¸­çš„aopäº‹åŠ¡" class="headerlink" title="Springä¸­çš„aopäº‹åŠ¡"></a>Springä¸­çš„aopäº‹åŠ¡</h1><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><p>é…ç½®äº‹åŠ¡ï¼Œæœ€æ ¸å¿ƒçš„æ˜¯è¦é…ç½®æ ¸å¿ƒäº‹åŠ¡ç®¡ç†å™¨.å…¶ä¸­åŒ…å«äº†æ‰€æœ‰äº‹åŠ¡çš„æ‰“å¼€æäº¤å…³é—­æ“ä½œ.æ‰€ä»¥è¦å…ˆåœ¨springé…ç½®æ ¸å¿ƒäº‹åŠ¡ç®¡ç†å™¨.<br><code>ctrl</code>+<code>shift</code>+<code>h</code>,æœç´¢ä¸€ä¸‹<code>TransactionManager</code>,å¯ä»¥çœ‹åˆ°<code>HibernateTransactionManager</code>å°±æ˜¯éœ€è¦çš„:<br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/15.png" alt="HibernateTransactionManager"></p>
<p>å°†å…¶é…ç½®åˆ°springé…ç½®ä¸­,å¹¶ä¸”ï¼Œä½¿ç”¨å®ƒç®¡ç†äº‹åŠ¡ï¼Œè¦é€šè¿‡sessionFactoryè¿›è¡Œç®¡ç†ï¼Œæ‰€ä»¥è¦é…ç½®æ³¨å…¥sessionFactory</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®æ ¸å¿ƒäº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate5.HibernateTransactionManager&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="xmlé…ç½®aopäº‹åŠ¡"><a href="#xmlé…ç½®aopäº‹åŠ¡" class="headerlink" title="xmlé…ç½®aopäº‹åŠ¡"></a>xmlé…ç½®aopäº‹åŠ¡</h2><p><code>å‡†å¤‡ç›®æ ‡å¯¹è±¡</code>-&gt;<code>é…ç½®é€šçŸ¥</code>-&gt;<code>å°†é…ç½®ç»‡å…¥ç›®æ ‡å¯¹è±¡(é…ç½®åˆ‡ç‚¹å’Œåˆ‡é¢)</code>ã€‚åœ¨å‰é¢å·²ç»æœ‰äº†ç›®æ ‡å¯¹è±¡ï¼Œæ‰€ä»¥è¿™é‡Œåªéœ€è¦é…ç½®é€šçŸ¥å’Œç»‡å…¥ç›®æ ‡å¯¹è±¡.å…·ä½“å¯è§åšå®¢ä¸Šä¸€ç¯‡æ–‡ç« </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®é€šçŸ¥ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;save*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;REPEATABLE_READ&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;persist*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;REPEATABLE_READ&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;update*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;REPEATABLE_READ&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;modify*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;REPEATABLE_READ&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;delete*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;REPEATABLE_READ&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;remove*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;REPEATABLE_READ&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;false&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;get*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;REPEATABLE_READ&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;find*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;REPEATABLE_READ&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®å°†é€šçŸ¥ç»‡å…¥ç›®æ ‡å¯¹è±¡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- é…ç½®åˆ‡ç‚¹ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">&quot;execution(* my.study.web.impl.*ServiceImpl.*(..))&quot;</span> <span class="attr">id</span>=<span class="string">&quot;transactionPoincut&quot;</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- é…ç½®åˆ‡é¢ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">pointcut-ref</span>=<span class="string">&quot;transactionPoincut&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ï¼š<br>åœ¨<code>UserService</code>æ¥å£ä¸­æ·»åŠ æ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User u)</span></span>;</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>UserDao</code>æ¥å£ä¸­æ·»åŠ æ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¿å­˜ç”¨æˆ·</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">save</span><span class="params">(User u)</span></span>;</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>UserDaoImpl</code>ä¸­æ·»åŠ æ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(User u)</span> </span>&#123;</span><br><span class="line">	getHibernateTemplate().save(u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>UserServiceImpl</code>ä¸­æ·»åŠ æ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> UserDao ud;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User u)</span> </span>&#123;</span><br><span class="line">	ud.save(u);		</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¸ºudæ·»åŠ setteræ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUd</span><span class="params">(UserDao ud)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">this</span>.ud = ud;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä¹‹å‰ï¼Œè¦åœ¨springä¸­çš„<code>userService</code>ä¸‹å°†<code>userDao</code>æ³¨å…¥è¿›å»:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- servieé…ç½® --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">&quot;userService&quot;</span> <span class="attr">class</span>=<span class="string">&quot;my.study.web.impl.UserServiceImpl&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;ud&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDao&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource(name=&quot;userService&quot;)</span></span><br><span class="line"><span class="keyword">private</span> UserService us;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="comment">//æµ‹è¯•aopäº‹åŠ¡</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	User u = <span class="keyword">new</span> User();</span><br><span class="line">	</span><br><span class="line">	u.setUser_code(<span class="string">&quot;aoptest&quot;</span>);</span><br><span class="line">	u.setUser_name(<span class="string">&quot;aopæµ‹è¯•&quot;</span>);</span><br><span class="line">	u.setUser_password(<span class="string">&quot;aop123&quot;</span>);</span><br><span class="line">	us.saveUser(u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/16.png" alt="æµ‹è¯•ç»“æœ"></p>
<h2 id="æ³¨è§£é…ç½®aopäº‹åŠ¡"><a href="#æ³¨è§£é…ç½®aopäº‹åŠ¡" class="headerlink" title="æ³¨è§£é…ç½®aopäº‹åŠ¡"></a>æ³¨è§£é…ç½®aopäº‹åŠ¡</h2><p>åœ¨springé…ç½®æ–‡ä»¶ä¸­ï¼Œé¦–å…ˆå¼€å¯æ³¨è§£äº‹åŠ¡:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼€å¯æ³¨è§£äº‹åŠ¡ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ”¹å†™<code>UserServiceImpl</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Isolation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Propagation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> my.study.web.dao.UserDao;</span><br><span class="line"><span class="keyword">import</span> my.study.web.domain.User;</span><br><span class="line"><span class="keyword">import</span> my.study.web.service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Transactional(isolation=Isolation.REPEATABLE_READ,propagation=Propagation.REQUIRED,readOnly=true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> UserDao ud;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getUserByCodePassword</span><span class="params">(User u)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;getUserByCodePassword&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="meta">@Transactional(isolation=Isolation.REPEATABLE_READ,propagation=Propagation.REQUIRED,readOnly=false)</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveUser</span><span class="params">(User u)</span> </span>&#123;</span><br><span class="line">		ud.save(u);		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUd</span><span class="params">(UserDao ud)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.ud = ud;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource(name=&quot;userService&quot;)</span></span><br><span class="line">	<span class="keyword">private</span> UserService us;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="comment">//æµ‹è¯•aopäº‹åŠ¡</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		User u = <span class="keyword">new</span> User();</span><br><span class="line">		</span><br><span class="line">		u.setUser_code(<span class="string">&quot;aopæ³¨è§£test&quot;</span>);</span><br><span class="line">		u.setUser_name(<span class="string">&quot;aopæµ‹è¯•æ³¨è§£&quot;</span>);</span><br><span class="line">		u.setUser_password(<span class="string">&quot;aop123&quot;</span>);</span><br><span class="line">		us.saveUser(u);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/17.png" alt="æµ‹è¯•ç»“æœ"></p>
<h1 id="æ‰©å¤§sessionä½œç”¨èŒƒå›´"><a href="#æ‰©å¤§sessionä½œç”¨èŒƒå›´" class="headerlink" title="æ‰©å¤§sessionä½œç”¨èŒƒå›´"></a>æ‰©å¤§sessionä½œç”¨èŒƒå›´</h1><p>ä¸ºäº†é¿å…ä½¿ç”¨æ‡’åŠ è½½æ—¶å‡ºç°no-sessioné—®é¢˜.éœ€è¦æ‰©å¤§sessionçš„ä½œç”¨èŒƒå›´</p>
<p>åœ¨<code>web.xml</code>é…ç½®filter:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- æ‰©å¤§sessionä½œç”¨åŸŸèŒƒå›´ </span></span><br><span class="line"><span class="comment"> 	æ³¨æ„:ä»»ä½•filterä¸€å®šè¦åœ¨strutsçš„filterä¹‹å‰è°ƒç”¨</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>openSessionInView<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.orm.hibernate5.support.OpenSessionInViewFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>openSessionInView<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„:ä»»ä½•filterä¸€å®šè¦åœ¨strutsçš„filterä¹‹å‰è°ƒç”¨,æ‰€ä»¥è¦æ”¾åœ¨strutsé…ç½®å‰é¢<br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/18.png" alt="æµ‹è¯•ç»“æœ"></p>
<p>é…ç½®å®Œæ¯•</p>
<h1 id="å®ç°ç”¨æˆ·ç™»é™†åŠŸèƒ½"><a href="#å®ç°ç”¨æˆ·ç™»é™†åŠŸèƒ½" class="headerlink" title="å®ç°ç”¨æˆ·ç™»é™†åŠŸèƒ½"></a>å®ç°ç”¨æˆ·ç™»é™†åŠŸèƒ½</h1><h2 id="Webå±‚"><a href="#Webå±‚" class="headerlink" title="Webå±‚"></a>Webå±‚</h2><p>æ”¹å†™<code>UserAction</code>æ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> my.study.web.action;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionContext;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ActionSupport;</span><br><span class="line"><span class="keyword">import</span> com.opensymphony.xwork2.ModelDriven;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> my.study.web.domain.User;</span><br><span class="line"><span class="keyword">import</span> my.study.web.service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> <span class="keyword">implements</span> <span class="title">ModelDriven</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> User user = <span class="keyword">new</span> User();</span><br><span class="line">	<span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserService</span><span class="params">(UserService userService)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.userService = userService;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">		<span class="comment">//1. è°ƒç”¨serviceæ‰§è¡Œç™»é™†é€»è¾‘</span></span><br><span class="line">		User u = userService.getUserByCodePassword(user);</span><br><span class="line">		<span class="comment">//2. å°†è¿”å›çš„userå¯¹è±¡æ”¾åˆ°sessionåŸŸä¸­</span></span><br><span class="line">		ActionContext.getContext().getSession().put(<span class="string">&quot;user&quot;</span>, u);</span><br><span class="line">		<span class="comment">//3. é‡å®šå‘åˆ°é¡¹ç›®é¦–é¡µ</span></span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;toHome&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getModel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> user;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ”¹å†™<code>struts.xml</code>é…ç½®ï¼Œæ”¹å˜è·³è½¬åœ°å€:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">struts</span> <span class="meta-keyword">PUBLIC</span></span></span><br><span class="line"><span class="meta">	<span class="meta-string">&quot;-//Apache Software Foundation//DTD Struts Configuration 2.3//EN&quot;</span></span></span><br><span class="line"><span class="meta">	<span class="meta-string">&quot;http://struts.apache.org/dtds/struts-2.3.dtd&quot;</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">&quot;struts.objectFactory&quot;</span> <span class="attr">value</span>=<span class="string">&quot;spring&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;ssh&quot;</span> <span class="attr">namespace</span>=<span class="string">&quot;/&quot;</span> <span class="attr">extends</span>=<span class="string">&quot;struts-default&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">&quot;UserAction_*&quot;</span> <span class="attr">class</span>=<span class="string">&quot;my.study.web.action.UserAction&quot;</span> <span class="attr">method</span>=<span class="string">&quot;&#123;1&#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">&quot;toHome&quot;</span>&gt;</span>/index.html<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Serviceå±‚"><a href="#Serviceå±‚" class="headerlink" title="Serviceå±‚"></a>Serviceå±‚</h2><p>æ”¹å†™<code>UserServiceImpl</code>ä¸­çš„æ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">getUserByCodePassword</span><span class="params">(User u)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//1. æ ¹æ®ç™»å½•åç§°æŸ¥è¯¢ç™»é™†ç”¨æˆ·</span></span><br><span class="line">		User exitU = ud.getByUserCode(u.getUser_code());</span><br><span class="line">		<span class="comment">//2. åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨-&gt;ä¸å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œæç¤ºç”¨æˆ·åä¸å­˜åœ¨</span></span><br><span class="line">		<span class="comment">//				-&gt;å­˜åœ¨</span></span><br><span class="line">		<span class="comment">//					-&gt;å¯†ç é”™è¯¯ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œæç¤ºå¯†ç é”™è¯¯</span></span><br><span class="line">		<span class="keyword">if</span>(exitU==<span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;ç”¨æˆ·ä¸å­˜åœ¨ï¼&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(!exitU.getUser_password().equals(u.getUser_password())) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;å¯†ç é”™è¯¯ï¼&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//3.è¿”å›æŸ¥è¯¢åˆ°çš„ç”¨æˆ·å¯¹è±¡</span></span><br><span class="line">		<span class="keyword">return</span> exitU;</span><br><span class="line">	&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„å¦‚æœéœ€è¦æŠ›å‡ºå¼‚å¸¸ï¼Œéœ€è¦åœ¨<code>struts.xml</code>ä¸­é…ç½®:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">&quot;struts.objectFactory&quot;</span> <span class="attr">value</span>=<span class="string">&quot;spring&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">constant</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;ssh&quot;</span> <span class="attr">namespace</span>=<span class="string">&quot;/&quot;</span> <span class="attr">extends</span>=<span class="string">&quot;struts-default&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">global-exception-mappings</span> &gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">exception-mapping</span> <span class="attr">result</span>=<span class="string">&quot;error&quot;</span> <span class="attr">exception</span>=<span class="string">&quot;java.lang.RuntimeException&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">exception-mapping</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">global-exception-mappings</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">&quot;UserAction_*&quot;</span> <span class="attr">class</span>=<span class="string">&quot;my.study.web.action.UserAction&quot;</span> <span class="attr">method</span>=<span class="string">&quot;&#123;1&#125;&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">&quot;toHome&quot;</span>&gt;</span>/index.html<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">&quot;error&quot;</span>&gt;</span>/login.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="daoå±‚"><a href="#daoå±‚" class="headerlink" title="daoå±‚"></a>daoå±‚</h2><p>daoå±‚åœ¨ä¸Šé¢å·²ç»å®ç°å¥½äº†</p>
<h2 id="æµ‹è¯•ç”¨çš„é¡µé¢"><a href="#æµ‹è¯•ç”¨çš„é¡µé¢" class="headerlink" title="æµ‹è¯•ç”¨çš„é¡µé¢"></a>æµ‹è¯•ç”¨çš„é¡µé¢</h2><p><code>login.jsp</code>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;ISO-8859-1&quot;%&gt;</span><br><span class="line">&lt;%@ taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot; %&gt;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span> <span class="meta-string">&quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/UserAction_login&quot;</span> <span class="attr">method</span>=<span class="string">post</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">label</span>&gt;</span>username:<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;user_code&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">label</span>&gt;</span>password:<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">password</span> <span class="attr">name</span>=<span class="string">&quot;user_password&quot;</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">&quot;red&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">&quot;exception.message&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">s:property</span>&gt;</span><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="é¡¹ç›®æ€»è§ˆ"><a href="#é¡¹ç›®æ€»è§ˆ" class="headerlink" title="é¡¹ç›®æ€»è§ˆ"></a>é¡¹ç›®æ€»è§ˆ</h1><p><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/19.png" alt="é¡¹ç›®æ€»è§ˆ"><br><img src="%E6%95%B4%E5%90%88Struts2-Spring-Hibernate/20.png" alt="é¡¹ç›®æ€»è§ˆ"></p>

  <p><a class="classtest-link" href="/tags/SSH/" rel="tag">SSH</a>, <a class="classtest-link" href="/tags/Spring/" rel="tag">Spring</a>, <a class="classtest-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">å­¦ä¹ ç¬”è®°</a> â€” Nov 16, 2018</p>
  


        </div>
        <div class="row mt-2">
  <h3>Search</h3>
  <div><input id="search-text" title="search" class="search-text" type="text" placeholder="search......"></div>
  <div style="margin-top: 1.5rem;">
    <ul id="result"></ul>
  </div>
</div>
        <div class="row mt-2">
  
    <div class="eight columns">
      <p id="madewith">Made with â¤ and
        <a class="footer-link icon" href="https://hexo.io" target="_blank" style="text-decoration: none;" rel="noreferrer" aria-label="Hexo.io">
        <svg class="hexo svg-hov" width="14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Hexo.js</title><path d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"/></svg>
        </a>
        
        at <a href="https://en.wikipedia.org/wiki/Earth" target="_blank" rel="noreferrer">Earth</a>.</p>
        
    </div>

    <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
    <div class="four columns mb-3 posisi" >
      
      <a class="ml-0 footer-link icon" href="https://github.com/homxuwang" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="GitHub">
        <svg class="github svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
      </a>
      

      

      

      

      

    </div>
  
</div>

      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>

  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

</body>

</html>